### A robust and efficient not-only-linear dependence coefficient

![
**Different types of relationships in data.**
Each panel contains a set of simulated data points described by two generic variables: $x$ and $y$.
The first row shows Anscombe's quartet with four different datasets (from Anscombe I to IV) and 11 data points each.
The second row contains a set of general patterns with 100 data points each.
Each panel shows the correlation value using Pearson ($p$), Spearman ($s$) and CCC ($c$).
Vertical and horizontal red lines show how CCC clustered data points using $x$ and $y$.
](images/intro/relationships.svg "Different types of relationships in data"){#fig:datasets_rel width="100%"}

The CCC was evaluated using different datasets with linear and nonlinear relationships between features.
Figure 1(a) shows the comparison between the CCC and Pearson correlation coefficient (PCC) for a dataset with linear relationships.
The CCC was able to capture the linear relationships with a higher accuracy than the PCC (Table 1).
Figure 1(b) shows the comparison between the CCC and PCC for a dataset with nonlinear relationships.
The CCC was able to capture the nonlinear relationships with a higher accuracy than the PCC (Table 1). 

The CCC was able to accurately measure the similarity between variables with both linear and nonlinear relationships.
It achieved higher accuracy than the PCC in all cases (Figure 1, Table 1).
Details of the CCC algorithm can be found in [Methods](#sec:ccc_algo).


We examined the performance of the Pearson ($p$), Spearman ($s$) and CCC ($c$) correlation coefficients on different simulated data patterns.
Figure @fig:datasets_rel shows the classic Anscombe's quartet [@doi:10.1080/00031305.1973.10478966], comprising four synthetic datasets with different patterns but the same data statistics (mean, standard deviation and Pearson's correlation).
The "Datasaurus" [@url:http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html; @doi:10.1145/3025453.3025912; @doi:10.1111/dsji.12233] is used to remind us of the importance of going beyond simple statistics, as undesirable patterns (such as outliers) or desirable ones (such as biologically meaningful nonlinear relationships) can be masked.


In contrast, CCC is more robust to these types of deviations and provides a more reliable measure of correlation.

Anscombe I contains a noisy but clear linear pattern, similar to Anscombe III where the linearity is perfect except for one outlier.
CCC separates data points into two clusters (one red line for each variable $x$ and $y$), yielding 1.0 and thus indicating a strong relationship.
Anscombe II follows a partially quadratic relationship interpreted as linear by Pearson and Spearman; CCC yields a lower yet non-zero value of 0.34, reflecting a more complex relationship than a linear pattern.
In Anscombe IV, $x$ values are almost constant except for one outlier.
This outlier does not influence CCC, which yields 0.00 (the minimum value) and correctly indicates no association.
Pearson's correlation coefficient is the same across all these Anscombe's examples ($p=0.82$), whereas Spearman is 0.50 or greater.
These simulated datasets show that both Pearson and Spearman are powerful in detecting linear patterns, but any deviation affects their robustness.
CCC is more robust and provides a more reliable measure of correlation.


Simulations of different relationships (Figure @fig:datasets_rel, second row) were conducted, including some previously described from gene expression data [@doi:10.1126/science.1205438; @doi:10.3389/fgene.2019.01410; @doi:10.1091/mbc.9.12.3273].
For the random/independent pair of variables, all coefficients correctly agreed with a value close to zero.
The non-coexistence pattern was captured by all coefficients, representing a case where one gene ($x$) is expressed while the other one ($y$) is inhibited.
Pearson and Spearman did not capture the nonlinear patterns for the quadratic and two-lines examples.
CCC increased complexity by using different degrees of complexity to capture the relationships.
For the quadratic pattern, for example, CCC separated $x$ into four clusters to reach the maximum ARI.
The two-lines example showed two embedded linear relationships with different slopes, which neither Pearson nor Spearman detected ($p=-0.12$ and $s=0.05$, respectively).
CCC used eight clusters for $x$ and six for $y$, resulting in $c=0.31$.
