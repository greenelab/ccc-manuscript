### A robust and efficient not-only-linear dependence coefficient

![
**Different types of relationships in data.**
Each panel contains a set of simulated data points described by two generic variables: $x$ and $y$.
The first row shows Anscombe's quartet with four different datasets (from Anscombe I to IV) and 11 data points each.
The second row contains a set of general patterns with 100 data points each.
Each panel shows the correlation value using Pearson ($p$), Spearman ($s$) and CCC ($c$).
Vertical and horizontal red lines show how CCC clustered data points using $x$ and $y$.
](images/intro/relationships.svg "Different types of relationships in data"){#fig:datasets_rel width="100%"}

The CCC provides a similarity measure between any pair of variables, with numerical or categorical values.
It assumes that if two variables have a relationship, the clusters generated by each variable should match.
To separate numerical data into clusters, CCC uses quantiles (e.g., median).
The CCC is defined as the maximum adjusted Rand index (ARI) between the clusters, ranging from 0 to 1.
Details of the CCC algorithm can be found in the Methods section.


We examined the behavior of the Pearson ($p$), Spearman ($s$) and CCC ($c$) correlation coefficients on different simulated data patterns.
Figure @fig:datasets_rel shows the classic Anscombe's quartet [@doi:10.1080/00031305.1973.10478966], which comprises four synthetic datasets with different patterns but the same data statistics (mean, standard deviation and Pearson's correlation).
The "Datasaurus" [@url:http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html; @doi:10.1145/3025453.3025912; @doi:10.1111/dsji.12233] is a reminder of the importance of going beyond simple statistics, as undesirable patterns (such as outliers) or desirable ones (such as biologically meaningful nonlinear relationships) can be masked by summary statistics alone.


CCC, on the other hand, is more suitable for detecting nonlinear patterns and it is robust to outliers.

The Anscombe datasets illustrate the behaviour of the correlation coefficient based on machine learning (CCC).
In Anscombe I, with a noisy but clear linear pattern, CCC yields 1.0, indicating a strong relationship.
In Anscombe II, which follows a partially quadratic relationship, CCC yields 0.34, reflecting a more complex relationship than a linear pattern.
For Anscombe IV, with a vertical line of data points, CCC yields 0.00, correctly indicating no association.
The Pearson and Spearman correlation coefficients are the same across all these Anscombe's examples, but any deviation in the linear assumption affects their robustness.
CCC is more suitable for detecting nonlinear patterns and is robust to outliers.


Simulations of additional types of relationships (Figure @fig:datasets_rel, second row), including some previously described from gene expression data [@doi:10.1126/science.1205438; @doi:10.3389/fgene.2019.01410; @doi:10.1091/mbc.9.12.3273], showed that for random/independent variables, all coefficients correctly agreed with a value close to zero.
The non-coexistence pattern, captured by all coefficients, represented a case where one gene ($x$) is expressed while the other one ($y$) is inhibited, highlighting a potentially strong biological relationship (such as a microRNA negatively regulating another gene).
Pearson and Spearman did not capture the nonlinear patterns between variables $x$ and $y$ in the quadratic and two-lines examples, while CCC increased the complexity of the model by using different degrees of complexity to capture the relationships.
For the quadratic pattern, CCC used four clusters for $x$ and achieved the maximum ARI.
In the two-lines example, CCC used eight clusters for $x$ and six for $y$, resulting in $c=0.31$, while Pearson and Spearman gave $p=-0.12$ and $s=0.05$, respectively.
