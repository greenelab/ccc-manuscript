### A robust and efficient not-only-linear dependence coefficient

![
**Different types of relationships in data.**
Each panel contains a set of simulated data points described by two generic variables: $x$ and $y$.
The first row shows Anscombe's quartet with four different datasets (from Anscombe I to IV) and 11 data points each.
The second row contains a set of general patterns with 100 data points each.
Each panel shows the correlation value using Pearson ($p$), Spearman ($s$) and CCC ($c$).
Vertical and horizontal red lines show how CCC clustered data points using $x$ and $y$.
](images/intro/relationships.svg "Different types of relationships in data"){#fig:datasets_rel width="100%"}

The CCC provides a measure of similarity between any pair of variables, which may have numerical or categorical values.
This method assumes that if two variables/features describing $n$ data points/objects are related, then the clusterings of those objects based on each variable should match.
For numerical values, CCC uses quantiles to divide data points into different clusters (e.g., the median separates numerical data into two clusters).
The CCC is then defined as the maximum adjusted Rand index (ARI) [@doi:10.1007/BF01908075] between the clusterings, with a range of 0 to 1.
Further details of the CCC algorithm can be found in the [Methods](#sec:ccc_algo) section.


We tested the Pearson ($p$), Spearman ($s$) and CCC ($c$) correlation coefficients on different simulated data patterns.
To illustrate the importance of going beyond simple statistics, we used the classic Anscombe's quartet [@doi:10.1080/00031305.1973.10478966], which consists of four datasets with different patterns but the same data statistics (mean, standard deviation and Pearson's correlation).
This was also recently revisited with the "Datasaurus" [@url:http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html; @doi:10.1145/3025453.3025912; @doi:10.1111/dsji.12233], which shows how summary statistics can mask undesirable patterns (such as outliers) or desirable ones (such as biologically meaningful nonlinear relationships).
The results of our analysis are shown in the first row of Figure @fig:datasets_rel.


On the other hand, CCC is more robust to outliers and nonlinear relationships.

The Anscombe I and III datasets both contain a linear pattern, and the CCC separates the data points into two clusters, resulting in a strong relationship (1.0).
The Anscombe II dataset has a partially quadratic relationship, which is interpreted as linear by Pearson and Spearman.
However, CCC yields a lower but non-zero value (0.34), indicating a more complex relationship than a linear pattern.
For the Anscombe IV dataset, the CCC correctly indicates no association (0.00) between the two variables, as there are ten different values of $y$ for a single value of $x$, aside from one outlier.
The Pearson's correlation coefficient is the same across all four Anscombe's examples ($p=0.82$), whereas Spearman is 0.50 or greater.
These datasets demonstrate that Pearson and Spearman are powerful for detecting linear patterns, but are affected by any deviation in this assumption (e.g.
nonlinear relationships or outliers).
In comparison, CCC is more robust to these factors.


Our simulations revealed that CCC can effectively detect nonlinear relationships that are not captured by traditional correlation coefficients.
We tested three different types of relationships (Figure @fig:datasets_rel, second row), including some previously described from gene expression data [@doi:10.1126/science.1205438; @doi:10.3389/fgene.2019.01410; @doi:10.1091/mbc.9.12.3273].
For the random/independent pair of variables, all coefficients correctly agreed with a value close to zero.
The non-coexistence pattern, captured by all coefficients, represents a case where one gene ($x$) might be expressed while the other one ($y$) is inhibited, highlighting a potentially strong biological relationship (such as a microRNA negatively regulating another gene).
For the other two examples (quadratic and two-lines), Pearson and Spearman did not capture the nonlinear pattern between variables $x$ and $y$.
CCC, however, successfully detected these patterns.
For the quadratic pattern, CCC separated $x$ into four clusters to reach the maximum ARI.
Similarly, for the two-lines example, CCC increased the complexity of the model by using eight clusters for $x$ and six for $y$, resulting in $c=0.31$.
