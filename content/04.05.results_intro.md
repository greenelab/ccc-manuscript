### A robust and efficient not-only-linear dependence coefficient

![
**Different types of relationships in data.**
Each panel contains a set of simulated data points described by two generic variables: $x$ and $y$.
The first row shows Anscombe's quartet with four different datasets (from Anscombe I to IV) and 11 data points each.
The second row contains a set of general patterns with 100 data points each.
Each panel shows the correlation value using Pearson ($p$), Spearman ($s$) and CCC ($c$).
Vertical and horizontal red lines show how CCC clustered data points using $x$ and $y$.
](images/intro/relationships.svg "Different types of relationships in data"){#fig:datasets_rel width="100%"}

The CCC method provides a similarity measure between any pair of variables, either with numerical or categorical values.
For numerical values, the method uses quantiles to separate data points into different clusters (e.g., the median separates numerical data into two clusters).
The CCC is then defined as the maximum adjusted Rand index (ARI) [@doi:10.1007/BF01908075] between these clusterings, with a value ranging between 0 and 1.
The assumption is that if there is a relationship between two variables/features describing $n$ data points/objects, then the clusterings of those objects using each variable should match.
Further details of the CCC algorithm can be found in the Methods section.


We tested the Pearson ($p$), Spearman ($s$) and CCC ($c$) correlation coefficients on different simulated data patterns.
Figure @fig:datasets_rel shows the results for the classic Anscombe's quartet [@doi:10.1080/00031305.1973.10478966], which comprises four datasets with different patterns but the same data statistics (mean, standard deviation and Pearson's correlation).
This type of simulated data has been recently revisited with the "Datasaurus" [@url:http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html; @doi:10.1145/3025453.3025912; @doi:10.1111/dsji.12233], to emphasize the importance of going beyond simple statistics.
This is because summary statistics alone can mask undesirable patterns (such as outliers) or desirable ones (such as biologically meaningful nonlinear relationships).


In contrast, CCC is able to detect nonlinear patterns and outliers, and is more robust in detecting complex relationships.


We simulated relationships shown in Figure @fig:datasets_rel, second row, which have been previously described in gene expression data [@doi:10.1126/science.1205438; @doi:10.3389/fgene.2019.01410; @doi:10.1091/mbc.9.12.3273].
For the random/independent pair of variables, all coefficients correctly agreed with a value close to zero.
The non-coexistence pattern, captured by all coefficients, indicated a potential biological relationship such as a microRNA negatively regulating another gene.
Pearson and Spearman coefficients, however, were not able to capture the nonlinear pattern between variables $x$ and $y$ in the quadratic and two-lines examples.
CCC, however, used different degrees of complexity to capture the relationships.
For the quadratic pattern, it separated $x$ into four clusters to reach the maximum ARI.
In the two-lines example, it used eight clusters for $x$ and six for $y$, resulting in $c=0.31$.
