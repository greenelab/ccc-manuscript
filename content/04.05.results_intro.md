### A robust and efficient not-only-linear dependence coefficient

![
**Different types of relationships in data.**
Each panel contains a set of simulated data points described by two generic variables: $x$ and $y$.
The first row shows Anscombe's quartet with four different datasets (from Anscombe I to IV) and 11 data points each.
The second row contains a set of general patterns with 100 data points each.
Each panel shows the correlation value using Pearson ($p$), Spearman ($s$) and CCC ($c$).
Vertical and horizontal red lines show how CCC clustered data points using $x$ and $y$.
](images/intro/relationships.svg "Different types of relationships in data"){#fig:datasets_rel width="100%"}

The CCC provides a similarity measure between any pair of variables, whether they have numerical or categorical values.
The method assumes that if there is a relationship between two variables/features describing $n$ data points/objects, then the **clusterings** of those objects based on each variable should be **similar**.
For numerical values, CCC uses quantiles to separate data points into different clusters (e.g., the median divides numerical data into two clusters).
The CCC is then defined as the maximum adjusted Rand index (ARI) [@doi:10.1007/BF01908075] between the two clusterings, ranging from 0 to 1.
More details of the CCC algorithm can be found in the [Methods](#sec:ccc_algo) section.


We tested the behavior of the Pearson, Spearman and CCC correlation coefficients on different simulated data patterns.
To demonstrate the importance of going beyond simple statistics, we used the Anscombe's quartet [@doi:10.1080/00031305.1973.10478966] as an example.
This quartet comprises four synthetic datasets with different patterns but the same data statistics (mean, standard deviation and Pearson's correlation).
Additionally, we used the "Datasaurus" [@url:http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html; @doi:10.1145/3025453.3025912; @doi:10.1111/dsji.12233] to remind us that summary statistics can hide undesirable patterns (such as outliers) or desirable ones (such as biologically meaningful nonlinear relationships).
The results of our analysis are shown in Figure @fig:datasets_rel.


The Anscombe datasets demonstrate that CCC is more robust in detecting nonlinear relationships than Pearson and Spearman.
In Anscombe I, a noisy but clear linear pattern was present, and CCC yielded a value of 1.0, indicating a strong relationship.
In Anscombe III, a perfect linear pattern was present, and CCC yielded a value of 1.0, again indicating a strong relationship.
In Anscombe II, a partially quadratic relationship was present, which was interpreted as linear by Pearson and Spearman.
However, CCC yielded a lower yet non-zero value of 0.34, reflecting a more complex relationship than a linear pattern.
In Anscombe IV, a vertical line of data points was present, and CCC yielded a value of 0.00, correctly indicating no association for this variable pair.
The Pearson's correlation coefficient was the same across all these Anscombe's examples ($p=0.82$), whereas Spearman was 0.50 or greater.
These simulated datasets show that CCC is more robust than Pearson and Spearman in detecting nonlinear relationships and outliers.


We simulated additional types of relationships (Figure @fig:datasets_rel, second row) from gene expression data, including some previously described [@doi:10.1126/science.1205438; @doi:10.3389/fgene.2019.01410; @doi:10.1091/mbc.9.12.3273].
For the random/independent pair of variables, all correlation coefficients correctly agreed with a value close to zero.
The non-coexistence pattern, captured by all coefficients, represented a case where one gene ($x$) might be expressed while the other one ($y$) is inhibited, highlighting a potentially strong biological relationship (such as a microRNA negatively regulating another gene).
Pearson and Spearman correlation coefficients failed to capture the nonlinear patterns between variables $x$ and $y$ for the other two examples (quadratic and two-lines).
CCC, however, used different degrees of complexity to capture these relationships.
For the quadratic pattern, CCC separated $x$ into four clusters to reach the maximum ARI.
The two-lines example demonstrated two embedded linear relationships with different slopes, which neither Pearson nor Spearman detected ($p=-0.12$ and $s=0.05$, respectively).
CCC increased the complexity of the model by using eight clusters for $x$ and six for $y$, resulting in $c=0.31$.
