### The CCC reveals linear and non-linear patterns in human transcriptomic data

Here we compare the coefficients on real gene expression data and highlight some complex and biologically interesting relationships that only CCC detects.
We used gene expression data from GTEx v8 across different tissues.
We selected the top 5,000 genes with the largest variance for our initial analyses on whole blood and then computed the correlation matrix between genes using Pearson, Spearman and CCC (see Methods).

![
**Distribution of coefficient values on gene expression (GTEx v8, whole blood).**
**a)** Histogram of coefficient values.
**b)** Corresponding cumulative histogram. The dotted line maps the coefficient value that accumulates 70% of gene pairs.
**c)** 2D histogram plot with hexagonal bins between all coefficients, where a logarithmic scale was used to color each hexagon.
](images/coefs_comp/gtex_whole_blood/dist-main.svg "Distribution of coefficient values"){#fig:dist_coefs width="100%"}


In Figure @fig:dist_coefs a, we show how the correlation values distribute, where CCC (mean=0.14, median=0.08, sd=0.15) has a much more skewed distribution than Pearson (mean=0.31, median=0.24, sd=0.24) and Spearman (mean=0.39, median=0.37, sd=0.26).
The cumulative histogram in Figure @fig:dist_coefs b shows that coefficients reach 70% of gene pairs at $c=0.18$, $p=0.44$ and $s=0.56$.
And the 2D histogram plot comparing each coefficient with each other is shown in Figures @fig:dist_coefs c, where CCC and Spearman tend to agree more than any of these with Pearson.


![
**Intersection of gene pairs with high and low correlation coefficient values (GTEx v8, whole blood).**
**a)** UpSet plot with six categories (rows) grouping the 30% of the highest (green triangle) and lowest (red triangle) values for each coefficient.
Columns show different intersections of categories grouped by agreements and disagreements.
**b)** Hexagonal binning plots with examples of gene pairs where CCC ($c$) disagrees with Pearson ($p$) and Spearman ($s$).
For each method, green and red triangles indicate if the gene pair is among the top (green) or bottom (red) 30% of coefficient values.
No triangle means that the correlation value for the gene pair is between the 30th and 70th percentiles (neither low nor high).
A logarithmic scale was used to color each hexagon.
](images/coefs_comp/gtex_whole_blood/upsetplot-main.svg "Intersection of gene pairs"){#fig:upsetplot_coefs width="100%"}


A closer inspection of gene pairs that were either prioritized or disregarded by these coefficients revealed their ability to capture different patterns.
For this, we analyzed the agreements and disagreements by obtaining, for each coefficient, the top 30% of gene pairs with the largest correlation values ("high" set) and the bottom 30% ("low" set), resulting in six potentially overlapping categories.
An UpSet plot [@doi:10.1109/TVCG.2014.2346248] is shown in Figure @fig:upsetplot_coefs a, where the intersections of these six categories allowed to precisely identify the gene expression patterns captured and missed by each coefficient.
For most cases, the three coefficients agreed on whether there is a strong correlation (42.1%) and whether there is no relationship (34.3%).
Since Pearson and Spearman are linear-only, and CCC can also capture these patterns, it would be relatively safe to assume that these highly correlated gene pairs represent strong linear patterns.
These results are crucial because it suggests that, at least for a large number of pairs, the user will not miss important linear patterns in expression data when using CCC.
The figure also confirms that CCC and Spearman agree more on either highly or poorly correlated pairs (4.0% in "high", and 7.0% in "low") than any of these with Pearson (all between 0.3%-3.5% for "high", and 2.8%-5.5% for "low").
In summary, CCC agrees with either Pearson or Spearman in 90.5% of gene pairs, either by assigning a high or a low correlation value.
Regarding disagreements (right part of Figure @fig:upsetplot_coefs a), more than 20 thousand gene pairs (20,987) with a high CCC value are not highly ranked by any other coefficients.
There are also gene pairs with a high Pearson value and either low CCC (1,075), low Spearman (87) or both low CCC and low Spearman values (531).
However, these cases mostly seem to be driven by potential outliers (Figure @fig:upsetplot_coefs b, explained below).
CCC does not miss gene pairs highly ranked by Spearman.
Moreover, CCC behaves very similarly to the Maximal Information Coefficient (MIC) in this data (see [Supplementary Material](#sec:mic)).
SAY SOMETHING ELSE HERE, IT'S MUCH MORE EFFICIENT! 100 times quicker.


Figure @fig:upsetplot_coefs b shows individual gene pairs among the top five of each intersection category in the "Disagreements" group where CCC disagrees with either Pearson, Spearman or both.
The first three gene pairs at the top (*IFNG* - *SDS*, *JUN* - *APOC1*, and *ZDHHC12* - *CCL18*), with high CCC and low Pearson values, seem to follow a non-coexistence relationship: in samples where one of the genes is highly (slightly) expressed, the other is slightly (highly) activated, suggesting a potential inhibiting effect.
The next three gene pairs (*UTY* - *KDM6A*, *RASSF2* - *CYTIP*, and *AC068580.6* - *KLHL21*) follow patterns combining either two linear or one linear and one independent relationships.
In particular, genes *UTY* and *KDM6A* (paralogs) show a non-linear relationship with a subset of samples following a robust linear pattern and another subset having a constant expression of one gene.
This relationship is explained by the fact that *UTY* is in chromosome Y (Yq11) whereas *KDM6A* is in chromosome X (Xp11), and samples with a linear pattern are males, whereas those with no expression for *UTY* are females.
This combination of linear and independent patterns is captured by CCC ($c=0.29$, above the 80th percentile) but not by Pearson ($p=0.24$, below the 55th percentile) or Spearman ($s=0.10$, below the 15th percentile).

![
**Scatter plots of genes *KDM6A* and *UTY* across different GTEx tissues.**
CCC correctly captures the relationship in all GTEx tissues, and here we show nine of them in the first three rows.
The last row shows three female-specific organs, where CCC correctly finds no association.
](images/coefs_comp/kdm6a_vs_uty/gtex-KDM6A_vs_UTY.svg "KDM6A and UTY across different GTEx tissues"){#fig:gtex_tissues:kdm6a_uty width="95%"}

Furthermore, the same gene pair pattern is highly ranked by CCC in all other tissues in GTEx, except for female-specific organs (Figure @fig:gtex_tissues:kdm6a_uty).
This particular example highlights the importance to consider sex as a biological variable (SABV) [@doi:10.1038/509282a] to avoid overlooking important differences between men and women, for example, in disease manifestations [@doi:10.1210/endrev/bnaa034; @doi:10.1038/s41593-021-00806-8].
In studies of the transcriptome, a not-only-linear correlation coefficient like CCC could indentify sex-specific differences in gene expression that, like the *UTY* - *KDM6A* example, are completely missed by linear-only coefficients.


Some of these genes, such as *SDS* (12q24) and *ZDHHC12* (9q34), were previously found to have a relatively lower number of publications that correlated well with a small set of chemical, physical and biological features [@pmid:30226837].
A gene co-expression analysis on large compendia and beyond linear patterns could shed light on the function of understudied genes.
On the other hand, gene *KLHL21* (1p36) and the novel RNA gene *AC068580.6* (*ENSG00000235027*, in 11p15) have a high CCC value and are entirely missed by the other methods.
*KLHL21* was suggested as a potential therapeutic target for hepatocellular carcinoma [@pmid:27769251] and other cancers [@pmid:29574153; @pmid:35084622], and its non-linear correlation with *AC068580.6* and potentially other genes might unveil other important players in cancer initiation or progression.



### Replication of gene associations using tissue-specific networks from GIANT

We analyzed the other gene pairs in Figure @fig:upsetplot_coefs b to assess whether associations were replicated in other datasets besides GTEx.
This is challenging and prone to bias because usually linear-only correlation coefficients are used in gene co-expression analyses.
We used 144 tissue-specific gene networks from the Genome-wide Analysis of gene Networks in Tissues (GIANT) [@pmcid:PMC4828725], where nodes represent genes and each edge a functional relationship weighted with a probability of interaction between two genes (see Methods).
Importantly, the version of GIANT used in this study did not include GTEx samples [@url:https://hb.flatironinstitute.org/data], making it an ideal case for replication.
These networks were built from 987 genome-scale data sets across approximately 38,000 conditions, including expression and different interaction measurements such as gene co-expression (using Pearson correlation after several preprocessing steps), protein-interaction, transcription factor regulation, and chemical/genetic perturbations and microRNA target profiles from the Molecular Signatures Database (MSigDB [@pmid:16199517]).
We reasoned that our highly-ranked gene pairs using three different coefficients in a single tissue (whole blood in GTEx, Figure fig:upsetplot_coefs b) should replicate across the multi-tissue, multi-cell type functional interaction networks in GIANT.
First, for each gene pair in Figure @fig:upsetplot_coefs b for which genes were present in GIANT models (this excluded *AC068580.6* - *KLHL21*, which we comment below), we ran the tissue-specific interaction analysis selecting "blood" tissue, which was the most equivalent to whole blood in GTEx.


![
**Predicted blood-specific networks from GIANT for six gene pairs prioritized by correlation coefficients.**
A node represents a gene and an edge the probability that two genes are part of the same biological process in blood.
A maximum of 15 genes are shown for each subfigure.
The GIANT web application automatically determined a minimum interaction confidence (edges's weights) to be shown.
All these analyses can be performed online using the following links:
*IFNG* - *SDS* [@url:https://hb.flatironinstitute.org/gene/10993+3458],
*JUN* - *APOC1* [@url:https://hb.flatironinstitute.org/gene/3725+341],
*ZDHHC12* - *CCL18* [@url:https://hb.flatironinstitute.org/gene/6362+84885],
*RASSF2* - *CYTIP* [@url:https://hb.flatironinstitute.org/gene/9770+9595],
*MYOZ1* - *TNNI2* [@url:https://hb.flatironinstitute.org/gene/58529+7136],
*PYGM* - *TPM2* [@url:https://hb.flatironinstitute.org/gene/5837+7169].
The GIANT web-server was accessed on April 4, 2022.
](images/coefs_comp/giant_networks/blood_tissues/main.svg "GIANT network interaction"){#fig:giant_gene_pairs:blood width="100%"}


The predicted blood-specific networks for each of these six gene pairs is shown in Figure @fig:giant_gene_pairs:blood.
Two large black nodes in each network's top-left and bottom-right corners represent our gene pairs.
A green edge means a close-to-zero probability of interaction, whereas a red edge represents a strong predicted relationship between two genes.
In general, gene pairs highly ranked by CCC were part of more cohesive networks compared with Pearson and Spearman.
For example, the average probability of interaction of the other genes with both *IFNG* and *SDS* was 0.42 and 0.29, respectively (Supplementary Table @tbl:giant:weights), whereas their direct interaction was only 0.11.
A similar pattern was found for  *JUN* and *APOC1*, where the interaction probability was 0.68 and 0.47, respectively, but their direct interaction was only 0.07.
The evidence of interaction between *ZDHHC12* and *CCL18* as less evident.
Their averages of 0.07 and 0.79, respectively, showed a dense network connected with *CCL18*, although the predicted interaction of *ZDHHC12* with this potential process was weak.
*RASSF2* and *CYTIP*, with a high CCC value ($c=0.20$) and low Pearson and Spearman ($p=0.16$ and $s=0.11$), were both strongly connected to the network, with interaction scores of at least 0.63 for both and an average of 0.75 and 0.84, respectively.
The direct interaction between *RASSF2* and *CYTIP* was still high (0.63) and mostly explained by co-expression [@url:https://hb.flatironinstitute.org/gene/9770+9595].
In GIANT, gene co-expression was calculated using Pearson after several data preprocessing steps, and the probability of interaction was calculated by integrating various data sets (50 for this gene pair).
The contribution of each data set to the interaction probability of a gene pair is generally very small (0.01 or less), suggesting that predicting a link between *RASSF2* and *CYTIP* was only possible using advanced network algorithms.
In this study, we found this strong connection using a single data set but a more powerful correlation coefficient.
Finally, the two gene pairs with high Pearson values and low CCC showed both weaker direct and indirect connections:
*MYOZ1* and *TNNI2* had both low average interaction scores of 0.17 and 0.22 with the rest of the genes, and the direct interation between them was only 0.10.
On the other hand, the average interaction probability of *PYGM* with the network was very low (0.04), and the direct interaction with *TPM2* was predicted to be 0.05.
This lack of replication for these two gene pairs in GIANT suggests that their high Pearson value is driven by outliers (Figure @fig:upsetplot_coefs b).


We also assessed whether top gene pairs detected in whole blood from GTEx had evidence of being specifically expressed in blood cell lineages.
For this, we let GIANT to automatically predict a relevant tissue- or cell type-specific network, which uses a computational method described in [@doi:10.1101/gr.155697.113].
Briefly, the approach trains a machine learning model using comprehensive transcriptional data with human-curated markers of different cell lineages (e.g., macrophages) as gold standards.
Then, these models are used to predict additional cell lineage-specific genes.
All six gene pairs prioritized by CCC were predicted to be specific to a blood-relevant cell lineage (Supplementary Figure @fig:giant_gene_pairs:pred_tissue): natural killer cells, mononuclear phagocytes, macrophages and leukocytes.
Additionally, the interaction of these gene pairs with the cell lineage-specific networks improved over a blood network (Supplementary Table @tbl:giant:weights).
Conversely, the top two Pearson gene pairs were predicted to be specific to skeletal muscle, and their interaction decreased.
To confirm whether these patterns were globally present, we performed a systematic evaluation using the top 100 gene pairs from each intersection where CCC disagrees with either Pearson and Spearman.
For each gene pair, we automatically predicted a relevant tissue or cell type network using GIANT, and then took the top 5 more common tissues in each intersection (i.e, CCC high and Pearson low, Person high and CCC low, etc, shown in Figure @fig:upsetplot_coefs a).

![
**Summary of predicted tissue/cell type networks for gene pairs exclusively prioritized by CCC and Pearson.**
The first row combines all gene pairs where CCC is high and either Pearson or Spearman are low.
The second rows combines all gene pairs where Pearson is high and either CCC Spearman are low.
Bar plots (left) show the number of gene pairs for each predicted tissue/cell type.
Box plots (right) show the average probability of interaction between genes in these prediced tissue-specific networks.
](images/coefs_comp/giant_networks/top_gene_pairs-main.svg "GIANT network interaction on gene pairs"){#fig:giant_gene_pairs:top width="100%"}

Each row in Figure @fig:giant_gene_pairs:top shows 1) the number of gene pairs predicted to be specific to a tissue (bar plot on the left) and 2) the average probability of gene interaction in each tissue-specific network (box plot on the right).
Notably, most gene pairs highly prioritized by CCC and not by the rest were predicted to be strongly blood-specific, including several cell lineages in this tissue like natural killer cells, macrophages, and other leukocytes.
The average probability of interaction between genes in these CCC-ranked networks was also very high, with all medians close to 75% and 1st quartiles above 40% in most tissues.
In contrast, most of the gene pairs exclusively prioritized by Pearson where predicted to be specific to tissues not directly related to blood.
The probabilities of interaction in these Pearson-ranked networks were also generally lower than in CCC, with the exception of blood-specific gene pairs.
The gene-gene relationships exclusively detected by CCC in blood were replicated in more sophisticated models trained without GTEx.
These results suggest that CCC is able to capture cell lineage-specific transcriptional patterns from bulk RNA-seq.
