## Introduction

The increasing availability of data has opened up new possibilities for scientific exploration.
To take advantage of this, we need efficient tools to identify multiple types of relationships between variables.
Correlation analysis is a useful statistical technique to uncover such relationships [@pmid:21310971].
Correlation coefficients are often used in data mining techniques, such as clustering or community detection, to calculate the similarity between two objects, like genes [@pmid:27479844] or lifestyle factors related to diseases [@doi:10.1073/pnas.1217269109].
They are also used in supervised tasks, like feature selection, to boost prediction accuracy [@pmid:27006077; @pmid:33729976].
The Pearson correlation coefficient is widely used across many application domains and scientific disciplines.
Therefore, even small improvements in this technique can have a huge impact on industry and research.


In transcriptomics, correlation analysis is used to estimate the relationship between genes.
This approach has been used to suggest gene function [@pmid:21241896], discover common and cell lineage-specific regulatory networks [@pmid:25915600], and uncover molecular mechanisms in other species [@pmid:21606319; @pmid:16968540].
Large RNA-seq datasets [@pmid:32913098; @pmid:34844637] can also be used to reveal complex transcriptional mechanisms underlying human diseases [@pmid:27479844; @pmid:31121115; @pmid:30668570; @pmid:32424349; @pmid:34475573].
The introduction of the omnigenic model of complex traits [@pmid:28622505; @pmid:31051098] has highlighted the importance of gene-gene relationships in genetic studies of human diseases [@pmid:34845454; @doi:10.1101/2021.07.05.450786; @doi:10.1101/2021.10.21.21265342; @doi:10.1038/s41588-021-00913-z], including those related to polygenic risk scores [@doi:10.1016/j.ajhg.2021.07.003].
Combining disease-associated genes from genome-wide association studies (GWAS) with gene co-expression networks to prioritize "core" genes has become a popular approach to find genes that directly affect diseases [@doi:10.1186/s13040-020-00216-9; @doi:10.1101/2021.07.05.450786; @doi:10.1101/2021.10.21.21265342].
These core genes are not identified by standard statistical methods, but are believed to be part of highly-interconnected, disease-relevant regulatory networks.
Therefore, advanced correlation coefficients have potential applications across many areas of biology, including the identification of candidate drug targets in precision medicine.


The Pearson and Spearman correlation coefficients are widely used to measure the strength of linear or monotonic relationships between two variables, and can be computed quickly.
However, they may miss complex, yet critical nonlinear relationships.
To capture these, novel correlation coefficients have been proposed, such as the Maximal Information Coefficient (MIC) [@pmid:22174245] and the Distance Correlation (DC) [@doi:10.1214/009053607000000505].
MIC, in particular, has been applied successfully across several domains [@pmid:33972855; @pmid:33001806; @pmid:27006077], but its computational complexity makes it impractical for even moderately sized datasets [@pmid:33972855; @pmid:27333001].
For example, it can take several seconds to compute on a single variable pair across a few thousand objects or conditions [@pmid:33972855].
To address this issue, we previously developed a clustering method that significantly outperformed Pearson, Spearman, DC and MIC in detecting clusters of simulated linear and nonlinear relationships with varying noise levels [@doi:10.1093/bioinformatics/bty899].
Here, we introduce the Clustermatch Correlation Coefficient (CCC), an efficient not-only-linear coefficient that works across quantitative and qualitative variables.
CCC has a single parameter that limits the maximum complexity of relationships found (from linear to more general patterns) and computation time.
CCC provides flexibility to detect specific types of patterns, while providing safe defaults to capture general relationships.
We also provide an efficient CCC implementation that is highly parallelizable, allowing to speed up computation across variable pairs with millions of objects or conditions.
To assess its performance, we applied our method to gene expression data from the Genotype-Tissue Expression v8 (GTEx) project across different tissues [@doi:10.1126/science.aaz1776].
CCC captured both strong linear relationships and novel nonlinear patterns, which were entirely missed by standard coefficients.
For example, some of these nonlinear patterns were associated with sex differences in gene expression, suggesting that CCC can capture strong relationships present only in a subset of samples.
We also found that the CCC behaves similarly to MIC in several cases, although it is much faster to compute.
Gene pairs detected in expression data by CCC had higher interaction probabilities in tissue-specific gene networks from the Genome-wide Analysis of gene Networks in Tissues (GIANT) [@doi:10.1038/ng.3259].
Furthermore, its ability to efficiently handle different data types (including numerical and categorical features) reduces preprocessing steps and makes it attractive for analyzing large and heterogeneous repositories.
