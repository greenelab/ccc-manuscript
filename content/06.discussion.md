## Discussion

We introduced the Clustermatch Correlation Coefficient (CCC), an efficient not-only-linear machine learning-based method that captures more general patterns in data.
We applied it to gene expression data from GTEx v8 and found that our coefficient is robust to outliers and does not miss strongly linear relationships in gene-gene patterns.
Moreover, CCC also captured complex and biologically meaningful relationships completely missed by standard coefficients.
For instance, CCC exclusively detected gene pairs from the sex chromosomes following complex non-linear patterns.
These examples, in particular, highlight the importance of considering sex as a biological variable and the critical role that not-only-linear coefficients can play in capturing sex-specific differences.
We also replicated gene pairs prioritized by CCC in GTEx using tissue-specific gene networks from GIANT trained without GTEx samples.
We found that top CCC-ranked gene pairs in whole blood from GTEx were predicted in GIANT to be part of the same biological mechanism and specifically expressed in cell lineages from blood, even though CCC did not have access to any cell lineage-specific information.
This suggests that CCC can disentangle intricate cell lineage-specific transcriptional patterns missed by linear-only coefficients.
CCC derives scores very well aligned with MIC while being much more computationally efficient and thus practical for use in large modern datasets.
Our approach has a single parameter that controls the complexity of the detected relationships while also balancing compute time.
Finally, CCC is conceptually easy to interpret and robust to outliers, making it an advanced coefficient that can focus human interpretation on patterns more likely to resemble biological processes.


Datasets such as Anscombe or "Datasaurus" highlight the value of visualization instead of relying on simple data summaries.
While visual analysis is helpful, for many datasets examining each possible relationship is infeasible, and this is where more sophisticated and robust correlation coefficients are necessary.
Advanced yet interpretable coefficients can focus human interpretation on patterns that are more likely to reflect real biology.
Those that capture non-linear patterns can reveal relationships missed by the linear-only coefficients that are often deployed.
For example, genes *UTY* - *KDM6A* (from sex chromosomes), detected by CCC, have a strong linear relationship but only in a subset of samples (males), which was not captured by linear-only coefficients.
This example highlights the importance of considering sex as a biological variable (SABV) [@doi:10.1038/509282a] to avoid overlooking important differences between men and women, for example, in disease manifestations [@doi:10.1210/endrev/bnaa034; @doi:10.1038/s41593-021-00806-8].
In transcriptome studies, a not-only-linear correlation coefficient like CCC could identify important sex-specific differences in gene expression that are entirely missed by linear-only coefficients.


It is well-known that biomedical research is biased towards a small fraction of human genes [@pmid:17620606; @pmid:17472739].
Some genes analyzed in this study (Figure @fig:upsetplot_coefs b), such as *SDS* (12q24) and *ZDHHC12* (9q34), were previously found to have a relatively lower number of publications that were explained by a small set of chemical, physical and biological features [@pmid:30226837].
A gene co-expression analysis on large compendia and beyond linear patterns could shed light on the function of understudied genes.
On the other hand, gene *KLHL21* (1p36) and the novel RNA gene *AC068580.6* (*ENSG00000235027*, in 11p15) have a high CCC value and are missed by the other coefficients.
*KLHL21* was suggested as a potential therapeutic target for hepatocellular carcinoma [@pmid:27769251] and other cancers [@pmid:29574153; @pmid:35084622].Its non-linear correlation with *AC068580.6* might unveil other important players in cancer initiation or progression, potentially in subsets of samples with specific characteristics (as suggested in Figure @fig:upsetplot_coefs b).


<!-- Researching genes with well-known functions is easier, although this observational bias seems anachronic with current high-throughput technologies.
Several factors explaining this behavior have been identified [@pmid:30226837], such as RNA and protein abundance or gene length.
Another potential explanation could also be a bias towards linear-only statistical methods.
For example, genome-wide association studies (GWAS) employ a linear model to estimate the association between genotype and phenotype, while adjusting for a set of covariates such as sex, age and population stratification (using principal component analysis) to reduce confounding.
Although GWAS have been successful to understand the molecular basis of common diseases [@doi:10.1038/s41588-018-0241-6], specifying the model is challenging, for example modeling the relationship between phenotype and covariates. -->


Not-only-linear correlation coefficients might be also useful in the field of genetic studies.
In this context, genome-wide association studies (GWAS) have been successful to understand the molecular basis of common diseases by estimating the association between genotype and phenotype [@doi:10.1038/s41588-018-0241-6].
However, the estimated effect sizes of genes identified with GWAS are generally modest, and they explain only a fraction of the trait variance, hampering the clinical translation of these findings [@doi:10.1038/s41576-019-0127-1].
Recent theories, like the omnigenic model for complex traits [@pmid:28622505; @pmid:31051098], argue that these observations are explained by highly-interconnected gene regulatory networks, with some core genes having a more direct effect on the phenotype than others.
Using this omnigenic perspective, we and others [@doi:10.1101/2021.07.05.450786; @doi:10.1186/s13040-020-00216-9; @doi:10.1101/2021.10.21.21265342] have shown that integrating gene co-expression networks in genetic studies could potentially identify core genes that are missed by linear-only models alone like GWAS.
Our results suggest that building these networks with more advanced and efficient correlation coefficients could better estimate gene co-expression profiles and thus more accurately identify these core genes.
Approaches like CCC could play a significant role in the precision medicine field by providing the computational tools to focus on more promising genes, representing potentially better candidate drug targets.


Our analyses have some limitations.
We worked on a sample with the top variable genes to keep computation time feasible.
Although CCC is much faster than MIC, Pearson and Spearman are still the most computationally efficient since they only rely on simple data statistics.
However, as we have shown, this significantly limits their ability beyond linear patterns.
Even with this small sample of genes, our results confirm that the advantages of using more advanced coefficients like CCC can help detect and study more intricate molecular mechanisms.
Although we only used GTEx, we could still find complex and meaningful patterns within this homogeneous set of samples.
The application of CCC on larger compendia, such as recount3 [@pmid:34844637] with thousands of heterogeneous samples across different conditions, can reveal other potentially meaningful gene interactions.
The single parameter of CCC, $k_{\mathrm{max}}$, controls the complexity of patterns found and also the compute time.
We used $k_{\mathrm{max}}=10$ in our analyses which, given our results, seems to be enough to find both linear and more complex patterns.
A more comprehensive analysis of the most optimal values for this parameter could provide insights into better adjusting it for different applications.


While linear and rank-based correlation coefficients are exceptionally fast to calculate, not all relevant patterns in biological datasets are linear.
For example, patterns associated with sex as a biological variable are not apparent to the linear-only coefficients that we evaluated but are revealed by not-only-linear methods.
Not-only-linear coefficients can also disentangle intricate, yet relevant patterns from gene expression data alone replicated in models integrating different data modalities.
CCC, in particular, is highly parallelizable, and we anticipate efficient GPU-based implementations that could make it even faster.
We found that the CCC is an efficient, next-generation correlation coefficient that is highly effective in transcriptome analyses and potentially useful in a broad range of other domains.
