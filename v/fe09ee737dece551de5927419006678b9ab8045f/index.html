<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Milton Pividori" />
  <meta name="author" content="Marylyn D. Ritchie" />
  <meta name="author" content="Diego H. Milone" />
  <meta name="author" content="Casey S. Greene" />
  <meta name="dcterms.date" content="2022-06-27" />
  <meta name="keywords" content="correlation coefficient, nonlinear relationships, gene expression" />
  <title>An efficient not-only-linear correlation coefficient based on machine learning</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
  <!--
  Manubot generated metadata rendered from header-includes-template.html.
  Suggest improvements at https://github.com/manubot/manubot/blob/main/manubot/process/header-includes-template.html
  -->
  <meta name="dc.format" content="text/html" />
  <meta name="dc.title" content="An efficient not-only-linear correlation coefficient based on machine learning" />
  <meta name="citation_title" content="An efficient not-only-linear correlation coefficient based on machine learning" />
  <meta property="og:title" content="An efficient not-only-linear correlation coefficient based on machine learning" />
  <meta property="twitter:title" content="An efficient not-only-linear correlation coefficient based on machine learning" />
  <meta name="dc.date" content="2022-06-27" />
  <meta name="citation_publication_date" content="2022-06-27" />
  <meta name="dc.language" content="en-US" />
  <meta name="citation_language" content="en-US" />
  <meta name="dc.relation.ispartof" content="Manubot" />
  <meta name="dc.publisher" content="Manubot" />
  <meta name="citation_journal_title" content="Manubot" />
  <meta name="citation_technical_report_institution" content="Manubot" />
  <meta name="citation_author" content="Milton Pividori" />
  <meta name="citation_author_institution" content="Department of Genetics, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA" />
  <meta name="citation_author_orcid" content="0000-0002-3035-4403" />
  <meta name="twitter:creator" content="@miltondp" />
  <meta name="citation_author" content="Marylyn D. Ritchie" />
  <meta name="citation_author_institution" content="Department of Genetics, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA" />
  <meta name="citation_author_orcid" content="0000-0002-1208-1720" />
  <meta name="twitter:creator" content="@MarylynRitchie" />
  <meta name="citation_author" content="Diego H. Milone" />
  <meta name="citation_author_institution" content="Research Institute for Signals, Systems and Computational Intelligence (sinc(i)), Universidad Nacional del Litoral, Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET), Santa Fe CP3000, Argentina" />
  <meta name="citation_author_orcid" content="0000-0003-2182-4351" />
  <meta name="twitter:creator" content="@d1001" />
  <meta name="citation_author" content="Casey S. Greene" />
  <meta name="citation_author_institution" content="Center for Health AI, University of Colorado School of Medicine, Aurora, CO 80045, USA" />
  <meta name="citation_author_institution" content="Department of Biochemistry and Molecular Genetics, University of Colorado School of Medicine, Aurora, CO 80045, USA" />
  <meta name="citation_author_orcid" content="0000-0001-8713-9213" />
  <meta name="twitter:creator" content="@GreeneScientist" />
  <link rel="canonical" href="https://greenelab.github.io/ccc-manuscript/" />
  <meta property="og:url" content="https://greenelab.github.io/ccc-manuscript/" />
  <meta property="twitter:url" content="https://greenelab.github.io/ccc-manuscript/" />
  <meta name="citation_fulltext_html_url" content="https://greenelab.github.io/ccc-manuscript/" />
  <meta name="citation_pdf_url" content="https://greenelab.github.io/ccc-manuscript/manuscript.pdf" />
  <link rel="alternate" type="application/pdf" href="https://greenelab.github.io/ccc-manuscript/manuscript.pdf" />
  <link rel="alternate" type="text/html" href="https://greenelab.github.io/ccc-manuscript/v/fe09ee737dece551de5927419006678b9ab8045f/" />
  <meta name="manubot_html_url_versioned" content="https://greenelab.github.io/ccc-manuscript/v/fe09ee737dece551de5927419006678b9ab8045f/" />
  <meta name="manubot_pdf_url_versioned" content="https://greenelab.github.io/ccc-manuscript/v/fe09ee737dece551de5927419006678b9ab8045f/manuscript.pdf" />
  <meta property="og:type" content="article" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="icon" type="image/png" sizes="192x192" href="https://manubot.org/favicon-192x192.png" />
  <link rel="mask-icon" href="https://manubot.org/safari-pinned-tab.svg" color="#ad1457" />
  <meta name="theme-color" content="#ad1457" />
  <!-- end Manubot generated metadata -->
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">An efficient not-only-linear correlation coefficient based on machine learning</h1>
</header>
<p><em>A DOI-citable version of this manuscript is available at <a href="https://doi.org/10.1101/2022.06.15.496326" class="uri">https://doi.org/10.1101/2022.06.15.496326</a></em>.</p>
<!-- 
<small><em>
This manuscript
([permalink](https://greenelab.github.io/ccc-manuscript/v/fe09ee737dece551de5927419006678b9ab8045f/))
was automatically generated
from [greenelab/ccc-manuscript@fe09ee7](https://github.com/greenelab/ccc-manuscript/tree/fe09ee737dece551de5927419006678b9ab8045f)
on June 27, 2022.
</em></small> -->
<h2 id="authors">Authors</h2>
<ul>
<li><p><strong>Milton Pividori</strong><br>
<img src="images/orcid.svg" class="inline_icon" width="16" height="16" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-3035-4403">0000-0002-3035-4403</a>
· <img src="images/github.svg" class="inline_icon" width="16" height="16" alt="GitHub icon" />
<a href="https://github.com/miltondp">miltondp</a>
· <img src="images/twitter.svg" class="inline_icon" width="16" height="16" alt="Twitter icon" />
<a href="https://twitter.com/miltondp">miltondp</a><br>
<small>
Department of Genetics, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA
· Funded by The Gordon and Betty Moore Foundation GBMF 4552; The National Human Genome Research Institute (R01 HG010067)
</small></p></li>
<li><p><strong>Marylyn D. Ritchie</strong><br>
<img src="images/orcid.svg" class="inline_icon" width="16" height="16" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-1208-1720">0000-0002-1208-1720</a>
· <img src="images/twitter.svg" class="inline_icon" width="16" height="16" alt="Twitter icon" />
<a href="https://twitter.com/MarylynRitchie">MarylynRitchie</a><br>
<small>
Department of Genetics, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA
</small></p></li>
<li><p><strong>Diego H. Milone</strong><br>
<img src="images/orcid.svg" class="inline_icon" width="16" height="16" alt="ORCID icon" />
<a href="https://orcid.org/0000-0003-2182-4351">0000-0003-2182-4351</a>
· <img src="images/github.svg" class="inline_icon" width="16" height="16" alt="GitHub icon" />
<a href="https://github.com/dmilone">dmilone</a>
· <img src="images/twitter.svg" class="inline_icon" width="16" height="16" alt="Twitter icon" />
<a href="https://twitter.com/d1001">d1001</a><br>
<small>
Research Institute for Signals, Systems and Computational Intelligence (sinc(i)), Universidad Nacional del Litoral, Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET), Santa Fe CP3000, Argentina
</small></p></li>
<li><p><strong>Casey S. Greene</strong><br>
<img src="images/orcid.svg" class="inline_icon" width="16" height="16" alt="ORCID icon" />
<a href="https://orcid.org/0000-0001-8713-9213">0000-0001-8713-9213</a>
· <img src="images/github.svg" class="inline_icon" width="16" height="16" alt="GitHub icon" />
<a href="https://github.com/cgreene">cgreene</a>
· <img src="images/twitter.svg" class="inline_icon" width="16" height="16" alt="Twitter icon" />
<a href="https://twitter.com/GreeneScientist">GreeneScientist</a><br>
<small>
Center for Health AI, University of Colorado School of Medicine, Aurora, CO 80045, USA; Department of Biochemistry and Molecular Genetics, University of Colorado School of Medicine, Aurora, CO 80045, USA
· Funded by The Gordon and Betty Moore Foundation (GBMF 4552); The National Human Genome Research Institute (R01 HG010067); The National Cancer Institute (R01 CA237170)
</small></p></li>
</ul>
<h2 class="page_break_before" id="abstract">Abstract</h2>
<p>Correlation coefficients are widely used to identify patterns in data that may be of particular interest.
In transcriptomics, genes with correlated expression often share functions or are part of disease-relevant biological processes.
Here we introduce the Clustermatch Correlation Coefficient (CCC), an efficient, easy-to-use and not-only-linear coefficient based on machine learning models.
CCC reveals biologically meaningful linear and nonlinear patterns missed by standard, linear-only correlation coefficients.
CCC captures general patterns in data by comparing clustering solutions while being much faster than state-of-the-art coefficients such as the Maximal Information Coefficient.
When applied to human gene expression data, CCC identifies robust linear relationships while detecting nonlinear patterns associated, for example, with sex differences that are not captured by linear-only coefficients.
Gene pairs highly ranked by CCC were enriched for interactions in integrated networks built from protein-protein interaction, transcription factor regulation, and chemical and genetic perturbations, suggesting that CCC could detect functional relationships that linear-only methods missed.
CCC is a highly-efficient, next-generation not-only-linear correlation coefficient that can readily be applied to genome-scale data and other domains across different data types.</p>
<h2 id="introduction">Introduction</h2>
<p>New technologies have vastly improved data collection, generating a deluge of information across different disciplines.
This large amount of data provides new opportunities to address unanswered scientific questions, provided we have efficient tools capable of identifying multiple types of underlying patterns.
Correlation analysis is an essential statistical technique for discovering relationships between variables <span class="citation" data-cites="DUeOcxpt">[<a href="#ref-DUeOcxpt" role="doc-biblioref">1</a>]</span>.
Correlation coefficients are often used in exploratory data mining techniques, such as clustering or community detection algorithms, to compute a similarity value between a pair of objects of interest such as genes <span class="citation" data-cites="yvIastvc">[<a href="#ref-yvIastvc" role="doc-biblioref">2</a>]</span> or disease-relevant lifestyle factors <span class="citation" data-cites="14q47vZTA">[<a href="#ref-14q47vZTA" role="doc-biblioref">3</a>]</span>.
Correlation methods are also used in supervised tasks, for example, for feature selection to improve prediction accuracy <span class="citation" data-cites="iZjSr8s2 1FQ1FgsCm">[<a href="#ref-iZjSr8s2" role="doc-biblioref">4</a>,<a href="#ref-1FQ1FgsCm" role="doc-biblioref">5</a>]</span>.
The Pearson correlation coefficient is ubiquitously deployed across application domains and diverse scientific areas.
Thus, even minor and significant improvements in these techniques could have enormous consequences in industry and research.</p>
<p>In transcriptomics, many analyses start with estimating the correlation between genes.
More sophisticated approaches built on correlation analysis can suggest gene function <span class="citation" data-cites="16aFivIcr">[<a href="#ref-16aFivIcr" role="doc-biblioref">6</a>]</span>, aid in discovering common and cell lineage-specific regulatory networks <span class="citation" data-cites="q5QZW3xH">[<a href="#ref-q5QZW3xH" role="doc-biblioref">7</a>]</span>, and capture important interactions in a living organism that can uncover molecular mechanisms in other species <span class="citation" data-cites="17eqTELga x9k6ERo9">[<a href="#ref-17eqTELga" role="doc-biblioref">8</a>,<a href="#ref-x9k6ERo9" role="doc-biblioref">9</a>]</span>.
The analysis of large RNA-seq datasets <span class="citation" data-cites="vsBvj38s TryC3OjB">[<a href="#ref-vsBvj38s" role="doc-biblioref">10</a>,<a href="#ref-TryC3OjB" role="doc-biblioref">11</a>]</span> can also reveal complex transcriptional mechanisms underlying human diseases <span class="citation" data-cites="yvIastvc zwyRqHIg 13mfjo6Kw 12H2nr6Rc qAH2cGOH">[<a href="#ref-yvIastvc" role="doc-biblioref">2</a>,<a href="#ref-zwyRqHIg" role="doc-biblioref">12</a>,<a href="#ref-13mfjo6Kw" role="doc-biblioref">13</a>,<a href="#ref-12H2nr6Rc" role="doc-biblioref">14</a>,<a href="#ref-qAH2cGOH" role="doc-biblioref">15</a>]</span>.
Since the introduction of the omnigenic model of complex traits <span class="citation" data-cites="g7Id81Dt sfMulPrl">[<a href="#ref-g7Id81Dt" role="doc-biblioref">16</a>,<a href="#ref-sfMulPrl" role="doc-biblioref">17</a>]</span>, gene-gene relationships are playing an increasingly important role in genetic studies of human diseases <span class="citation" data-cites="1EN7sv6pQ FEh1bD0A 17f9RJ1ul sGgkLsyy">[<a href="#ref-1EN7sv6pQ" role="doc-biblioref">18</a>,<a href="#ref-FEh1bD0A" role="doc-biblioref">19</a>,<a href="#ref-17f9RJ1ul" role="doc-biblioref">20</a>,<a href="#ref-sGgkLsyy" role="doc-biblioref">21</a>]</span>, even in specific fields such as polygenic risk scores <span class="citation" data-cites="14ZMJkeR2">[<a href="#ref-14ZMJkeR2" role="doc-biblioref">22</a>]</span>.
In this context, recent approaches combine disease-associated genes from genome-wide association studies (GWAS) with gene co-expression networks to prioritize “core” genes directly affecting diseases <span class="citation" data-cites="57TjOMEA FEh1bD0A 17f9RJ1ul">[<a href="#ref-FEh1bD0A" role="doc-biblioref">19</a>,<a href="#ref-17f9RJ1ul" role="doc-biblioref">20</a>,<a href="#ref-57TjOMEA" role="doc-biblioref">23</a>]</span>.
These core genes are not captured by standard statistical methods but are believed to be part of highly-interconnected, disease-relevant regulatory networks.
Therefore, advanced correlation coefficients could immediately find wide applications across many areas of biology, including the prioritization of candidate drug targets in the precision medicine field.</p>
<p>The Pearson and Spearman correlation coefficients are widely used because they reveal intuitive relationships and can be computed quickly.
However, they are designed to capture linear or monotonic patterns (referred to as linear-only) and may miss complex yet critical relationships.
Novel coefficients have been proposed as metrics that capture nonlinear patterns such as the Maximal Information Coefficient (MIC) <span class="citation" data-cites="tbcQL0eR">[<a href="#ref-tbcQL0eR" role="doc-biblioref">24</a>]</span> and the Distance Correlation (DC) <span class="citation" data-cites="IvOGGmxI">[<a href="#ref-IvOGGmxI" role="doc-biblioref">25</a>]</span>.
MIC, in particular, is one of the most commonly used statistics to capture more complex relationships, with successful applications across several domains <span class="citation" data-cites="NnsqWXcp g8HrFUfP iZjSr8s2">[<a href="#ref-iZjSr8s2" role="doc-biblioref">4</a>,<a href="#ref-NnsqWXcp" role="doc-biblioref">26</a>,<a href="#ref-g8HrFUfP" role="doc-biblioref">27</a>]</span>.
However, the computational complexity makes them impractical for even moderately sized datasets <span class="citation" data-cites="NnsqWXcp ztrPHUjX">[<a href="#ref-NnsqWXcp" role="doc-biblioref">26</a>,<a href="#ref-ztrPHUjX" role="doc-biblioref">28</a>]</span>.
Recent implementations of MIC, for example, take several seconds to compute on a single variable pair across a few thousand objects or conditions <span class="citation" data-cites="NnsqWXcp">[<a href="#ref-NnsqWXcp" role="doc-biblioref">26</a>]</span>.
We previously developed a clustering method for highly diverse datasets that significantly outperformed approaches based on Pearson, Spearman, DC and MIC in detecting clusters of simulated linear and nonlinear relationships with varying noise levels <span class="citation" data-cites="VCRLONE">[<a href="#ref-VCRLONE" role="doc-biblioref">29</a>]</span>.
Here we introduce the Clustermatch Correlation Coefficient (CCC), an efficient not-only-linear coefficient that works across quantitative and qualitative variables.
CCC has a single parameter that limits the maximum complexity of relationships found (from linear to more general patterns) and computation time.
CCC provides a high level of flexibility to detect specific types of patterns that are more important for the user, while providing safe defaults to capture general relationships.
We also provide an efficient CCC implementation that is highly parallelizable, allowing to speed up computation across variable pairs with millions of objects or conditions.
To assess its performance, we applied our method to gene expression data from the Genotype-Tissue Expression v8 (GTEx) project across different tissues <span class="citation" data-cites="9Pr9idng">[<a href="#ref-9Pr9idng" role="doc-biblioref">30</a>]</span>.
CCC captured both strong linear relationships and novel nonlinear patterns, which were entirely missed by standard coefficients.
For example, some of these nonlinear patterns were associated with sex differences in gene expression, suggesting that CCC can capture strong relationships present only in a subset of samples.
We also found that the CCC behaves similarly to MIC in several cases, although it is much faster to compute.
Gene pairs detected in expression data by CCC had higher interaction probabilities in tissue-specific gene networks from the Genome-wide Analysis of gene Networks in Tissues (GIANT) <span class="citation" data-cites="CVF61Un5">[<a href="#ref-CVF61Un5" role="doc-biblioref">31</a>]</span>.
Furthermore, its ability to efficiently handle diverse data types (including numerical and categorical features) reduces preprocessing steps and makes it appealing to analyze large and heterogeneous repositories.</p>
<h2 id="results">Results</h2>
<h3 id="a-robust-and-efficient-not-only-linear-dependence-coefficient">A robust and efficient not-only-linear dependence coefficient</h3>
<div id="fig:datasets_rel" class="fignos">
<figure>
<img src="images/intro/relationships.svg" style="width:100.0%" alt="Figure 1: Different types of relationships in data. Each panel contains a set of simulated data points described by two generic variables: x and y. The first row shows Anscombe’s quartet with four different datasets (from Anscombe I to IV) and 11 data points each. The second row contains a set of general patterns with 100 data points each. Each panel shows the correlation value using Pearson (p), Spearman (s) and CCC (c). Vertical and horizontal red lines show how CCC clustered data points using x and y." />
<figcaption aria-hidden="true"><span>Figure 1:</span> <strong>Different types of relationships in data.</strong>
Each panel contains a set of simulated data points described by two generic variables: <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.
The first row shows Anscombe’s quartet with four different datasets (from Anscombe I to IV) and 11 data points each.
The second row contains a set of general patterns with 100 data points each.
Each panel shows the correlation value using Pearson (<span class="math inline">\(p\)</span>), Spearman (<span class="math inline">\(s\)</span>) and CCC (<span class="math inline">\(c\)</span>).
Vertical and horizontal red lines show how CCC clustered data points using <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</figcaption>
</figure>
</div>
<p>The CCC provides a similarity measure between any pair of variables, either with numerical or categorical values.
The method assumes that if there is a relationship between two variables/features describing <span class="math inline">\(n\)</span> data points/objects, then the <strong>cluster</strong>ings of those objects using each variable should <strong>match</strong>.
In the case of numerical values, CCC uses quantiles to efficiently separate data points into different clusters (e.g., the median separates numerical data into two clusters).
Once all clusterings are generated according to each variable, we define the CCC as the maximum adjusted Rand index (ARI) <span class="citation" data-cites="e4AuoW8N">[<a href="#ref-e4AuoW8N" role="doc-biblioref">32</a>]</span> between them, ranging between 0 and 1.
Details of the CCC algorithm can be found in <a href="#sec:ccc_algo">Methods</a>.</p>
<p>We examined how the Pearson (<span class="math inline">\(p\)</span>), Spearman (<span class="math inline">\(s\)</span>) and CCC (<span class="math inline">\(c\)</span>) correlation coefficients behaved on different simulated data patterns.
In the first row of Figure <a href="#fig:datasets_rel">1</a>, we examine the classic Anscombe’s quartet <span class="citation" data-cites="WP7yhZGS">[<a href="#ref-WP7yhZGS" role="doc-biblioref">33</a>]</span>, which comprises four synthetic datasets with different patterns but the same data statistics (mean, standard deviation and Pearson’s correlation).
This kind of simulated data, recently revisited with the “Datasaurus” <span class="citation" data-cites="LW7cVCGa dvyMwrz9 FhufXP6P">[<a href="#ref-LW7cVCGa" role="doc-biblioref">34</a>,<a href="#ref-dvyMwrz9" role="doc-biblioref">35</a>,<a href="#ref-FhufXP6P" role="doc-biblioref">36</a>]</span>, is used as a reminder of the importance of going beyond simple statistics, where either undesirable patterns (such as outliers) or desirable ones (such as biologically meaningful nonlinear relationships) can be masked by summary statistics alone.</p>
<p>Anscombe I contains a noisy but clear linear pattern, similar to Anscombe III where the linearity is perfect besides one outlier.
In these two examples, CCC separates data points using two clusters (one red line for each variable <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>), yielding 1.0 and thus indicating a strong relationship.
Anscombe II seems to follow a partially quadratic relationship interpreted as linear by Pearson and Spearman.
In contrast, for this potentially undersampled quadratic pattern, CCC yields a lower yet non-zero value of 0.34, reflecting a more complex relationship than a linear pattern.
Anscombe IV shows a vertical line of data points where <span class="math inline">\(x\)</span> values are almost constant except for one outlier.
This outlier does not influence CCC as it does for Pearson or Spearman.
Thus <span class="math inline">\(c=0.00\)</span> (the minimum value) correctly indicates no association for this variable pair because, besides the outlier, for a single value of <span class="math inline">\(x\)</span> there are ten different values for <span class="math inline">\(y\)</span>.
This pair of variables does not fit the CCC assumption: the two clusters formed with <span class="math inline">\(x\)</span> (approximately separated by <span class="math inline">\(x=13\)</span>) do not match the three clusters formed with <span class="math inline">\(y\)</span>.
The Pearson’s correlation coefficient is the same across all these Anscombe’s examples (<span class="math inline">\(p=0.82\)</span>), whereas Spearman is 0.50 or greater.
These simulated datasets show that both Pearson and Spearman are powerful in detecting linear patterns.
However, any deviation in this assumption (like nonlinear relationships or outliers) affects their robustness.</p>
<p>We simulated additional types of relationships (Figure <a href="#fig:datasets_rel">1</a>, second row), including some previously described from gene expression data <span class="citation" data-cites="yCHLC0oS 1AMcxTw9R 16ddFzCqe">[<a href="#ref-yCHLC0oS" role="doc-biblioref">37</a>,<a href="#ref-1AMcxTw9R" role="doc-biblioref">38</a>,<a href="#ref-16ddFzCqe" role="doc-biblioref">39</a>]</span>.
For the random/independent pair of variables, all coefficients correctly agree with a value close to zero.
The non-coexistence pattern, captured by all coefficients, represents a case where one gene (<span class="math inline">\(x\)</span>) might be expressed while the other one (<span class="math inline">\(y\)</span>) is inhibited, highlighting a potentially strong biological relationship (such as a microRNA negatively regulating another gene).
For the other two examples (quadratic and two-lines), Pearson and Spearman do not capture the nonlinear pattern between variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.
These patterns also show how CCC uses different degrees of complexity to capture the relationships.
For the quadratic pattern, for example, CCC separates <span class="math inline">\(x\)</span> into more clusters (four in this case) to reach the maximum ARI.
The two-lines example shows two embedded linear relationships with different slopes, which neither Pearson nor Spearman detect (<span class="math inline">\(p=-0.12\)</span> and <span class="math inline">\(s=0.05\)</span>, respectively).
Here, CCC increases the complexity of the model by using eight clusters for <span class="math inline">\(x\)</span> and six for <span class="math inline">\(y\)</span>, resulting in <span class="math inline">\(c=0.31\)</span>.</p>
<h3 id="the-ccc-reveals-linear-and-nonlinear-patterns-in-human-transcriptomic-data">The CCC reveals linear and nonlinear patterns in human transcriptomic data</h3>
<p>We next examined the characteristics of these correlation coefficients in gene expression data from GTEx v8 across different tissues.
We selected the top 5,000 genes with the largest variance for our initial analyses on whole blood and then computed the correlation matrix between genes using Pearson, Spearman and CCC (see <a href="#sec:data_gtex">Methods</a>).</p>
<p>We examined the distribution of each coefficient’s absolute values in GTEx (Figure <a href="#fig:dist_coefs">2</a>).
CCC (mean=0.14, median=0.08, sd=0.15) has a much more skewed distribution than Pearson (mean=0.31, median=0.24, sd=0.24) and Spearman (mean=0.39, median=0.37, sd=0.26).
The coefficients reach a cumulative set containing 70% of gene pairs at different values (Figure <a href="#fig:dist_coefs">2</a> b), <span class="math inline">\(c=0.18\)</span>, <span class="math inline">\(p=0.44\)</span> and <span class="math inline">\(s=0.56\)</span>, suggesting that for this type of data, the coefficients are not directly comparable by magnitude, so we used ranks for further comparisons.
In GTEx v8, CCC values were closer to Spearman and vice versa than either was to Pearson (Figure <a href="#fig:dist_coefs">2</a> c).
We also compared the Maximal Information Coefficient (MIC) in this data (see <a href="#sec:mic">Supplementary Note 1</a>).
We found that CCC behaved very similarly to MIC, although CCC was up to two orders of magnitude faster to run (see <a href="#sec:time_test">Supplementary Note 2</a>).
MIC, an advanced correlation coefficient able to capture general patterns beyond linear relationships, represented a significant step forward in correlation analysis research and has been successfully used in various application domains <span class="citation" data-cites="NnsqWXcp g8HrFUfP iZjSr8s2">[<a href="#ref-iZjSr8s2" role="doc-biblioref">4</a>,<a href="#ref-NnsqWXcp" role="doc-biblioref">26</a>,<a href="#ref-g8HrFUfP" role="doc-biblioref">27</a>]</span>.
These results suggest that our findings for CCC generalize to MIC, therefore, in the subsequent analyses we focus on CCC and linear-only coefficients.</p>
<div id="fig:dist_coefs" class="fignos">
<figure>
<img src="images/coefs_comp/gtex_whole_blood/dist-main.svg" style="width:100.0%" alt="Figure 2: Distribution of coefficient values on gene expression (GTEx v8, whole blood). a) Histogram of coefficient values. b) Corresponding cumulative histogram. The dotted line maps the coefficient value that accumulates 70% of gene pairs. c) 2D histogram plot with hexagonal bins between all coefficients, where a logarithmic scale was used to color each hexagon." />
<figcaption aria-hidden="true"><span>Figure 2:</span> <strong>Distribution of coefficient values on gene expression (GTEx v8, whole blood).</strong>
<strong>a)</strong> Histogram of coefficient values.
<strong>b)</strong> Corresponding cumulative histogram. The dotted line maps the coefficient value that accumulates 70% of gene pairs.
<strong>c)</strong> 2D histogram plot with hexagonal bins between all coefficients, where a logarithmic scale was used to color each hexagon.</figcaption>
</figure>
</div>
<p>A closer inspection of gene pairs that were either prioritized or disregarded by these coefficients revealed that they captured different patterns.
We analyzed the agreements and disagreements by obtaining, for each coefficient, the top 30% of gene pairs with the largest correlation values (“high” set) and the bottom 30% (“low” set), resulting in six potentially overlapping categories.
For most cases (76.4%), an UpSet analysis <span class="citation" data-cites="ZhJ7VK5R">[<a href="#ref-ZhJ7VK5R" role="doc-biblioref">40</a>]</span> (Figure <a href="#fig:upsetplot_coefs">3</a> a) showed that the three coefficients agreed on whether there is a strong correlation (42.1%) or there is no relationship (34.3%).
Since Pearson and Spearman are linear-only, and CCC can also capture these patterns, we expect that these concordant gene pairs represent clear linear patterns.
CCC and Spearman agree more on either highly or poorly correlated pairs (4.0% in “high”, and 7.0% in “low”) than any of these with Pearson (all between 0.3%-3.5% for “high”, and 2.8%-5.5% for “low”).
In summary, CCC agrees with either Pearson or Spearman in 90.5% of gene pairs by assigning a high or a low correlation value.</p>
<div id="fig:upsetplot_coefs" class="fignos">
<figure>
<img src="images/coefs_comp/gtex_whole_blood/upsetplot-main.svg" style="width:100.0%" alt="Figure 3: Intersection of gene pairs with high and low correlation coefficient values (GTEx v8, whole blood). a) UpSet plot with six categories (rows) grouping the 30% of the highest (green triangle) and lowest (red triangle) values for each coefficient. Columns show different intersections of categories grouped by agreements and disagreements. b) Hexagonal binning plots with examples of gene pairs where CCC (c) disagrees with Pearson (p) and Spearman (s). For each method, colors in the triangles indicate if the gene pair is among the top (green) or bottom (red) 30% of coefficient values. No triangle means that the correlation value for the gene pair is between the 30th and 70th percentiles (neither low nor high). A logarithmic scale was used to color each hexagon." />
<figcaption aria-hidden="true"><span>Figure 3:</span> <strong>Intersection of gene pairs with high and low correlation coefficient values (GTEx v8, whole blood).</strong>
<strong>a)</strong> UpSet plot with six categories (rows) grouping the 30% of the highest (green triangle) and lowest (red triangle) values for each coefficient.
Columns show different intersections of categories grouped by agreements and disagreements.
<strong>b)</strong> Hexagonal binning plots with examples of gene pairs where CCC (<span class="math inline">\(c\)</span>) disagrees with Pearson (<span class="math inline">\(p\)</span>) and Spearman (<span class="math inline">\(s\)</span>).
For each method, colors in the triangles indicate if the gene pair is among the top (green) or bottom (red) 30% of coefficient values.
No triangle means that the correlation value for the gene pair is between the 30th and 70th percentiles (neither low nor high).
A logarithmic scale was used to color each hexagon.</figcaption>
</figure>
</div>
<p>While there was broad agreement, more than 20,000 gene pairs with a high CCC value were not highly ranked by the other coefficients (right part of Figure <a href="#fig:upsetplot_coefs">3</a> a).
There were also gene pairs with a high Pearson value and either low CCC (1,075), low Spearman (87) or both low CCC and low Spearman values (531).
However, our examination suggests that many of these cases appear to be driven by potential outliers (Figure <a href="#fig:upsetplot_coefs">3</a> b, and analyzed later).
We analyzed gene pairs among the top five of each intersection in the “Disagreements” group (Figure <a href="#fig:upsetplot_coefs">3</a> a, right) where CCC disagrees with Pearson, Spearman or both.</p>
<div id="fig:gtex_tissues:kdm6a_uty" class="fignos">
<figure>
<img src="images/coefs_comp/kdm6a_vs_uty/gtex-KDM6A_vs_UTY-main.svg" style="width:95.0%" alt="Figure 4: The expression levels of KDM6A and UTY display sex-specific associations across GTEx tissues. CCC captures this nonlinear relationship in all GTEx tissues (nine examples are shown in the first three rows), except in female-specific organs (last row)." />
<figcaption aria-hidden="true"><span>Figure 4:</span> <strong>The expression levels of <em>KDM6A</em> and <em>UTY</em> display sex-specific associations across GTEx tissues.</strong>
CCC captures this nonlinear relationship in all GTEx tissues (nine examples are shown in the first three rows), except in female-specific organs (last row).</figcaption>
</figure>
</div>
<p>The first three gene pairs at the top (<em>IFNG</em> - <em>SDS</em>, <em>JUN</em> - <em>APOC1</em>, and <em>ZDHHC12</em> - <em>CCL18</em>), with high CCC and low Pearson values, appear to follow a non-coexistence relationship: in samples where one of the genes is highly (slightly) expressed, the other is slightly (highly) activated, suggesting a potentially inhibiting effect.
The following three gene pairs (<em>UTY</em> - <em>KDM6A</em>, <em>RASSF2</em> - <em>CYTIP</em>, and <em>AC068580.6</em> - <em>KLHL21</em>) follow patterns combining either two linear or one linear and one independent relationships.
In particular, genes <em>UTY</em> and <em>KDM6A</em> (paralogs) show a nonlinear relationship where a subset of samples follows a robust linear pattern and another subset has a constant (independent) expression of one gene.
This relationship is explained by the fact that <em>UTY</em> is in chromosome Y (Yq11) whereas <em>KDM6A</em> is in chromosome X (Xp11), and samples with a linear pattern are males, whereas those with no expression for <em>UTY</em> are females.
This combination of linear and independent patterns is captured by CCC (<span class="math inline">\(c=0.29\)</span>, above the 80th percentile) but not by Pearson (<span class="math inline">\(p=0.24\)</span>, below the 55th percentile) or Spearman (<span class="math inline">\(s=0.10\)</span>, below the 15th percentile).
Furthermore, the same gene pair pattern is highly ranked by CCC in all other tissues in GTEx, except for female-specific organs (Figure <a href="#fig:gtex_tissues:kdm6a_uty">4</a>).</p>
<h3 id="replication-of-gene-associations-using-tissue-specific-gene-networks-from-giant">Replication of gene associations using tissue-specific gene networks from GIANT</h3>
<p>We sought to systematically analyze discrepant scores to assess whether associations were replicated in other datasets besides GTEx.
This is challenging and prone to bias because linear-only correlation coefficients are usually used in gene co-expression analyses.
We used 144 tissue-specific gene networks from the Genome-wide Analysis of gene Networks in Tissues (GIANT) <span class="citation" data-cites="9ZXy7Ut2 ZSXf7Pdq">[<a href="#ref-9ZXy7Ut2" role="doc-biblioref">41</a>,<a href="#ref-ZSXf7Pdq" role="doc-biblioref">42</a>]</span>, where nodes represent genes and each edge a functional relationship weighted with a probability of interaction between two genes (see <a href="#sec:giant">Methods</a>).
Importantly, the version of GIANT used in this study did not include GTEx samples <span class="citation" data-cites="BgCQnLU6">[<a href="#ref-BgCQnLU6" role="doc-biblioref">43</a>]</span>, making it an ideal case for replication.
These networks were built from expression and different interaction measurements, including protein-interaction, transcription factor regulation, chemical/genetic perturbations and microRNA target profiles from the Molecular Signatures Database (MSigDB <span class="citation" data-cites="tt0Vdf4C">[<a href="#ref-tt0Vdf4C" role="doc-biblioref">44</a>]</span>).
We reasoned that highly-ranked gene pairs using three different coefficients in a single tissue (whole blood in GTEx, Figure <a href="#fig:upsetplot_coefs">3</a>) that represented real patterns should often replicate in a corresponding tissue or related cell lineage using the multi-cell type functional interaction networks in GIANT.
In addition to predicting a network with interactions for a pair of genes, the GIANT web application can also automatically detect a relevant tissue or cell type where genes are predicted to be specifically expressed (the approach uses a machine learning method introduced in <span class="citation" data-cites="mk4SLpDo">[<a href="#ref-mk4SLpDo" role="doc-biblioref">45</a>]</span> and described in <a href="#sec:giant">Methods</a>).
For example, we obtained the networks in blood and the automatically-predicted cell type for gene pairs <em>RASSF2</em> - <em>CYTIP</em> (CCC high, Figure <a href="#fig:giant_gene_pairs">5</a> a) and <em>MYOZ1</em> - <em>TNNI2</em> (Pearson high, Figure <a href="#fig:giant_gene_pairs">5</a> b).
In addition to the gene pair, the networks include other genes connected according to their probability of interaction (up to 15 additional genes are shown), which allows estimating whether genes are part of the same tissue-specific biological process.
Two large black nodes in each network’s top-left and bottom-right corners represent our gene pairs.
A green edge means a close-to-zero probability of interaction, whereas a red edge represents a strong predicted relationship between the two genes.
In this example, genes <em>RASSF2</em> and <em>CYTIP</em> (Figure <a href="#fig:giant_gene_pairs">5</a> a), with a high CCC value (<span class="math inline">\(c=0.20\)</span>, above the 73th percentile) and low Pearson and Spearman (<span class="math inline">\(p=0.16\)</span> and <span class="math inline">\(s=0.11\)</span>, below the 38th and 17th percentiles, respectively), were both strongly connected to the blood network, with interaction scores of at least 0.63 and an average of 0.75 and 0.84, respectively (Supplementary Table <a href="#tbl:giant:weights">1</a>).
The autodetected cell type for this pair was leukocytes, and interaction scores were similar to the blood network (Supplementary Table <a href="#tbl:giant:weights">1</a>).
However, genes <em>MYOZ1</em> and <em>TNNI2</em>, with a very high Pearson value (<span class="math inline">\(p=0.97\)</span>), moderate Spearman (<span class="math inline">\(s=0.28\)</span>) and very low CCC (<span class="math inline">\(c=0.03\)</span>), were predicted to belong to much less cohesive networks (Figure <a href="#fig:giant_gene_pairs">5</a> b), with average interaction scores of 0.17 and 0.22 with the rest of the genes, respectively.
Additionally, the autodetected cell type (skeletal muscle) is not related to blood or one of its cell lineages.
These preliminary results suggested that CCC might be capturing blood-specific patterns missed by the other coefficients.</p>
<div id="fig:giant_gene_pairs" class="fignos">
<figure>
<img src="images/coefs_comp/giant_networks/top_gene_pairs-main.svg" style="width:100.0%" alt="Figure 5: Analysis of GIANT tissue-specific predicted networks for gene pairs prioritized by correlation coefficients. a-b) Two gene pairs prioritized by correlation coefficients (from Figure 3 b) with their predicted networks in blood (left) and an automatically selected tissue/cell type (right) using the method described in [45]. A node represents a gene and an edge the probability that two genes are part of the same biological process in a specific cell type. A maximum of 15 genes are shown for each network. The GIANT web application automatically determined a minimum interaction confidence (edges’ weights) to be shown. These networks can be analyzed online using the following links: RASSF2 - CYTIP [46], MYOZ1 - TNNI2 [47]. c) Summary of predicted tissue/cell type networks for gene pairs exclusively prioritized by CCC and Pearson. The first row combines all gene pairs where CCC is high and Pearson or Spearman are low. The second row combines all gene pairs where Pearson is high and CCC or Spearman are low. Bar plots (left) show the number of gene pairs for each predicted tissue/cell type. Box plots (right) show the average probability of interaction between genes in these predicted tissue-specific networks. Red indicates CCC-only tissues/cell types, blue are Pearson-only, and purple are shared." />
<figcaption aria-hidden="true"><span>Figure 5:</span> <strong>Analysis of GIANT tissue-specific predicted networks for gene pairs prioritized by correlation coefficients.</strong>
<strong>a-b)</strong> Two gene pairs prioritized by correlation coefficients (from Figure <a href="#fig:upsetplot_coefs">3</a> b) with their predicted networks in blood (left) and an automatically selected tissue/cell type (right) using the method described in <span class="citation" data-cites="mk4SLpDo">[<a href="#ref-mk4SLpDo" role="doc-biblioref">45</a>]</span>.
A node represents a gene and an edge the probability that two genes are part of the same biological process in a specific cell type.
A maximum of 15 genes are shown for each network.
The GIANT web application automatically determined a minimum interaction confidence (edges’ weights) to be shown.
These networks can be analyzed online using the following links:
<em>RASSF2</em> - <em>CYTIP</em> <span class="citation" data-cites="FKQEHB1F">[<a href="#ref-FKQEHB1F" role="doc-biblioref">46</a>]</span>,
<em>MYOZ1</em> - <em>TNNI2</em> <span class="citation" data-cites="JpfbR0un">[<a href="#ref-JpfbR0un" role="doc-biblioref">47</a>]</span>.
<strong>c)</strong> Summary of predicted tissue/cell type networks for gene pairs exclusively prioritized by CCC and Pearson.
The first row combines all gene pairs where CCC is high and Pearson or Spearman are low.
The second row combines all gene pairs where Pearson is high and CCC or Spearman are low.
Bar plots (left) show the number of gene pairs for each predicted tissue/cell type.
Box plots (right) show the average probability of interaction between genes in these predicted tissue-specific networks.
Red indicates CCC-only tissues/cell types, blue are Pearson-only, and purple are shared.</figcaption>
</figure>
</div>
<p>We next performed a systematic evaluation using the top 100 discrepant gene pairs between CCC and the other two coefficients.
For each gene pair prioritized in GTEx (whole blood), we autodetected a relevant cell type using GIANT to assess whether genes were predicted to be specifically expressed in a blood-relevant cell lineage.
For this, we used the top five most commonly autodetected cell types for each coefficient and assessed connectivity in the resulting networks (see <a href="#sec:giant">Methods</a>).
The top 5 predicted cell types for gene pairs highly ranked by CCC and not by the rest were all blood-specific (Figure <a href="#fig:giant_gene_pairs">5</a> c, top left), including macrophage, leukocyte, natural killer cell, blood and mononuclear phagocyte.
The average probability of interaction between genes in these CCC-ranked networks was significantly higher than the other coefficients (Figure <a href="#fig:giant_gene_pairs">5</a> c, top right), with all medians larger than 67% and first quartiles above 41% across predicted cell types.
In contrast, most Pearson’s gene pairs were predicted to be specific to tissues unrelated to blood (Figure <a href="#fig:giant_gene_pairs">5</a> c, bottom left), with skeletal muscle being the most commonly predicted tissue.
The interaction probabilities in these Pearson-ranked networks were also generally lower than in CCC, except for blood-specific gene pairs (Figure <a href="#fig:giant_gene_pairs">5</a> c, bottom right).
The associations exclusively detected by CCC in whole blood from GTEx were more strongly replicated in these independent networks that incorporated multiple data modalities.
CCC-ranked gene pairs not only had high probabilities of belonging to the same biological process but were also predicted to be specifically expressed in blood cell lineages.
Conversely, most Pearson-ranked gene pairs were not predicted to be blood-specific, and their interaction probabilities were relatively low.
This lack of replication in GIANT suggests that top Pearson-ranked gene pairs in GTEx might be driven mainly by outliers, which is consistent with our earlier observations of outlier-driven associations (Figure <a href="#fig:upsetplot_coefs">3</a> b).</p>
<h2 id="discussion">Discussion</h2>
<p>We introduce the Clustermatch Correlation Coefficient (CCC), an efficient not-only-linear machine learning-based statistic.
Applying CCC to GTEx v8 revealed that it was robust to outliers and detected linear relationships as well as complex and biologically meaningful patterns that standard coefficients missed.
In particular, CCC alone detected gene pairs with complex nonlinear patterns from the sex chromosomes, highlighting the way that not-only-linear coefficients can play in capturing sex-specific differences.
The ability to capture these nonlinear patterns, however, extends beyond sex differences: it provides a powerful approach to detect complex relationships where a subset of samples or conditions are explained by other factors (such as differences between health and disease).
We found that top CCC-ranked gene pairs in whole blood from GTEx were replicated in independent tissue-specific networks trained from multiple data types and attributed to cell lineages from blood, even though CCC did not have access to any cell lineage-specific information.
This suggests that CCC can disentangle intricate cell lineage-specific transcriptional patterns missed by linear-only coefficients.
In addition to capturing nonlinear patterns, the CCC was more similar to Spearman than Pearson, highlighting their shared robustness to outliers.
The CCC results were concordant with MIC, but much faster to compute and thus practical for large datasets.
Another advantage over MIC is that CCC can also process categorical variables together with numerical values.
CCC is conceptually easy to interpret and has a single parameter that controls the maximum complexity of the detected relationships while also balancing compute time.</p>
<p>Datasets such as Anscombe or “Datasaurus” highlight the value of visualization instead of relying on simple data summaries.
While visual analysis is helpful, for many datasets examining each possible relationship is infeasible, and this is where more sophisticated and robust correlation coefficients are necessary.
Advanced yet interpretable coefficients like CCC can focus human interpretation on patterns that are more likely to reflect real biology.
The complexity of these patterns might reflect heterogeneity in samples that mask clear relationships between variables.
For example, genes <em>UTY</em> - <em>KDM6A</em> (from sex chromosomes), detected by CCC, have a strong linear relationship but only in a subset of samples (males), which was not captured by linear-only coefficients.
This example, in particular, highlights the importance of considering sex as a biological variable (SABV) <span class="citation" data-cites="4QgDZ8bF">[<a href="#ref-4QgDZ8bF" role="doc-biblioref">48</a>]</span> to avoid overlooking important differences between men and women, for instance, in disease manifestations <span class="citation" data-cites="iox25BGw 1GpiBQk8d">[<a href="#ref-iox25BGw" role="doc-biblioref">49</a>,<a href="#ref-1GpiBQk8d" role="doc-biblioref">50</a>]</span>.
More generally, a not-only-linear correlation coefficient like CCC could identify significant differences between variables (such as genes) that are explained by a third factor (beyond sex differences), that would be entirely missed by linear-only coefficients.</p>
<p>It is well-known that biomedical research is biased towards a small fraction of human genes <span class="citation" data-cites="1CZbj0k1F 104MiBf8H">[<a href="#ref-1CZbj0k1F" role="doc-biblioref">51</a>,<a href="#ref-104MiBf8H" role="doc-biblioref">52</a>]</span>.
Some genes highlighted in CCC-ranked pairs (Figure <a href="#fig:upsetplot_coefs">3</a> b), such as <em>SDS</em> (12q24) and <em>ZDHHC12</em> (9q34), were previously found to be the focus of fewer than expected publications <span class="citation" data-cites="IlPwHaTE">[<a href="#ref-IlPwHaTE" role="doc-biblioref">53</a>]</span>.
It is possible that the widespread use of linear coefficients may bias researchers away from genes with complex coexpression patterns.
A beyond-linear gene co-expression analysis on large compendia might shed light on the function of understudied genes.
For example, gene <em>KLHL21</em> (1p36) and <em>AC068580.6</em> (<em>ENSG00000235027</em>, in 11p15) have a high CCC value and are missed by the other coefficients.
<em>KLHL21</em> was suggested as a potential therapeutic target for hepatocellular carcinoma <span class="citation" data-cites="9i58Tfs4">[<a href="#ref-9i58Tfs4" role="doc-biblioref">54</a>]</span> and other cancers <span class="citation" data-cites="efGVmXWt 1FQgFkJoJ">[<a href="#ref-efGVmXWt" role="doc-biblioref">55</a>,<a href="#ref-1FQgFkJoJ" role="doc-biblioref">56</a>]</span>.
Its nonlinear correlation with <em>AC068580.6</em> might unveil other important players in cancer initiation or progression, potentially in subsets of samples with specific characteristics (as suggested in Figure <a href="#fig:upsetplot_coefs">3</a> b).</p>
<p>Not-only-linear correlation coefficients might also be helpful in the field of genetic studies.
In this context, genome-wide association studies (GWAS) have been successful in understanding the molecular basis of common diseases by estimating the association between genotype and phenotype <span class="citation" data-cites="yqBcaXHD">[<a href="#ref-yqBcaXHD" role="doc-biblioref">57</a>]</span>.
However, the estimated effect sizes of genes identified with GWAS are generally modest, and they explain only a fraction of the phenotype variance, hampering the clinical translation of these findings <span class="citation" data-cites="17B4AigZT">[<a href="#ref-17B4AigZT" role="doc-biblioref">58</a>]</span>.
Recent theories, like the omnigenic model for complex traits <span class="citation" data-cites="g7Id81Dt sfMulPrl">[<a href="#ref-g7Id81Dt" role="doc-biblioref">16</a>,<a href="#ref-sfMulPrl" role="doc-biblioref">17</a>]</span>, argue that these observations are explained by highly-interconnected gene regulatory networks, with some core genes having a more direct effect on the phenotype than others.
Using this omnigenic perspective, we and others <span class="citation" data-cites="FEh1bD0A 57TjOMEA 17f9RJ1ul">[<a href="#ref-FEh1bD0A" role="doc-biblioref">19</a>,<a href="#ref-17f9RJ1ul" role="doc-biblioref">20</a>,<a href="#ref-57TjOMEA" role="doc-biblioref">23</a>]</span> have shown that integrating gene co-expression networks in genetic studies could potentially identify core genes that are missed by linear-only models alone like GWAS.
Our results suggest that building these networks with more advanced and efficient correlation coefficients could better estimate gene co-expression profiles and thus more accurately identify these core genes.
Approaches like CCC could play a significant role in the precision medicine field by providing the computational tools to focus on more promising genes representing potentially better candidate drug targets.</p>
<p>Our analyses have some limitations.
We worked on a sample with the top variable genes to keep computation time feasible.
Although CCC is much faster than MIC, Pearson and Spearman are still the most computationally efficient since they only rely on simple data statistics.
Our results, however, reveal the advantages of using more advanced coefficients like CCC for detecting and studying more intricate molecular mechanisms that replicated in independent datasets.
The application of CCC on larger compendia, such as recount3 <span class="citation" data-cites="TryC3OjB">[<a href="#ref-TryC3OjB" role="doc-biblioref">11</a>]</span> with thousands of heterogeneous samples across different conditions, can reveal other potentially meaningful gene interactions.
The single parameter of CCC, <span class="math inline">\(k_{\mathrm{max}}\)</span>, controls the maximum complexity of patterns found and also impacts the compute time.
Our analysis suggested that <span class="math inline">\(k_{\mathrm{max}}=10\)</span> was sufficient to identify both linear and more complex patterns in gene expression.
A more comprehensive analysis of optimal values for this parameter could provide insights to adjust it for different applications or data types.</p>
<p>While linear and rank-based correlation coefficients are exceptionally fast to calculate, not all relevant patterns in biological datasets are linear.
For example, patterns associated with sex as a biological variable are not apparent to the linear-only coefficients that we evaluated but are revealed by not-only-linear methods.
Beyond sex differences, being able to use a method that inherently identifies patterns driven by other factors is likely to be desirable.
Not-only-linear coefficients can also disentangle intricate yet relevant patterns from expression data alone that were replicated in models integrating different data modalities.
CCC, in particular, is highly parallelizable, and we anticipate efficient GPU-based implementations that could make it even faster.
The CCC is an efficient, next-generation correlation coefficient that is highly effective in transcriptome analyses and potentially useful in a broad range of other domains.</p>
<h2 id="methods">Methods</h2>
<p>The code needed to reproduce all of our analyses and generate the figures is available in <a href="https://github.com/greenelab/ccc">https://github.com/greenelab/ccc</a>.
We provide scripts to download the required data and run all the steps.
A Docker image is provided to use the same runtime environment.</p>
<h3 class="page_break_before" id="sec:ccc_algo">The CCC algorithm</h3>
<p>The Clustermatch Correlation Coefficient (CCC) computes a similarity value <span class="math inline">\(c \in \left[0,1\right]\)</span> between any pair of numerical or categorical features/variables <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> measured on <span class="math inline">\(n\)</span> objects.
CCC assumes that if two features <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are similar, then the partitioning by clustering of the <span class="math inline">\(n\)</span> objects using each feature separately should match.
For example, given <span class="math inline">\(\mathbf{x}=(11, 27, 32, 40)\)</span> and <span class="math inline">\(\mathbf{y}=10x=(110, 270, 320, 400)\)</span>, where <span class="math inline">\(n=4\)</span>, partitioning each variable into two clusters (<span class="math inline">\(k=2\)</span>) using their medians (29.5 for <span class="math inline">\(\mathbf{x}\)</span> and 295 for <span class="math inline">\(\mathbf{y}\)</span>) would result in partition <span class="math inline">\(\Omega^{\mathbf{x}}_{k=2}=(1, 1, 2, 2)\)</span> for <span class="math inline">\(\mathbf{x}\)</span>, and partition <span class="math inline">\(\Omega^{\mathbf{y}}_{k=2}=(1, 1, 2, 2)\)</span> for <span class="math inline">\(\mathbf{y}\)</span>.
Then, the agreement between <span class="math inline">\(\Omega^{\mathbf{x}}_{k=2}\)</span> and <span class="math inline">\(\Omega^{\mathbf{y}}_{k=2}\)</span> can be computed using any measure of similarity between partitions, like the adjusted Rand index (ARI) <span class="citation" data-cites="e4AuoW8N">[<a href="#ref-e4AuoW8N" role="doc-biblioref">32</a>]</span>.
In that case, it will return the maximum value (1.0 in the case of ARI).
Note that the same value of <span class="math inline">\(k\)</span> might not be the right one to find a relationship between any two features.
For instance, in the quadratic example in Figure <a href="#fig:datasets_rel">1</a>, CCC returns a value of 0.36 (grouping objects in four clusters using one feature and two using the other).
If we used only two clusters instead, CCC would return a similarity value of 0.02.
Therefore, the CCC algorithm (shown below) searches for this optimal number of clusters given a maximum <span class="math inline">\(k\)</span>, which is its single parameter <span class="math inline">\(k_{\mathrm{max}}\)</span>.</p>
<figure>
<img src="images/intro/ccc_algorithm/ccc_algorithm.svg" style="width:75.0%" />
</figure>
<p>The main function of the algorithm, <code>ccc</code>, generates a list of partitionings <span class="math inline">\(\Omega^{\mathbf{x}}\)</span> and <span class="math inline">\(\Omega^{\mathbf{y}}\)</span> (lines 14 and 15), for each feature <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span>.
Then, it computes the ARI between each partition in <span class="math inline">\(\Omega^{\mathbf{x}}\)</span> and <span class="math inline">\(\Omega^{\mathbf{y}}\)</span> (line 16), and then it keeps the pair that generates the maximum ARI.
Finally, since ARI does not have a lower bound (it could return negative values, which in our case are not meaningful), CCC returns only values between 0 and 1 (line 17).</p>
<p>Interestingly, since CCC only needs a pair of partitions to compute a similarity value, any type of feature that can be used to perform clustering/grouping is supported.
If the feature is numerical (lines 2 to 5 in the <code>get_partitions</code> function), then quantiles are used for clustering (for example, the median generates <span class="math inline">\(k=2\)</span> clusters of objects), from <span class="math inline">\(k=2\)</span> to <span class="math inline">\(k=k_{\mathrm{max}}\)</span>.
If the feature is categorical (lines 7 to 9), the categories are used to group objects together.
Consequently, since features are internally categorized into clusters, numerical and categorical variables can be naturally integrated since clusters do not need an order.</p>
<p>For all our analyses we used <span class="math inline">\(k_{\mathrm{max}}=10\)</span>.
This means that for each gene pair, 18 partitions are generated (9 for each gene, from <span class="math inline">\(k=2\)</span> to <span class="math inline">\(k=10\)</span>), and 81 ARI comparisons are performed.
Smaller values of <span class="math inline">\(k_{\mathrm{max}}\)</span> can reduce computation time, although at the expense of missing more complex/general relationships.
Our examples in Figure <a href="#fig:datasets_rel">1</a> suggest that using <span class="math inline">\(k_{\mathrm{max}}=2\)</span> would force CCC to find linear-only patterns, which could be a valid use case scenario where only this kind of relationships are desired.
In addition, <span class="math inline">\(k_{\mathrm{max}}=2\)</span> implies that only two partitions are generated, and only one ARI comparison is performed.
In this regard, our Python implementation of CCC provides flexibility in specifying <span class="math inline">\(k_{\mathrm{max}}\)</span>.
For instance, instead of the maximum <span class="math inline">\(k\)</span> (an integer), the parameter could be a custom list of integers: for example, <code>[2, 5, 10]</code> will partition the data into two, five and ten clusters.</p>
<p>For a single pair of features (genes in our study), generating partitions or computing their similarity can be parallelized.
We used three CPU cores in our analyses to speed up the computation of CCC.
A future improved implementation of CCC could potentially use graphical processing units (GPU) to parallelize its computation further.</p>
<p>A Python implementation of CCC (optimized with <code>numba</code> <span class="citation" data-cites="189xgFrlN">[<a href="#ref-189xgFrlN" role="doc-biblioref">59</a>]</span>) can be found in our Github repository <span class="citation" data-cites="190WLq6rx">[<a href="#ref-190WLq6rx" role="doc-biblioref">60</a>]</span>, as well as a package published in the Python Package Index (PyPI) that can be easily installed.</p>
<h3 id="sec:data_gtex">Gene expression data and preprocessing</h3>
<p>We downloaded GTEx v8 data for all tissues, normalized using TPM (transcripts per million), and focused our primary analysis on whole blood, which has a good sample size (755).
We selected the top 5,000 genes from whole blood with the largest variance after standardizing with <span class="math inline">\(log(x + 1)\)</span> to avoid a bias towards highly-expressed genes.
We then computed Pearson, Spearman, MIC and CCC on these 5,000 genes across all 755 samples on the TPM-normalized data, generating a pairwise similarity matrix of size 5,000 x 5,000.</p>
<h3 id="sec:giant">Tissue-specific network analyses using GIANT</h3>
<p>We accessed tissue-specific gene networks of GIANT using both the web interface and web services provided by HumanBase <span class="citation" data-cites="ZSXf7Pdq">[<a href="#ref-ZSXf7Pdq" role="doc-biblioref">42</a>]</span>.
The GIANT version used in this study included 987 genome-scale datasets with approximately 38,000 conditions from around 14,000 publications.
Details on how these networks were built are described in <span class="citation" data-cites="CVF61Un5">[<a href="#ref-CVF61Un5" role="doc-biblioref">31</a>]</span>.
Briefly, tissue-specific gene networks were built using gene expression data (without GTEx samples <span class="citation" data-cites="BgCQnLU6">[<a href="#ref-BgCQnLU6" role="doc-biblioref">43</a>]</span>) from the NCBI’s Gene Expression Omnibus (GEO) <span class="citation" data-cites="tGvcfcsl">[<a href="#ref-tGvcfcsl" role="doc-biblioref">61</a>]</span>, protein-protein interaction (BioGRID <span class="citation" data-cites="JHRpiznV">[<a href="#ref-JHRpiznV" role="doc-biblioref">62</a>]</span>, IntAct <span class="citation" data-cites="7fExfA0i">[<a href="#ref-7fExfA0i" role="doc-biblioref">63</a>]</span>, MINT <span class="citation" data-cites="ODdRgjHY">[<a href="#ref-ODdRgjHY" role="doc-biblioref">64</a>]</span> and MIPS <span class="citation" data-cites="2AZQGpIZ">[<a href="#ref-2AZQGpIZ" role="doc-biblioref">65</a>]</span>), transcription factor regulation using binding motifs from JASPAR <span class="citation" data-cites="h6BVQcKz">[<a href="#ref-h6BVQcKz" role="doc-biblioref">66</a>]</span>, and chemical and genetic perturbations from MSigDB <span class="citation" data-cites="15p5LWIVP">[<a href="#ref-15p5LWIVP" role="doc-biblioref">67</a>]</span>.
Gene expression data were log-transformed, and the Pearson correlation was computed for each gene pair, normalized using the Fisher’s z transform, and z-scores discretized into different bins.
Gold standards for tissue-specific functional relationships were built using expert curation and experimentally derived gene annotations from the Gene Ontology.
Then, one naive Bayesian classifier (using C++ implementations from the Sleipnir library <span class="citation" data-cites="Diiyst6u">[<a href="#ref-Diiyst6u" role="doc-biblioref">68</a>]</span>) for each of the 144 tissues was trained using these gold standards.
Finally, these classifiers were used to estimate the probability of tissue-specific interactions for each gene pair.</p>
<p>For each pair of genes prioritized in our study using GTEx, we used GIANT through HumanBase to obtain
1) a predicted gene network for blood (manually selected to match whole blood in GTEx) and
2) a gene network with an automatically predicted tissue using the method described in <span class="citation" data-cites="mk4SLpDo">[<a href="#ref-mk4SLpDo" role="doc-biblioref">45</a>]</span> and provided by HumanBase web interfaces/services.
Briefly, the tissue prediction approach trains a machine learning model using comprehensive transcriptional data with human-curated markers of different cell lineages (e.g., macrophages) as gold standards.
Then, these models are used to predict other cell lineage-specific genes.
In addition to reporting this predicted tissue or cell lineage, we computed the average probability of interaction between all genes in the network retrieved from GIANT.
Following the default procedure used in GIANT, we included the top 15 genes with the highest probability of interaction with the queried gene pair for each network.</p>
<h3 id="sec:methods:mic">Maximal Information Coefficient (MIC)</h3>
<p>We used the Python package <code>minepy</code> <span class="citation" data-cites="wY5WU58s ah0tGOQ0">[<a href="#ref-wY5WU58s" role="doc-biblioref">69</a>,<a href="#ref-ah0tGOQ0" role="doc-biblioref">70</a>]</span> (version 1.2.5) to estimate the MIC coefficient.
In GTEx v8 (whole blood), we used MIC<sub>e</sub> (an improved implementation of the original MIC introduced in <span class="citation" data-cites="AcVZZdTz">[<a href="#ref-AcVZZdTz" role="doc-biblioref">71</a>]</span>) with the default parameters <code>alpha=0.6</code>, <code>c=15</code> and <code>estimator='mic_e'</code>.
We used the <code>pairwise_distances</code> function from <code>scikit-learn</code> <span class="citation" data-cites="GZZZRhEY">[<a href="#ref-GZZZRhEY" role="doc-biblioref">72</a>]</span> to parallelize the computation of MIC on GTEx.
For our computational complexity analyses (see <a href="#sec:time_test">Supplementary Material</a>), we ran the original MIC (using parameter <code>estimator='mic_approx'</code>) and MIC<sub>e</sub> (<code>estimator='mic_e'</code>).</p>
<h2 class="page_break_before" id="references">References</h2>
<!-- Explicitly insert bibliography here -->
<div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-DUeOcxpt" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline"><strong>Making data maximally available.</strong> <div class="csl-block">Brooks Hanson, Andrew Sugden, Bruce Alberts</div> <em>Science (New York, N.Y.)</em> (2011-02-11) <a href="https://www.ncbi.nlm.nih.gov/pubmed/21310971">https://www.ncbi.nlm.nih.gov/pubmed/21310971</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1126/science.1203354">10.1126/science.1203354</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/21310971">21310971</a></div></div>
</div>
<div id="ref-yvIastvc" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline"><strong>Genome-wide prediction and functional characterization of the genetic basis of autism spectrum disorder.</strong> <div class="csl-block">Arjun Krishnan, Ran Zhang, Victoria Yao, Chandra L Theesfeld, Aaron K Wong, Alicja Tadych, Natalia Volfovsky, Alan Packer, Alex Lash, Olga G Troyanskaya</div> <em>Nature neuroscience</em> (2016-08-01) <a href="https://www.ncbi.nlm.nih.gov/pubmed/27479844">https://www.ncbi.nlm.nih.gov/pubmed/27479844</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/nn.4353">10.1038/nn.4353</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27479844">27479844</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5803797">PMC5803797</a></div></div>
</div>
<div id="ref-14q47vZTA" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline"><strong>Using distance correlation and SS-ANOVA to assess associations of familial relationships, lifestyle factors, diseases, and mortality</strong> <div class="csl-block">Jing Kong, Barbara EK Klein, Ronald Klein, Kristine E Lee, Grace Wahba</div> <em>Proceedings of the National Academy of Sciences</em> (2012-11-21) <a href="https://doi.org/f4htm9">https://doi.org/f4htm9</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1073/pnas.1217269109">10.1073/pnas.1217269109</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23175793">23175793</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3528609">PMC3528609</a></div></div>
</div>
<div id="ref-iZjSr8s2" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline"><strong>McTwo: a two-step feature selection algorithm based on maximal information coefficient.</strong> <div class="csl-block">Ruiquan Ge, Manli Zhou, Youxi Luo, Qinghan Meng, Guoqin Mai, Dongli Ma, Guoqing Wang, Fengfeng Zhou</div> <em>BMC bioinformatics</em> (2016-03-23) <a href="https://www.ncbi.nlm.nih.gov/pubmed/27006077">https://www.ncbi.nlm.nih.gov/pubmed/27006077</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1186/s12859-016-0990-0">10.1186/s12859-016-0990-0</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27006077">27006077</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4804474">PMC4804474</a></div></div>
</div>
<div id="ref-1FQ1FgsCm" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline"><strong>A Fast Hybrid Feature Selection Based on Correlation-Guided Clustering and Particle Swarm Optimization for High-Dimensional Data.</strong> <div class="csl-block">Xian-Fang Song, Yong Zhang, Dun-Wei Gong, Xiao-Zhi Gao</div> <em>IEEE transactions on cybernetics</em> (2021-03-17) <a href="https://www.ncbi.nlm.nih.gov/pubmed/33729976">https://www.ncbi.nlm.nih.gov/pubmed/33729976</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1109/tcyb.2021.3061152">10.1109/tcyb.2021.3061152</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33729976">33729976</a></div></div>
</div>
<div id="ref-16aFivIcr" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline"><strong>Densely interconnected transcriptional circuits control cell states in human hematopoiesis.</strong> <div class="csl-block">Noa Novershtern, Aravind Subramanian, Lee N Lawton, Raymond H Mak, WNicholas Haining, Marie E McConkey, Naomi Habib, Nir Yosef, Cindy Y Chang, Tal Shay, … Benjamin L Ebert</div> <em>Cell</em> (2011-01-21) <a href="https://www.ncbi.nlm.nih.gov/pubmed/21241896">https://www.ncbi.nlm.nih.gov/pubmed/21241896</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1016/j.cell.2011.01.004">10.1016/j.cell.2011.01.004</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/21241896">21241896</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3049864">PMC3049864</a></div></div>
</div>
<div id="ref-q5QZW3xH" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">7. </div><div class="csl-right-inline"><strong>Understanding multicellular function and disease with human tissue-specific networks.</strong> <div class="csl-block">Casey S Greene, Arjun Krishnan, Aaron K Wong, Emanuela Ricciotti, Rene A Zelaya, Daniel S Himmelstein, Ran Zhang, Boris M Hartmann, Elena Zaslavsky, Stuart C Sealfon, … Olga G Troyanskaya</div> <em>Nature genetics</em> (2015-04-27) <a href="https://www.ncbi.nlm.nih.gov/pubmed/25915600">https://www.ncbi.nlm.nih.gov/pubmed/25915600</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/ng.3259">10.1038/ng.3259</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25915600">25915600</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4828725">PMC4828725</a></div></div>
</div>
<div id="ref-17eqTELga" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">8. </div><div class="csl-right-inline"><strong>Gene coexpression network alignment and conservation of gene modules between two grass species: maize and rice.</strong> <div class="csl-block">Stephen P Ficklin, FAlex Feltus</div> <em>Plant physiology</em> (2011-05-23) <a href="https://www.ncbi.nlm.nih.gov/pubmed/21606319">https://www.ncbi.nlm.nih.gov/pubmed/21606319</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1104/pp.111.173047">10.1104/pp.111.173047</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/21606319">21606319</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3135956">PMC3135956</a></div></div>
</div>
<div id="ref-x9k6ERo9" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">9. </div><div class="csl-right-inline"><strong>Global similarity and local divergence in human and mouse gene co-expression networks.</strong> <div class="csl-block">Panayiotis Tsaparas, Leonardo Mariño-Ramírez, Olivier Bodenreider, Eugene V Koonin, IKing Jordan</div> <em>BMC evolutionary biology</em> (2006-09-12) <a href="https://www.ncbi.nlm.nih.gov/pubmed/16968540">https://www.ncbi.nlm.nih.gov/pubmed/16968540</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1186/1471-2148-6-70">10.1186/1471-2148-6-70</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/16968540">16968540</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1601971">PMC1601971</a></div></div>
</div>
<div id="ref-vsBvj38s" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">10. </div><div class="csl-right-inline"><strong>The GTEx Consortium atlas of genetic regulatory effects across human tissues.</strong> <em>Science (New York, N.Y.)</em> (2020-09-11) <a href="https://www.ncbi.nlm.nih.gov/pubmed/32913098">https://www.ncbi.nlm.nih.gov/pubmed/32913098</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1126/science.aaz1776">10.1126/science.aaz1776</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32913098">32913098</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7737656">PMC7737656</a></div></div>
</div>
<div id="ref-TryC3OjB" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">11. </div><div class="csl-right-inline"><strong>recount3: summaries and queries for large-scale RNA-seq expression and splicing.</strong> <div class="csl-block">Christopher Wilks, Shijie C Zheng, Feng Yong Chen, Rone Charles, Brad Solomon, Jonathan P Ling, Eddie Luidy Imada, David Zhang, Lance Joseph, Jeffrey T Leek, … Ben Langmead</div> <em>Genome biology</em> (2021-11-29) <a href="https://www.ncbi.nlm.nih.gov/pubmed/34844637">https://www.ncbi.nlm.nih.gov/pubmed/34844637</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1186/s13059-021-02533-6">10.1186/s13059-021-02533-6</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/34844637">34844637</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8628444">PMC8628444</a></div></div>
</div>
<div id="ref-zwyRqHIg" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">12. </div><div class="csl-right-inline"><strong>MultiPLIER: A Transfer Learning Framework for Transcriptomics Reveals Systemic Features of Rare Disease.</strong> <div class="csl-block">Jaclyn N Taroni, Peter C Grayson, Qiwen Hu, Sean Eddy, Matthias Kretzler, Peter A Merkel, Casey S Greene</div> <em>Cell systems</em> (2019-05-22) <a href="https://www.ncbi.nlm.nih.gov/pubmed/31121115">https://www.ncbi.nlm.nih.gov/pubmed/31121115</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1016/j.cels.2019.04.003">10.1016/j.cels.2019.04.003</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31121115">31121115</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6538307">PMC6538307</a></div></div>
</div>
<div id="ref-13mfjo6Kw" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">13. </div><div class="csl-right-inline"><strong>Integrating predicted transcriptome from multiple tissues improves association detection.</strong> <div class="csl-block">Alvaro N Barbeira, Milton Pividori, Jiamao Zheng, Heather E Wheeler, Dan L Nicolae, Hae Kyung Im</div> <em>PLoS genetics</em> (2019-01-22) <a href="https://www.ncbi.nlm.nih.gov/pubmed/30668570">https://www.ncbi.nlm.nih.gov/pubmed/30668570</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1371/journal.pgen.1007889">10.1371/journal.pgen.1007889</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30668570">30668570</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6358100">PMC6358100</a></div></div>
</div>
<div id="ref-12H2nr6Rc" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">14. </div><div class="csl-right-inline"><strong>Quantifying genetic effects on disease mediated by assayed gene expression levels.</strong> <div class="csl-block">Douglas W Yao, Luke J O'Connor, Alkes L Price, Alexander Gusev</div> <em>Nature genetics</em> (2020-05-18) <a href="https://www.ncbi.nlm.nih.gov/pubmed/32424349">https://www.ncbi.nlm.nih.gov/pubmed/32424349</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/s41588-020-0625-2">10.1038/s41588-020-0625-2</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32424349">32424349</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7276299">PMC7276299</a></div></div>
</div>
<div id="ref-qAH2cGOH" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">15. </div><div class="csl-right-inline"><strong>Large-scale cis- and trans-eQTL analyses identify thousands of genetic loci and polygenic scores that regulate blood gene expression.</strong> <div class="csl-block">Urmo Võsa, Annique Claringbould, Harm-Jan Westra, Marc Jan Bonder, Patrick Deelen, Biao Zeng, Holger Kirsten, Ashis Saha, Roman Kreuzhuber, Seyhan Yazar, … Lude Franke</div> <em>Nature genetics</em> (2021-09-02) <a href="https://www.ncbi.nlm.nih.gov/pubmed/34475573">https://www.ncbi.nlm.nih.gov/pubmed/34475573</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/s41588-021-00913-z">10.1038/s41588-021-00913-z</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/34475573">34475573</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8432599">PMC8432599</a></div></div>
</div>
<div id="ref-g7Id81Dt" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">16. </div><div class="csl-right-inline"><strong>An Expanded View of Complex Traits: From Polygenic to Omnigenic.</strong> <div class="csl-block">Evan A Boyle, Yang I Li, Jonathan K Pritchard</div> <em>Cell</em> (2017-06-15) <a href="https://www.ncbi.nlm.nih.gov/pubmed/28622505">https://www.ncbi.nlm.nih.gov/pubmed/28622505</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1016/j.cell.2017.05.038">10.1016/j.cell.2017.05.038</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28622505">28622505</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5536862">PMC5536862</a></div></div>
</div>
<div id="ref-sfMulPrl" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">17. </div><div class="csl-right-inline"><strong>Trans Effects on Gene Expression Can Drive Omnigenic Inheritance.</strong> <div class="csl-block">Xuanyao Liu, Yang I Li, Jonathan K Pritchard</div> <em>Cell</em> (2019-05-02) <a href="https://www.ncbi.nlm.nih.gov/pubmed/31051098">https://www.ncbi.nlm.nih.gov/pubmed/31051098</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1016/j.cell.2019.04.014">10.1016/j.cell.2019.04.014</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31051098">31051098</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6553491">PMC6553491</a></div></div>
</div>
<div id="ref-1EN7sv6pQ" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">18. </div><div class="csl-right-inline"><strong>Identifying disease-critical cell types and cellular processes across the human body by integration of single-cell profiles and human genetics.</strong> <div class="csl-block">Karthik A Jagadeesh, Kushal K Dey, Daniel T Montoro, Rahul Mohan, Steven Gazal, Jesse M Engreitz, Ramnik J Xavier, Alkes L Price, Aviv Regev</div> <em>bioRxiv : the preprint server for biology</em> (2021-11-23) <a href="https://www.ncbi.nlm.nih.gov/pubmed/34845454">https://www.ncbi.nlm.nih.gov/pubmed/34845454</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1101/2021.03.19.436212">10.1101/2021.03.19.436212</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/34845454">34845454</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8629197">PMC8629197</a></div></div>
</div>
<div id="ref-FEh1bD0A" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">19. </div><div class="csl-right-inline"><strong>Projecting genetic associations through gene expression patterns highlights disease etiology and drug mechanisms</strong> <div class="csl-block">Milton Pividori, Sumei Lu, Binglan Li, Chun Su, Matthew E Johnson, Wei-Qi Wei, Qiping Feng, Bahram Namjou, Krzysztof Kiryluk, Iftikhar Kullo, … Casey S Greene</div> <em>Cold Spring Harbor Laboratory</em> (2021-07-06) <a href="https://doi.org/gk9g25">https://doi.org/gk9g25</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1101/2021.07.05.450786">10.1101/2021.07.05.450786</a></div></div>
</div>
<div id="ref-17f9RJ1ul" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">20. </div><div class="csl-right-inline"><strong>Linking common and rare disease genetics through gene regulatory networks</strong> <div class="csl-block">Olivier B Bakker, Annique Claringbould, Harm-Jan Westra, Henry Wiersma, Floranne Boulogne, Urmo Võsa, Sophie Mulcahy Symmons, Iris H Jonkers, Lude Franke, Patrick Deelen</div> <em>Cold Spring Harbor Laboratory</em> (2021-10-26) <a href="https://doi.org/gpdftn">https://doi.org/gpdftn</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1101/2021.10.21.21265342">10.1101/2021.10.21.21265342</a></div></div>
</div>
<div id="ref-sGgkLsyy" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">21. </div><div class="csl-right-inline"><strong>Large-scale cis- and trans-eQTL analyses identify thousands of genetic loci and polygenic scores that regulate blood gene expression</strong> <div class="csl-block">Urmo Võsa, Annique Claringbould, Harm-Jan Westra, Marc Jan Bonder, Patrick Deelen, Biao Zeng, Holger Kirsten, Ashis Saha, Roman Kreuzhuber, Seyhan Yazar, … </div> <em>Nature Genetics</em> (2021-09) <a href="https://doi.org/gmpj66">https://doi.org/gmpj66</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/s41588-021-00913-z">10.1038/s41588-021-00913-z</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/34475573">34475573</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8432599">PMC8432599</a></div></div>
</div>
<div id="ref-14ZMJkeR2" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">22. </div><div class="csl-right-inline"><strong>The omnigenic model and polygenic prediction of complex traits</strong> <div class="csl-block">Iain Mathieson</div> <em>The American Journal of Human Genetics</em> (2021-09) <a href="https://doi.org/gmv9s5">https://doi.org/gmv9s5</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1016/j.ajhg.2021.07.003">10.1016/j.ajhg.2021.07.003</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/34331855">34331855</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8456163">PMC8456163</a></div></div>
</div>
<div id="ref-57TjOMEA" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">23. </div><div class="csl-right-inline"><strong>Identification of therapeutic targets from genetic association studies using hierarchical component analysis</strong> <div class="csl-block">Hao-Chih Lee, Osamu Ichikawa, Benjamin S Glicksberg, Aparna A Divaraniya, Christine E Becker, Pankaj Agarwal, Joel T Dudley</div> <em>BioData Mining</em> (2020-06-17) <a href="https://doi.org/gjp5pf">https://doi.org/gjp5pf</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1186/s13040-020-00216-9">10.1186/s13040-020-00216-9</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32565911">32565911</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7301559">PMC7301559</a></div></div>
</div>
<div id="ref-tbcQL0eR" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">24. </div><div class="csl-right-inline"><strong>Detecting novel associations in large data sets.</strong> <div class="csl-block">David N Reshef, Yakir A Reshef, Hilary K Finucane, Sharon R Grossman, Gilean McVean, Peter J Turnbaugh, Eric S Lander, Michael Mitzenmacher, Pardis C Sabeti</div> <em>Science (New York, N.Y.)</em> (2011-12-16) <a href="https://www.ncbi.nlm.nih.gov/pubmed/22174245">https://www.ncbi.nlm.nih.gov/pubmed/22174245</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1126/science.1205438">10.1126/science.1205438</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/22174245">22174245</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3325791">PMC3325791</a></div></div>
</div>
<div id="ref-IvOGGmxI" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">25. </div><div class="csl-right-inline"><strong>Measuring and testing dependence by correlation of distances</strong> <div class="csl-block">Gábor J Székely, Maria L Rizzo, Nail K Bakirov</div> <em>The Annals of Statistics</em> (2007-12-01) <a href="https://doi.org/dkgjb4">https://doi.org/dkgjb4</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1214/009053607000000505">10.1214/009053607000000505</a></div></div>
</div>
<div id="ref-NnsqWXcp" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">26. </div><div class="csl-right-inline"><strong>An improved algorithm for the maximal information coefficient and its application.</strong> <div class="csl-block">Dan Cao, Yuan Chen, Jin Chen, Hongyan Zhang, Zheming Yuan</div> <em>Royal Society open science</em> (2021-02-10) <a href="https://www.ncbi.nlm.nih.gov/pubmed/33972855">https://www.ncbi.nlm.nih.gov/pubmed/33972855</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1098/rsos.201424">10.1098/rsos.201424</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33972855">33972855</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8074658">PMC8074658</a></div></div>
</div>
<div id="ref-g8HrFUfP" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">27. </div><div class="csl-right-inline"><strong>Time-Frequency Maximal Information Coefficient Method and its Application to Functional Corticomuscular Coupling.</strong> <div class="csl-block">Tie Liang, Qingyu Zhang, Xiaoguang Liu, Cunguang Lou, Xiuling Liu, Hongrui Wang</div> <em>IEEE transactions on neural systems and rehabilitation engineering : a publication of the IEEE Engineering in Medicine and Biology Society</em> (2020-11-06) <a href="https://www.ncbi.nlm.nih.gov/pubmed/33001806">https://www.ncbi.nlm.nih.gov/pubmed/33001806</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1109/tnsre.2020.3028199">10.1109/tnsre.2020.3028199</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33001806">33001806</a></div></div>
</div>
<div id="ref-ztrPHUjX" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">28. </div><div class="csl-right-inline"><strong>A New Algorithm to Optimize Maximal Information Coefficient.</strong> <div class="csl-block">Yuan Chen, Ying Zeng, Feng Luo, Zheming Yuan</div> <em>PloS one</em> (2016-06-22) <a href="https://www.ncbi.nlm.nih.gov/pubmed/27333001">https://www.ncbi.nlm.nih.gov/pubmed/27333001</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1371/journal.pone.0157567">10.1371/journal.pone.0157567</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27333001">27333001</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4917098">PMC4917098</a></div></div>
</div>
<div id="ref-VCRLONE" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">29. </div><div class="csl-right-inline"><strong>Clustermatch: discovering hidden relations in highly diverse kinds of qualitative and quantitative data without standardization</strong> <div class="csl-block">Milton Pividori, Andres Cernadas, Luis A de Haro, Fernando Carrari, Georgina Stegmayer, Diego H Milone</div> <em>Bioinformatics</em> (2018-10-24) <a href="https://doi.org/gfg4bt">https://doi.org/gfg4bt</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/bioinformatics/bty899">10.1093/bioinformatics/bty899</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30357313">30357313</a></div></div>
</div>
<div id="ref-9Pr9idng" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">30. </div><div class="csl-right-inline"><strong>The GTEx Consortium atlas of genetic regulatory effects across human tissues</strong> <em>Science</em> (2020-09-10) <a href="https://doi.org/ghbnhr">https://doi.org/ghbnhr</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1126/science.aaz1776">10.1126/science.aaz1776</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32913098">32913098</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7737656">PMC7737656</a></div></div>
</div>
<div id="ref-CVF61Un5" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">31. </div><div class="csl-right-inline"><strong>Understanding multicellular function and disease with human tissue-specific networks</strong> <div class="csl-block">Casey S Greene, Arjun Krishnan, Aaron K Wong, Emanuela Ricciotti, Rene A Zelaya, Daniel S Himmelstein, Ran Zhang, Boris M Hartmann, Elena Zaslavsky, Stuart C Sealfon, … Olga G Troyanskaya</div> <em>Nature Genetics</em> (2015-04-27) <a href="https://doi.org/f7dvkv">https://doi.org/f7dvkv</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/ng.3259">10.1038/ng.3259</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25915600">25915600</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4828725">PMC4828725</a></div></div>
</div>
<div id="ref-e4AuoW8N" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">32. </div><div class="csl-right-inline"><strong>Comparing partitions</strong> <div class="csl-block">Lawrence Hubert, Phipps Arabie</div> <em>Journal of Classification</em> (1985-12) <a href="https://doi.org/bphmzh">https://doi.org/bphmzh</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1007/bf01908075">10.1007/bf01908075</a></div></div>
</div>
<div id="ref-WP7yhZGS" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">33. </div><div class="csl-right-inline"><strong>Graphs in Statistical Analysis</strong> <div class="csl-block">FJ Anscombe</div> <em>The American Statistician</em> (1973-02) <a href="https://doi.org/gfpn48">https://doi.org/gfpn48</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1080/00031305.1973.10478966">10.1080/00031305.1973.10478966</a></div></div>
</div>
<div id="ref-LW7cVCGa" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">34. </div><div class="csl-right-inline"><strong>Download the Datasaurus: Never trust summary statistics alone; always visualize your data</strong> <div class="csl-block">Alberto Cairo</div> <a href="http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html">http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html</a></div>
</div>
<div id="ref-dvyMwrz9" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">35. </div><div class="csl-right-inline"><strong>Same Stats, Different Graphs</strong> <div class="csl-block">Justin Matejka, George Fitzmaurice</div> <em>Proceedings of the 2017 CHI Conference on Human Factors in Computing Systems</em> (2017-05-02) <a href="https://doi.org/gdtg2w">https://doi.org/gdtg2w</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1145/3025453.3025912">10.1145/3025453.3025912</a></div></div>
</div>
<div id="ref-FhufXP6P" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">36. </div><div class="csl-right-inline"><strong>Generating data sets for teaching the importance of regression analysis</strong> <div class="csl-block">Lori L Murray, John G Wilson</div> <em>Decision Sciences Journal of Innovative Education</em> (2021-03-31) <a href="https://doi.org/gjmgqt">https://doi.org/gjmgqt</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1111/dsji.12233">10.1111/dsji.12233</a></div></div>
</div>
<div id="ref-yCHLC0oS" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">37. </div><div class="csl-right-inline"><strong>Detecting Novel Associations in Large Data Sets</strong> <div class="csl-block">David N Reshef, Yakir A Reshef, Hilary K Finucane, Sharon R Grossman, Gilean McVean, Peter J Turnbaugh, Eric S Lander, Michael Mitzenmacher, Pardis C Sabeti</div> <em>Science</em> (2011-12-16) <a href="https://doi.org/bzn5c3">https://doi.org/bzn5c3</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1126/science.1205438">10.1126/science.1205438</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/22174245">22174245</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3325791">PMC3325791</a></div></div>
</div>
<div id="ref-1AMcxTw9R" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">38. </div><div class="csl-right-inline"><strong>A Novel Method to Efficiently Highlight Nonlinearly Expressed Genes</strong> <div class="csl-block">Qifei Wang, Haojian Zhang, Yuqing Liang, Heling Jiang, Siqiao Tan, Feng Luo, Zheming Yuan, Yuan Chen</div> <em>Frontiers in Genetics</em> (2020-01-31) <a href="https://doi.org/gnr5k7">https://doi.org/gnr5k7</a> <div class="csl-block">DOI: <a href="https://doi.org/10.3389/fgene.2019.01410">10.3389/fgene.2019.01410</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32082366">32082366</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7006292">PMC7006292</a></div></div>
</div>
<div id="ref-16ddFzCqe" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">39. </div><div class="csl-right-inline"><strong>Comprehensive Identification of Cell Cycle–regulated Genes of the Yeast&lt;i&gt;Saccharomyces cerevisiae&lt;/i&gt;by Microarray Hybridization</strong> <div class="csl-block">Paul T Spellman, Gavin Sherlock, Michael Q Zhang, Vishwanath R Iyer, Kirk Anders, Michael B Eisen, Patrick O Brown, David Botstein, Bruce Futcher</div> <em>Molecular Biology of the Cell</em> (1998-12) <a href="https://doi.org/gnr5k5">https://doi.org/gnr5k5</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1091/mbc.9.12.3273">10.1091/mbc.9.12.3273</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/9843569">9843569</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC25624">PMC25624</a></div></div>
</div>
<div id="ref-ZhJ7VK5R" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">40. </div><div class="csl-right-inline"><strong>UpSet: Visualization of Intersecting Sets</strong> <div class="csl-block">Alexander Lex, Nils Gehlenborg, Hendrik Strobelt, Romain Vuillemot, Hanspeter Pfister</div> <em>IEEE Transactions on Visualization and Computer Graphics</em> (2014-12-31) <a href="https://doi.org/f3ssr5">https://doi.org/f3ssr5</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1109/tvcg.2014.2346248">10.1109/tvcg.2014.2346248</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/26356912">26356912</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4720993">PMC4720993</a></div></div>
</div>
<div id="ref-9ZXy7Ut2" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">41. </div><div class="csl-right-inline"><strong>Understanding multicellular function and disease with human tissue-specific networks</strong> <div class="csl-block">Casey S Greene, Arjun Krishnan, Aaron K Wong, Emanuela Ricciotti, Rene A Zelaya, Daniel S Himmelstein, Ran Zhang, Boris M Hartmann, Elena Zaslavsky, Stuart C Sealfon, … Olga G Troyanskaya</div> <em>Nature genetics</em> (2015-06) <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4828725/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4828725/</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/ng.3259">10.1038/ng.3259</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25915600">25915600</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4828725">PMC4828725</a></div></div>
</div>
<div id="ref-ZSXf7Pdq" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">42. </div><div class="csl-right-inline"><strong>HumanBase: data-driven predictions of gene function and interactions</strong> <a href="https://hb.flatironinstitute.org/">https://hb.flatironinstitute.org/</a></div>
</div>
<div id="ref-BgCQnLU6" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">43. </div><div class="csl-right-inline"><strong>Data sources</strong> <a href="https://hb.flatironinstitute.org/data">https://hb.flatironinstitute.org/data</a></div>
</div>
<div id="ref-tt0Vdf4C" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">44. </div><div class="csl-right-inline"><strong>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles.</strong> <div class="csl-block">Aravind Subramanian, Pablo Tamayo, Vamsi K Mootha, Sayan Mukherjee, Benjamin L Ebert, Michael A Gillette, Amanda Paulovich, Scott L Pomeroy, Todd R Golub, Eric S Lander, Jill P Mesirov</div> <em>Proceedings of the National Academy of Sciences of the United States of America</em> (2005-09-30) <a href="https://www.ncbi.nlm.nih.gov/pubmed/16199517">https://www.ncbi.nlm.nih.gov/pubmed/16199517</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1073/pnas.0506580102">10.1073/pnas.0506580102</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/16199517">16199517</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1239896">PMC1239896</a></div></div>
</div>
<div id="ref-mk4SLpDo" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">45. </div><div class="csl-right-inline"><strong>Defining cell-type specificity at the transcriptional level in human disease</strong> <div class="csl-block">Wenjun Ju, Casey S Greene, Felix Eichinger, Viji Nair, Jeffrey B Hodgin, Markus Bitzer, Young-suk Lee, Qian Zhu, Masami Kehata, Min Li, … Matthias Kretzler</div> <em>Genome Research</em> (2013-08-15) <a href="https://doi.org/f5g4hm">https://doi.org/f5g4hm</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1101/gr.155697.113">10.1101/gr.155697.113</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23950145">23950145</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3814886">PMC3814886</a></div></div>
</div>
<div id="ref-FKQEHB1F" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">46. </div><div class="csl-right-inline"><strong>RASSF2, CYTIP - HumanBase</strong> <a href="https://hb.flatironinstitute.org/gene/9770+9595">https://hb.flatironinstitute.org/gene/9770+9595</a></div>
</div>
<div id="ref-JpfbR0un" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">47. </div><div class="csl-right-inline"><strong>MYOZ1, TNNI2 - HumanBase</strong> <a href="https://hb.flatironinstitute.org/gene/58529+7136">https://hb.flatironinstitute.org/gene/58529+7136</a></div>
</div>
<div id="ref-4QgDZ8bF" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">48. </div><div class="csl-right-inline"><strong>Policy: NIH to balance sex in cell and animal studies</strong> <div class="csl-block">Janine A Clayton, Francis S Collins</div> <em>Nature</em> (2014-05) <a href="https://doi.org/gfzc82">https://doi.org/gfzc82</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/509282a">10.1038/509282a</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24834516">24834516</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5101948">PMC5101948</a></div></div>
</div>
<div id="ref-iox25BGw" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">49. </div><div class="csl-right-inline"><strong>Considering Sex as a Biological Variable in Basic and Clinical Studies: An Endocrine Society Scientific Statement</strong> <div class="csl-block">Aditi Bhargava, Arthur P Arnold, Debra A Bangasser, Kate M Denton, Arpana Gupta, Lucinda M Hilliard Krause, Emeran A Mayer, Margaret McCarthy, Walter L Miller, Armin Raznahan, Ragini Verma</div> <em>Endocrine Reviews</em> (2021-03-11) <a href="https://doi.org/gm642r">https://doi.org/gm642r</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1210/endrev/bnaa034">10.1210/endrev/bnaa034</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33704446">33704446</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8348944">PMC8348944</a></div></div>
</div>
<div id="ref-1GpiBQk8d" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">50. </div><div class="csl-right-inline"><strong>Considering sex as a biological variable will require a global shift in science culture</strong> <div class="csl-block">Rebecca M Shansky, Anne Z Murphy</div> <em>Nature Neuroscience</em> (2021-03-01) <a href="https://doi.org/gjhkx8">https://doi.org/gjhkx8</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/s41593-021-00806-8">10.1038/s41593-021-00806-8</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33649507">33649507</a></div></div>
</div>
<div id="ref-1CZbj0k1F" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">51. </div><div class="csl-right-inline"><strong>Temporal patterns of genes in scientific publications.</strong> <div class="csl-block">Thomas Pfeiffer, Robert Hoffmann</div> <em>Proceedings of the National Academy of Sciences of the United States of America</em> (2007-07-09) <a href="https://www.ncbi.nlm.nih.gov/pubmed/17620606">https://www.ncbi.nlm.nih.gov/pubmed/17620606</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1073/pnas.0701315104">10.1073/pnas.0701315104</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/17620606">17620606</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1924584">PMC1924584</a></div></div>
</div>
<div id="ref-104MiBf8H" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">52. </div><div class="csl-right-inline"><strong>Power-law-like distributions in biomedical publications and research funding.</strong> <div class="csl-block">Andrew I Su, John B Hogenesch</div> <em>Genome biology</em> (2007) <a href="https://www.ncbi.nlm.nih.gov/pubmed/17472739">https://www.ncbi.nlm.nih.gov/pubmed/17472739</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1186/gb-2007-8-4-404">10.1186/gb-2007-8-4-404</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/17472739">17472739</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1895997">PMC1895997</a></div></div>
</div>
<div id="ref-IlPwHaTE" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">53. </div><div class="csl-right-inline"><strong>Large-scale investigation of the reasons why potentially important genes are ignored.</strong> <div class="csl-block">Thomas Stoeger, Martin Gerlach, Richard I Morimoto, Luís A Nunes Amaral</div> <em>PLoS biology</em> (2018-09-18) <a href="https://www.ncbi.nlm.nih.gov/pubmed/30226837">https://www.ncbi.nlm.nih.gov/pubmed/30226837</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1371/journal.pbio.2006643">10.1371/journal.pbio.2006643</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30226837">30226837</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6143198">PMC6143198</a></div></div>
</div>
<div id="ref-9i58Tfs4" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">54. </div><div class="csl-right-inline"><strong>KLHL21, a novel gene that contributes to the progression of hepatocellular carcinoma.</strong> <div class="csl-block">Lei Shi, Wenfa Zhang, Fagui Zou, Lihua Mei, Gang Wu, Yong Teng</div> <em>BMC cancer</em> (2016-10-21) <a href="https://www.ncbi.nlm.nih.gov/pubmed/27769251">https://www.ncbi.nlm.nih.gov/pubmed/27769251</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1186/s12885-016-2851-7">10.1186/s12885-016-2851-7</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27769251">27769251</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5073891">PMC5073891</a></div></div>
</div>
<div id="ref-efGVmXWt" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">55. </div><div class="csl-right-inline"><strong>Inhibition of KLHL21 prevents cholangiocarcinoma progression through regulating cell proliferation and motility, arresting cell cycle and reducing Erk activation.</strong> <div class="csl-block">Jian Chen, Wenfeng Song, Yehui Du, Zequn Li, Zefeng Xuan, Long Zhao, Jun Chen, Yongchao Zhao, Biguang Tuo, Shusen Zheng, Penghong Song</div> <em>Biochemical and biophysical research communications</em> (2018-03-31) <a href="https://www.ncbi.nlm.nih.gov/pubmed/29574153">https://www.ncbi.nlm.nih.gov/pubmed/29574153</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1016/j.bbrc.2018.03.152">10.1016/j.bbrc.2018.03.152</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29574153">29574153</a></div></div>
</div>
<div id="ref-1FQgFkJoJ" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">56. </div><div class="csl-right-inline"><strong>Tumor-promoting mechanisms of macrophage-derived extracellular vesicles-enclosed microRNA-660 in breast cancer progression.</strong> <div class="csl-block">Changchun Li, Ruiqing Li, Xingchi Hu, Guangjun Zhou, Guoqing Jiang</div> <em>Breast cancer research and treatment</em> (2022-01-27) <a href="https://www.ncbi.nlm.nih.gov/pubmed/35084622">https://www.ncbi.nlm.nih.gov/pubmed/35084622</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1007/s10549-021-06433-y">10.1007/s10549-021-06433-y</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/35084622">35084622</a></div></div>
</div>
<div id="ref-yqBcaXHD" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">57. </div><div class="csl-right-inline"><strong>10 Years of GWAS Discovery: Biology, Function, and Translation</strong> <div class="csl-block">Peter M Visscher, Naomi R Wray, Qian Zhang, Pamela Sklar, Mark I McCarthy, Matthew A Brown, Jian Yang</div> <em>The American Journal of Human Genetics</em> (2017-07) <a href="https://doi.org/gcsmnm">https://doi.org/gcsmnm</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1016/j.ajhg.2017.06.005">10.1016/j.ajhg.2017.06.005</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28686856">28686856</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5501872">PMC5501872</a></div></div>
</div>
<div id="ref-17B4AigZT" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">58. </div><div class="csl-right-inline"><strong>Benefits and limitations of genome-wide association studies</strong> <div class="csl-block">Vivian Tam, Nikunj Patel, Michelle Turcotte, Yohan Bossé, Guillaume Paré, David Meyre</div> <em>Nature Reviews Genetics</em> (2019-05-08) <a href="https://doi.org/ggcxxb">https://doi.org/ggcxxb</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/s41576-019-0127-1">10.1038/s41576-019-0127-1</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31068683">31068683</a></div></div>
</div>
<div id="ref-189xgFrlN" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">59. </div><div class="csl-right-inline"><strong>Numba</strong> <div class="csl-block">Siu Kwan Lam, Antoine Pitrou, Stanley Seibert</div> <em>Proceedings of the Second Workshop on the LLVM Compiler Infrastructure in HPC - LLVM '15</em> (2015) <a href="https://doi.org/gf3nks">https://doi.org/gf3nks</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1145/2833157.2833162">10.1145/2833157.2833162</a></div></div>
</div>
<div id="ref-190WLq6rx" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">60. </div><div class="csl-right-inline"><strong>GitHub - greenelab/ccc</strong> <div class="csl-block">GitHub</div> <a href="https://github.com/greenelab/ccc">https://github.com/greenelab/ccc</a></div>
</div>
<div id="ref-tGvcfcsl" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">61. </div><div class="csl-right-inline"><strong>NCBI GEO: archive for functional genomics data sets—update</strong> <div class="csl-block">Tanya Barrett, Stephen E Wilhite, Pierre Ledoux, Carlos Evangelista, Irene F Kim, Maxim Tomashevsky, Kimberly A Marshall, Katherine H Phillippy, Patti M Sherman, Michelle Holko, … Alexandra Soboleva</div> <em>Nucleic Acids Research</em> (2012-11-26) <a href="https://doi.org/f3mn62">https://doi.org/f3mn62</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/nar/gks1193">10.1093/nar/gks1193</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23193258">23193258</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3531084">PMC3531084</a></div></div>
</div>
<div id="ref-JHRpiznV" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">62. </div><div class="csl-right-inline"><strong>The BioGRID interaction database: 2013 update</strong> <div class="csl-block">Andrew Chatr-Aryamontri, Bobby-Joe Breitkreutz, Sven Heinicke, Lorrie Boucher, Andrew Winter, Chris Stark, Julie Nixon, Lindsay Ramage, Nadine Kolas, Lara O'Donnell, … Mike Tyers</div> <em>Nucleic acids research</em> (2013-01) <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3531226/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3531226/</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/nar/gks1158">10.1093/nar/gks1158</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23203989">23203989</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3531226">PMC3531226</a></div></div>
</div>
<div id="ref-7fExfA0i" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">63. </div><div class="csl-right-inline"><strong>The IntAct molecular interaction database in 2012</strong> <div class="csl-block">S Kerrien, B Aranda, L Breuza, A Bridge, F Broackes-Carter, C Chen, M Duesbury, M Dumousseau, M Feuermann, U Hinz, … H Hermjakob</div> <em>Nucleic Acids Research</em> (2011-11-24) <a href="https://doi.org/bpmrdk">https://doi.org/bpmrdk</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/nar/gkr1088">10.1093/nar/gkr1088</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/22121220">22121220</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3245075">PMC3245075</a></div></div>
</div>
<div id="ref-ODdRgjHY" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">64. </div><div class="csl-right-inline"><strong>MINT, the molecular interaction database: 2012 update</strong> <div class="csl-block">Luana Licata, Leonardo Briganti, Daniele Peluso, Livia Perfetto, Marta Iannuccelli, Eugenia Galeota, Francesca Sacco, Anita Palma, Aurelio Pio Nardozza, Elena Santonico, … Gianni Cesareni</div> <em>Nucleic Acids Research</em> (2011-11-16) <a href="https://doi.org/cqvx3b">https://doi.org/cqvx3b</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/nar/gkr930">10.1093/nar/gkr930</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/22096227">22096227</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3244991">PMC3244991</a></div></div>
</div>
<div id="ref-2AZQGpIZ" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">65. </div><div class="csl-right-inline"><strong>MIPS: a database for genomes and protein sequences</strong> <div class="csl-block">HW Mewes, K Heumann, A Kaps, K Mayer, F Pfeiffer, S Stocker, D Frishman</div> <em>Nucleic acids research</em> (1999-01-01) <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC148093/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC148093/</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/nar/27.1.44">10.1093/nar/27.1.44</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/9847138">9847138</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC148093">PMC148093</a></div></div>
</div>
<div id="ref-h6BVQcKz" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">66. </div><div class="csl-right-inline"><strong>JASPAR 2010: the greatly expanded open-access database of transcription factor binding profiles</strong> <div class="csl-block">Elodie Portales-Casamar, Supat Thongjuea, Andrew T Kwon, David Arenillas, Xiaobei Zhao, Eivind Valen, Dimas Yusuf, Boris Lenhard, Wyeth W Wasserman, Albin Sandelin</div> <em>Nucleic Acids Research</em> (2009-11-10) <a href="https://doi.org/ddwfqp">https://doi.org/ddwfqp</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/nar/gkp950">10.1093/nar/gkp950</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/19906716">19906716</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2808906">PMC2808906</a></div></div>
</div>
<div id="ref-15p5LWIVP" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">67. </div><div class="csl-right-inline"><strong>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</strong> <div class="csl-block">Aravind Subramanian, Pablo Tamayo, Vamsi K Mootha, Sayan Mukherjee, Benjamin L Ebert, Michael A Gillette, Amanda Paulovich, Scott L Pomeroy, Todd R Golub, Eric S Lander, Jill P Mesirov</div> <em>Proceedings of the National Academy of Sciences</em> (2005-09-30) <a href="https://doi.org/d4qbh8">https://doi.org/d4qbh8</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1073/pnas.0506580102">10.1073/pnas.0506580102</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/16199517">16199517</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1239896">PMC1239896</a></div></div>
</div>
<div id="ref-Diiyst6u" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">68. </div><div class="csl-right-inline"><strong>The Sleipnir library for computational functional genomics.</strong> <div class="csl-block">Curtis Huttenhower, Mark Schroeder, Maria D Chikina, Olga G Troyanskaya</div> <em>Bioinformatics (Oxford, England)</em> (2008-05-21) <a href="https://www.ncbi.nlm.nih.gov/pubmed/18499696">https://www.ncbi.nlm.nih.gov/pubmed/18499696</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/bioinformatics/btn237">10.1093/bioinformatics/btn237</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/18499696">18499696</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2718674">PMC2718674</a></div></div>
</div>
<div id="ref-wY5WU58s" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">69. </div><div class="csl-right-inline"><strong>minerva and minepy: a C engine for the MINE suite and its R, Python and MATLAB wrappers</strong> <div class="csl-block">Davide Albanese, Michele Filosi, Roberto Visintainer, Samantha Riccadonna, Giuseppe Jurman, Cesare Furlanello</div> <em>Bioinformatics</em> (2012-12-14) <a href="https://doi.org/f4nxg6">https://doi.org/f4nxg6</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1093/bioinformatics/bts707">10.1093/bioinformatics/bts707</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23242262">23242262</a></div></div>
</div>
<div id="ref-ah0tGOQ0" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">70. </div><div class="csl-right-inline"><strong>GitHub - minepy/minepy: minepy - Maximal Information-based Nonparametric Exploration</strong> <div class="csl-block">GitHub</div> <a href="https://github.com/minepy/minepy">https://github.com/minepy/minepy</a></div>
</div>
<div id="ref-AcVZZdTz" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">71. </div><div class="csl-right-inline"><strong>Measuring Dependence Powerfully and Equitably</strong> <div class="csl-block">Yakir Reshef, David Reshef, Hilary Finucane, Pardis Sabeti, Michael Mitzenmacher</div> <em>Journal of Machine Learning Research</em> (2010) <a href="https://jmlr.org/papers/v17/15-308.html">https://jmlr.org/papers/v17/15-308.html</a></div>
</div>
<div id="ref-GZZZRhEY" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">72. </div><div class="csl-right-inline"><strong>Scikit-learn: Machine Learning in Python</strong> <div class="csl-block">Fabian Pedregosa, Gael Varoquaux, Alexandre Gramfort, Vincent Michel, Bertrand Thirion, Olivier Grisel, Mathieu Blondel, Peter Prettenhofer, Ron Weiss, Vincent Dubourg, … Edouard Duchesnay</div> <em>Journal of Machine Learning Research</em> (2011) <a href="https://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html">https://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html</a></div>
</div>
<div id="ref-CHkDwNWM" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">73. </div><div class="csl-right-inline"><strong>An improved algorithm for the maximal information coefficient and its application</strong> <div class="csl-block">Dan Cao, Yuan Chen, Jin Chen, Hongyan Zhang, Zheming Yuan</div> <em>Royal Society Open Science</em> (2021-02) <a href="https://doi.org/gpcwkd">https://doi.org/gpcwkd</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1098/rsos.201424">10.1098/rsos.201424</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33972855">33972855</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8074658">PMC8074658</a></div></div>
</div>
<div id="ref-NRWTH7z2" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">74. </div><div class="csl-right-inline"><strong>A New Algorithm to Optimize Maximal Information Coefficient</strong> <div class="csl-block">Yuan Chen, Ying Zeng, Feng Luo, Zheming Yuan</div> <em>PLOS ONE</em> (2016-06-22) <a href="https://doi.org/gbpjt7">https://doi.org/gbpjt7</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1371/journal.pone.0157567">10.1371/journal.pone.0157567</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27333001">27333001</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4917098">PMC4917098</a></div></div>
</div>
<div id="ref-hjqdXcdK" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">75. </div><div class="csl-right-inline"><strong>RapidMic: Rapid Computation of the Maximal Information Coefficient</strong> <div class="csl-block">Dongming Tang, Mingwen Wang, Weifan Zheng, Hongjun Wang</div> <em>Evolutionary Bioinformatics</em> (2014-01) <a href="https://doi.org/gpt7c8">https://doi.org/gpt7c8</a> <div class="csl-block">DOI: <a href="https://doi.org/10.4137/ebo.s13121">10.4137/ebo.s13121</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24526831">24526831</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3921152">PMC3921152</a></div></div>
</div>
<div id="ref-HLCXXMYj" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">76. </div><div class="csl-right-inline"><strong>A Novel Algorithm for the Precise Calculation of the Maximal Information Coefficient</strong> <div class="csl-block">Yi Zhang, Shili Jia, Haiyun Huang, Jiqing Qiu, Changjie Zhou</div> <em>Scientific Reports</em> (2014-10-17) <a href="https://doi.org/gpt7c7">https://doi.org/gpt7c7</a> <div class="csl-block">DOI: <a href="https://doi.org/10.1038/srep06662">10.1038/srep06662</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25322794">25322794</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4200418">PMC4200418</a></div></div>
</div>
</div>
<!-- ## Acknowledgements -->
<h2 class="page_break_before" id="supplementary-material">Supplementary material</h2>
<h3 id="sec:mic">Supplementary Note 1: Comparison with the Maximal Information Coefficient (MIC) on gene expression data</h3>
<p>We compared all the coefficients in this study with MIC <span class="citation" data-cites="tbcQL0eR">[<a href="#ref-tbcQL0eR" role="doc-biblioref">24</a>]</span>, a popular nonlinear method that can find complex relationships in data, although very computationally intensive <span class="citation" data-cites="CHkDwNWM">[<a href="#ref-CHkDwNWM" role="doc-biblioref">73</a>]</span>.
We ran MIC<sub>e</sub> (see Methods) on all possible pairwise comparisons of our 5,000 highly variable genes from whole blood in GTEx v8.
This took 4 days and 19 hours to finish (compared with 9 hours for CCC).
Then we performed the analysis on the distribution of coefficients (the same as in the main text), shown in Figure <a href="#fig:dist_coefs_mic">6</a>.
We verified that CCC and MIC behave similarly in this dataset, with essentially the same distribution but only shifted.
Figure <a href="#fig:dist_coefs_mic">6</a> c shows that these two coefficients relate almost linearly, and both compare very similarly with Pearson and Spearman.</p>
<div id="fig:dist_coefs_mic" class="fignos">
<figure>
<img src="images/coefs_comp/gtex_whole_blood/mic/dist-main.svg" style="width:100.0%" alt="Figure 6: Distribution of MIC values on gene expression (GTEx v8, whole blood) and comparison with other methods. a) Histogram of coefficient values. b) Corresponding cumulative histogram. The dotted line maps the coefficient value that accumulates 70% of gene pairs. c) 2D histogram plot with hexagonal bins between all coefficients, where a logarithmic scale was used to color each hexagon." />
<figcaption aria-hidden="true"><span>Figure 6:</span> <strong>Distribution of MIC values on gene expression (GTEx v8, whole blood) and comparison with other methods.</strong>
<strong>a)</strong> Histogram of coefficient values.
<strong>b)</strong> Corresponding cumulative histogram. The dotted line maps the coefficient value that accumulates 70% of gene pairs.
<strong>c)</strong> 2D histogram plot with hexagonal bins between all coefficients, where a logarithmic scale was used to color each hexagon.</figcaption>
</figure>
</div>
<h3 class="page_break_before" id="sec:time_test">Supplementary Note 2: Computational complexity of coefficients</h3>
<p>We also compared CCC with the other coefficients in terms of computational complexity.
Although CCC and MIC might identify similar gene pairs in gene expression data (see <a href="#sec:mic">here</a>), the use of MIC in large datasets remains limited due to its very long computation time, despite some methodological/implementation improvements <span class="citation" data-cites="wY5WU58s NRWTH7z2 hjqdXcdK HLCXXMYj CHkDwNWM">[<a href="#ref-wY5WU58s" role="doc-biblioref">69</a>,<a href="#ref-CHkDwNWM" role="doc-biblioref">73</a>,<a href="#ref-NRWTH7z2" role="doc-biblioref">74</a>,<a href="#ref-hjqdXcdK" role="doc-biblioref">75</a>,<a href="#ref-HLCXXMYj" role="doc-biblioref">76</a>]</span>.
The original MIC implementation uses ApproxMaxMI, a computationally demanding heuristic estimator <span class="citation" data-cites="yCHLC0oS">[<a href="#ref-yCHLC0oS" role="doc-biblioref">37</a>]</span>.
Recently, a more efficient implementation called MIC<sub>e</sub> was proposed <span class="citation" data-cites="AcVZZdTz">[<a href="#ref-AcVZZdTz" role="doc-biblioref">71</a>]</span>.
These two MIC estimators are provided by the <code>minepy</code> package <span class="citation" data-cites="wY5WU58s">[<a href="#ref-wY5WU58s" role="doc-biblioref">69</a>]</span>, a C implementation available for Python.
We compared all these coefficients in terms of computation time on randomly generated variables of different sizes, which simulates a scenario of gene expression data with different numbers of conditions.
Differently from the rest, CCC allows us to easily parallelize the computation of a single gene pair (see <a href="#sec:ccc_algo">Methods</a>), so we also tested the cases using 1 and 3 CPU cores.
Figure <a href="#fig:time_test">7</a> shows the time in seconds in log scale.</p>
<div id="fig:time_test" class="fignos">
<figure>
<img src="images/coefs_comp/time_test/time_test-main.svg" style="width:55.0%" alt="Figure 7: Computational complexity of all correlation coefficients on simulated data. We simulated variables/features with varying data sizes (from 100 to a million, x-axis). The plot shows the average time in seconds (log-scale) taken for each coefficient on ten repetitions (1000 repetitions were performed for data size 100). CCC was run using 1 and 3 CPU cores. MIC and MICe did not finish running in a reasonable amount of time for data sizes of 10,000 and 100,000, respectively." />
<figcaption aria-hidden="true"><span>Figure 7:</span> <strong>Computational complexity of all correlation coefficients on simulated data.</strong>
We simulated variables/features with varying data sizes (from 100 to a million, <span class="math inline">\(x\)</span>-axis).
The plot shows the average time in seconds (log-scale) taken for each coefficient on ten repetitions (1000 repetitions were performed for data size 100).
CCC was run using 1 and 3 CPU cores.
MIC and MIC<sub>e</sub> did not finish running in a reasonable amount of time for data sizes of 10,000 and 100,000, respectively.</figcaption>
</figure>
</div>
<p>As we already expected, Pearson and Spearman were the fastest, given that they only need to compute basic summary statistics from the data.
For example, Pearson is three orders of magnitude faster than CCC.
Among the nonlinear coefficients, CCC was faster than the two MIC variations (up to two orders of magnitude), with the only exception in very small data sizes.
The difference is important because both MIC variants were implemented in C <span class="citation" data-cites="wY5WU58s">[<a href="#ref-wY5WU58s" role="doc-biblioref">69</a>]</span>, a high-performance programming language, whereas CCC was implemented in Python (optimized with <code>numba</code>).
For a data size of a million, the multi-core CCC was twice as fast as the single-core CCC.
This suggests that new implementations using more advanced processing units (such as GPUs) are feasible and could make CCC reach speeds closer to Pearson.</p>
<h3 class="page_break_before" id="tissue-specific-gene-networks-with-giant">Tissue-specific gene networks with GIANT</h3>
<div id="tbl:giant:weights" class="tablenos">
<table id="tbl:giant:weights">
<caption><span>Table 1:</span> Network statistics of six gene pairs shown in Figure <a href="#fig:upsetplot_coefs">3</a> b for blood and predicted cell types.
Only gene pairs present in GIANT models are listed.
For each gene in the pair (first column), the minimum, average and maximum interaction coefficients with the other genes in the network are shown.
</caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><strong>Interaction confidence</strong> <!-- $colspan="7" --></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"><strong>Blood</strong> <!-- $colspan="3" --></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><strong>Predicted cell type</strong> <!-- $colspan="4" --></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Gene</strong></td>
<td style="text-align: center;"><strong>Min.</strong></td>
<td style="text-align: center;"><strong>Avg.</strong></td>
<td style="text-align: center;"><strong>Max.</strong></td>
<td style="text-align: center;"><strong>Cell type</strong></td>
<td style="text-align: center;"><strong>Min.</strong></td>
<td style="text-align: center;"><strong>Avg.</strong></td>
<td style="text-align: center;"><strong>Max.</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><em>IFNG</em></td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;">0.42</td>
<td style="text-align: center;">0.54</td>
<td style="text-align: center;">Natural killer cell<!-- $rowspan="2" --></td>
<td style="text-align: center;">0.74</td>
<td style="text-align: center;">0.90</td>
<td style="text-align: center;">0.99</td>
</tr>
<tr class="even">
<td style="text-align: center;"><em>SDS</em></td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">0.81</td>
<td style="text-align: center;">0.94<!-- $removenext="2" --></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><!-- $colspan="7" --></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><em>JUN</em></td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">0.68</td>
<td style="text-align: center;">0.97</td>
<td style="text-align: center;">Mononuclear phagocyte<!-- $rowspan="2" --></td>
<td style="text-align: center;">0.36</td>
<td style="text-align: center;">0.73</td>
<td style="text-align: center;">0.94</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><em>APOC1</em></td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">0.77</td>
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.80<!-- $removenext="2" --></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><!-- $colspan="7" --></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><em>ZDHHC12</em></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">Macrophage<!-- $rowspan="2" --></td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: center;"><em>CCL18</em></td>
<td style="text-align: center;">0.74</td>
<td style="text-align: center;">0.79</td>
<td style="text-align: center;">0.86</td>
<td style="text-align: center;">0.36</td>
<td style="text-align: center;">0.70</td>
<td style="text-align: center;">0.90<!-- $removenext="2" --></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><!-- $colspan="7" --></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><em>RASSF2</em></td>
<td style="text-align: center;">0.69</td>
<td style="text-align: center;">0.77</td>
<td style="text-align: center;">0.90</td>
<td style="text-align: center;">Leukocyte<!-- $rowspan="2" --></td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">0.74</td>
<td style="text-align: center;">0.88</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><em>CYTIP</em></td>
<td style="text-align: center;">0.74</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">0.91</td>
<td style="text-align: center;">0.76</td>
<td style="text-align: center;">0.84</td>
<td style="text-align: center;">0.91<!-- $removenext="2" --></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><!-- $colspan="7" --></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><em>MYOZ1</em></td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">Skeletal muscle<!-- $rowspan="2" --></td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: center;"><em>TNNI2</em></td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.11</td>
<td style="text-align: center;">0.12<!-- $removenext="2" --></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><!-- $colspan="7" --></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><em>PYGM</em></td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.14</td>
<td style="text-align: center;">Skeletal muscle<!-- $rowspan="2" --></td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><em>TPM2</em></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.56</td>
<td style="text-align: center;">0.80</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;">0.47<!-- $removenext="2" --></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<!-- ![
**Predicted tissue-specific networks from GIANT for six gene pairs prioritized by correlation coefficients.**
Gene pairs are from Figure @fig:upsetplot_coefs b.
A node represents a gene and an edge the probability that two genes are part of the same biological process in a specific cell type.
The cell type for each gene network was automatically predicted using [@doi:10.1101/gr.155697.113], and it is indicated at the top-right corner of each network.
A maximum of 15 genes are shown for each subfigure.
The GIANT web application automatically determined a minimum interaction confidence (edges' weights) to be shown.
All these analyses can be performed online using the following links:
*IFNG* - *SDS* [@url:https://hb.flatironinstitute.org/gene/10993+3458],
*JUN* - *APOC1* [@url:https://hb.flatironinstitute.org/gene/3725+341],
*ZDHHC12* - *CCL18* [@url:https://hb.flatironinstitute.org/gene/6362+84885],
*RASSF2* - *CYTIP* [@url:https://hb.flatironinstitute.org/gene/9770+9595],
*MYOZ1* - *TNNI2* [@url:https://hb.flatironinstitute.org/gene/58529+7136],
*PYGM* - *TPM2* [@url:https://hb.flatironinstitute.org/gene/5837+7169].
The GIANT web-server was accessed on April 4, 2022.
](images/coefs_comp/giant_networks/auto_selected_tissues/main.svg "GIANT network interaction"){#fig:giant_gene_pairs:pred_tissue width="100%"} -->
<!-- default theme -->

<style>
  /* import google fonts */
  @import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700");
  @import url("https://fonts.googleapis.com/css?family=Source+Code+Pro");

  /* -------------------------------------------------- */
  /* global */
  /* -------------------------------------------------- */

  /* all elements */
  * {
    /* force sans-serif font unless specified otherwise */
    font-family: "Open Sans", "Helvetica", sans-serif;

    /* prevent text inflation on some mobile browsers */
    -webkit-text-size-adjust: none !important;
    -moz-text-size-adjust: none !important;
    -o-text-size-adjust: none !important;
    text-size-adjust: none !important;
  }

  @media only screen {
    /* "page" element */
    body {
      position: relative;
      box-sizing: border-box;
      font-size: 12pt;
      line-height: 1.5;
      max-width: 8.5in;
      margin: 20px auto;
      padding: 40px;
      border-radius: 5px;
      border: solid 1px #bdbdbd;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      background: #ffffff;
    }
  }

  /* when on screen < 8.5in wide */
  @media only screen and (max-width: 8.5in) {
    /* "page" element */
    body {
      padding: 20px;
      margin: 0;
      border-radius: 0;
      border: none;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05) inset;
      background: none;
    }
  }

  /* -------------------------------------------------- */
  /* headings */
  /* -------------------------------------------------- */

  /* all headings */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    margin: 20px 0;
    padding: 0;
    font-weight: bold;
  }

  /* biggest heading */
  h1 {
    margin: 40px 0;
    text-align: center;
  }

  /* second biggest heading */
  h2 {
    margin-top: 30px;
    padding-bottom: 5px;
    border-bottom: solid 1px #bdbdbd;
  }

  /* heading font sizes */
  h1 {
    font-size: 2em;
  }
  h2 {
    font-size: 1.5em;
  }
  h3 {
    font-size: 1.35em;
  }
  h4 {
    font-size: 1.25em;
  }
  h5 {
    font-size: 1.15em;
  }
  h6 {
    font-size: 1em;
  }

  /* -------------------------------------------------- */
  /* manuscript header */
  /* -------------------------------------------------- */

  /* manuscript title */
  header > h1 {
    margin: 0;
  }

  /* manuscript title caption text (ie "automatically generated on") */
  header + p {
    text-align: center;
    margin-top: 10px;
  }

  /* -------------------------------------------------- */
  /* text elements */
  /* -------------------------------------------------- */

  /* links */
  a {
    color: #2196f3;
    overflow-wrap: break-word;
  }

  /* superscripts and subscripts */
  sub,
  sup {
    /* prevent from affecting line height */
    line-height: 0;
  }

  /* unordered and ordered lists*/
  ul,
  ol {
    padding-left: 20px;
  }

  /* class for styling text semibold */
  .semibold {
    font-weight: 600;
  }

  /* class for styling elements horizontally left aligned */
  .left {
    display: block;
    text-align: left;
    margin-left: auto;
    margin-right: 0;
    justify-content: left;
  }

  /* class for styling elements horizontally centered */
  .center {
    display: block;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    justify-content: center;
  }

  /* class for styling elements horizontally right aligned */
  .right {
    display: block;
    text-align: right;
    margin-left: 0;
    margin-right: auto;
    justify-content: right;
  }

  /* -------------------------------------------------- */
  /* section elements */
  /* -------------------------------------------------- */

  /* horizontal divider line */
  hr {
    border: none;
    height: 1px;
    background: #bdbdbd;
  }

  /* paragraphs, horizontal dividers, figures, tables, code */
  p,
  hr,
  figure,
  table,
  pre {
    /* treat all as "paragraphs", with consistent vertical margins */
    margin-top: 20px;
    margin-bottom: 20px;
  }

  /* -------------------------------------------------- */
  /* figures */
  /* -------------------------------------------------- */

  /* figure */
  figure {
    max-width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* figure caption */
  figcaption {
    padding: 0;
    padding-top: 10px;
  }

  /* figure image element */
  figure > img,
  figure > svg {
    max-width: 100%;
    display: block;
    margin-left: auto;
    margin-right: auto;
  }

  /* figure auto-number */
  img + figcaption > span:first-of-type,
  svg + figcaption > span:first-of-type {
    font-weight: bold;
    margin-right: 5px;
  }

  /* -------------------------------------------------- */
  /* tables */
  /* -------------------------------------------------- */

  /* table */
  table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* table cells */
  th,
  td {
    border: solid 1px #bdbdbd;
    padding: 10px;
    /* squash table if too wide for page by forcing line breaks */
    overflow-wrap: break-word;
    word-break: break-word;
  }

  /* header row and even rows */
  th,
  tr:nth-child(2n) {
    background-color: #fafafa;
  }

  /* odd rows */
  tr:nth-child(2n + 1) {
    background-color: #ffffff;
  }

  /* table caption */
  caption {
    text-align: left;
    padding: 0;
    padding-bottom: 10px;
  }

  /* table auto-number */
  table > caption > span:first-of-type {
    font-weight: bold;
    margin-right: 5px;
  }

  /* -------------------------------------------------- */
  /* code */
  /* -------------------------------------------------- */

  /* multi-line code block */
  pre {
    padding: 10px;
    background-color: #eeeeee;
    color: #000000;
    border-radius: 5px;
    break-inside: avoid;
    text-align: left;
  }

  /* inline code, ie code within normal text */
  :not(pre) > code {
    padding: 0 4px;
    background-color: #eeeeee;
    color: #000000;
    border-radius: 5px;
  }

  /* code text */
  /* apply all children, to reach syntax highlighting sub-elements */
  code,
  code * {
    /* force monospace font */
    font-family: "Source Code Pro", "Courier New", monospace;
  }

  /* -------------------------------------------------- */
  /* quotes */
  /* -------------------------------------------------- */

  /* quoted text */
  blockquote {
    margin: 0;
    padding: 0;
    border-left: 4px solid #bdbdbd;
    padding-left: 16px;
    break-inside: avoid;
  }

  /* -------------------------------------------------- */
  /* banners */
  /* -------------------------------------------------- */

  /* info banners */
  .banner {
    box-sizing: border-box;
    display: block;
    position: relative;
    width: 100%;
    margin-top: 20px;
    margin-bottom: 20px;
    padding: 20px;
    text-align: center;
  }

  /* paragraph in banner */
  .banner > p {
    margin: 0;
  }

  /* -------------------------------------------------- */
  /* highlight colors */
  /* -------------------------------------------------- */

  .white {
    background: #ffffff;
  }
  .lightgrey {
    background: #eeeeee;
  }
  .grey {
    background: #757575;
  }
  .darkgrey {
    background: #424242;
  }
  .black {
    background: #000000;
  }
  .lightred {
    background: #ffcdd2;
  }
  .lightyellow {
    background: #ffecb3;
  }
  .lightgreen {
    background: #dcedc8;
  }
  .lightblue {
    background: #e3f2fd;
  }
  .lightpurple {
    background: #f3e5f5;
  }
  .red {
    background: #f44336;
  }
  .orange {
    background: #ff9800;
  }
  .yellow {
    background: #ffeb3b;
  }
  .green {
    background: #4caf50;
  }
  .blue {
    background: #2196f3;
  }
  .purple {
    background: #9c27b0;
  }
  .white,
  .lightgrey,
  .lightred,
  .lightyellow,
  .lightgreen,
  .lightblue,
  .lightpurple,
  .orange,
  .yellow,
  .white a,
  .lightgrey a,
  .lightred a,
  .lightyellow a,
  .lightgreen a,
  .lightblue a,
  .lightpurple a,
  .orange a,
  .yellow a {
    color: #000000;
  }
  .grey,
  .darkgrey,
  .black,
  .red,
  .green,
  .blue,
  .purple,
  .grey a,
  .darkgrey a,
  .black a,
  .red a,
  .green a,
  .blue a,
  .purple a {
    color: #ffffff;
  }

  /* -------------------------------------------------- */
  /* buttons */
  /* -------------------------------------------------- */

  /* class for styling links like buttons */
  .button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    margin: 5px;
    padding: 10px 20px;
    font-size: 0.75em;
    font-weight: 600;
    text-transform: uppercase;
    text-decoration: none;
    letter-spacing: 1px;
    background: none;
    color: #2196f3;
    border: solid 1px #bdbdbd;
    border-radius: 5px;
  }

  /* buttons when hovered */
  .button:hover:not([disabled]),
  .icon_button:hover:not([disabled]) {
    cursor: pointer;
    background: #f5f5f5;
  }

  /* buttons when disabled */
  .button[disabled],
  .icon_button[disabled] {
    opacity: 0.35;
    pointer-events: none;
  }

  /* class for styling buttons containg only single icon */
  .icon_button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    text-decoration: none;
    margin: 0;
    padding: 0;
    background: none;
    border-radius: 5px;
    border: none;
    width: 20px;
    height: 20px;
    min-width: 20px;
    min-height: 20px;
  }

  /* icon button inner svg image */
  .icon_button > svg {
    height: 16px;
  }

  /* -------------------------------------------------- */
  /* icons */
  /* -------------------------------------------------- */

  /* class for styling icons inline with text */
  .inline_icon {
    height: 1em;
    position: relative;
    top: 0.125em;
  }

  /* -------------------------------------------------- */
  /* references */
  /* -------------------------------------------------- */

  .csl-entry {
    margin-top: 15px;
    margin-bottom: 15px;
  }

  /* -------------------------------------------------- */
  /* print control */
  /* -------------------------------------------------- */

  @media print {
    @page {
      /* suggested printing margin */
      margin: 0.5in;
    }

    /* document and "page" elements */
    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    /* "page" element */
    body {
      font-size: 11pt !important;
      line-height: 1.35;
    }

    /* all headings */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      margin: 15px 0;
    }

    /* figures and tables */
    figure,
    table {
      font-size: 0.85em;
    }

    /* table cells */
    th,
    td {
      padding: 5px;
    }

    /* shrink font awesome icons */
    i.fas,
    i.fab,
    i.far,
    i.fal {
      transform: scale(0.85);
    }

    /* decrease banner margins */
    .banner {
      margin-top: 15px;
      margin-bottom: 15px;
      padding: 15px;
    }

    /* class for centering an element vertically on its own page */
    .page_center {
      margin: auto;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      vertical-align: middle;
      break-before: page;
      break-after: page;
    }

    /* always insert a page break before the element */
    .page_break_before {
      break-before: page;
    }

    /* always insert a page break after the element */
    .page_break_after {
      break-after: page;
    }

    /* avoid page break before the element */
    .page_break_before_avoid {
      break-before: avoid;
    }

    /* avoid page break after the element */
    .page_break_after_avoid {
      break-after: avoid;
    }

    /* avoid page break inside the element */
    .page_break_inside_avoid {
      break-inside: avoid;
    }
  }

  /* -------------------------------------------------- */
  /* override pandoc css quirks */
  /* -------------------------------------------------- */

  .sourceCode {
    /* prevent unsightly overflow in wide code blocks */
    overflow: auto !important;
  }

  div.sourceCode {
    /* prevent background fill on top-most code block  container */
    background: none !important;
  }

  .sourceCode * {
    /* force consistent line spacing */
    line-height: 1.5 !important;
  }

  div.sourceCode {
    /* style code block margins same as <pre> element */
    margin-top: 20px;
    margin-bottom: 20px;
  }

  /* -------------------------------------------------- */
  /* tablenos */
  /* -------------------------------------------------- */

  /* tablenos wrapper */
  .tablenos {
    width: 100%;
    margin: 20px 0;
  }

  .tablenos > table {
    /* move margins from table to table_wrapper to allow margin collapsing */
    margin: 0;
  }

  @media only screen {
    /* tablenos wrapper */
    .tablenos {
      /* show scrollbar on tables if necessary to prevent overflow */
      overflow-x: auto !important;
    }

    .tablenos th,
    .tablenos td {
      overflow-wrap: unset !important;
      word-break: unset !important;
    }

    /* table in wrapper */
    .tablenos table,
    .tablenos table * {
      /* don't break table words */
      overflow-wrap: normal !important;
    }
  }
</style>
<!-- 
    Plugin Core

    Functions needed for and shared across all first-party plugins.
-->

<script>
  // get element that is target of hash (from link element or url)
  function getHashTarget(link) {
    const hash = link ? link.hash : window.location.hash;
    const id = hash.slice(1);
    let target = document.querySelector(`[id="${id}"]`);
    if (!target) return;

    // if figure or table, modify target to get expected element
    if (id.indexOf("fig:") === 0) target = target.querySelector("figure");
    if (id.indexOf("tbl:") === 0) target = target.querySelector("table");

    return target;
  }

  // get position/dimensions of element or viewport
  function getRectInView(element) {
    let rect = {};
    rect.left = 0;
    rect.top = 0;
    rect.right = document.documentElement.clientWidth;
    rect.bottom = document.documentElement.clientHeight;
    let style = {};

    if (element instanceof HTMLElement) {
      rect = element.getBoundingClientRect();
      style = window.getComputedStyle(element);
    }

    const margin = {};
    margin.left = parseFloat(style.marginLeftWidth) || 0;
    margin.top = parseFloat(style.marginTopWidth) || 0;
    margin.right = parseFloat(style.marginRightWidth) || 0;
    margin.bottom = parseFloat(style.marginBottomWidth) || 0;

    const border = {};
    border.left = parseFloat(style.borderLeftWidth) || 0;
    border.top = parseFloat(style.borderTopWidth) || 0;
    border.right = parseFloat(style.borderRightWidth) || 0;
    border.bottom = parseFloat(style.borderBottomWidth) || 0;

    const newRect = {};
    newRect.left = rect.left + margin.left + border.left;
    newRect.top = rect.top + margin.top + border.top;
    newRect.right = rect.right + margin.right + border.right;
    newRect.bottom = rect.bottom + margin.bottom + border.bottom;
    newRect.width = newRect.right - newRect.left;
    newRect.height = newRect.bottom - newRect.top;

    return newRect;
  }

  // get position of element relative to page
  function getRectInPage(element) {
    const rect = getRectInView(element);
    const body = getRectInView(document.body);

    const newRect = {};
    newRect.left = rect.left - body.left;
    newRect.top = rect.top - body.top;
    newRect.right = rect.right - body.left;
    newRect.bottom = rect.bottom - body.top;
    newRect.width = rect.width;
    newRect.height = rect.height;

    return newRect;
  }

  // get closest element before specified element that matches query
  function firstBefore(element, query) {
    while (element && element !== document.body && !element.matches(query))
      element = element.previousElementSibling || element.parentNode;

    return element;
  }

  // check if element is part of collapsed heading
  function isCollapsed(element) {
    while (element && element !== document.body) {
      if (element.dataset.collapsed === "true") return true;
      element = element.parentNode;
    }
    return false;
  }

  // expand any collapsed parent containers of element if necessary
  function expandElement(element) {
    if (isCollapsed(element)) {
      // accordion plugin
      const heading = firstBefore(element, "h2");
      if (heading) heading.click();
      // details/summary HTML element
      const summary = firstBefore(element, "summary");
      if (summary) summary.click();
    }
  }

  // scroll to and focus element
  function goToElement(element, offset) {
    // expand accordion section if collapsed
    expandElement(element);
    const y =
      getRectInView(element).top -
      getRectInView(document.documentElement).top -
      (offset || 0);

    // trigger any function listening for "onscroll" event
    window.dispatchEvent(new Event("scroll"));
    window.scrollTo(0, y);
    document.activeElement.blur();
    element.focus();
  }

  // get list of elements after a start element up to element matching query
  function nextUntil(element, query, exclude) {
    const elements = [];
    while (((element = element.nextElementSibling), element)) {
      if (element.matches(query)) break;
      if (!element.matches(exclude)) elements.push(element);
    }
    return elements;
  }
</script>
<!--
  Accordion Plugin

  Allows sections of content under h2 headings to be collapsible.
-->

<script type="module">
  // whether to always start expanded ('false'), always start collapsed
  // ('true'), or start collapsed when screen small ('auto')
  const startCollapsed = "auto";

  // start script
  function start() {
    // run through each <h2> heading
    const headings = document.querySelectorAll("h2");
    for (const heading of headings) {
      addArrow(heading);

      // start expanded/collapsed based on option
      if (
        startCollapsed === "true" ||
        (startCollapsed === "auto" && isSmallScreen()) ||
        heading.dataset.collapsed === "true"
      )
        collapseHeading(heading);
      else expandElement(heading);
    }

    // attach hash change listener to window
    window.addEventListener("hashchange", onHashChange);
  }

  // when hash (eg manuscript.html#introduction) changes
  function onHashChange() {
    const target = getHashTarget();
    if (target) goToElement(target);
  }

  // add arrow to heading
  function addArrow(heading) {
    // add arrow button
    const arrow = document.createElement("button");
    arrow.innerHTML = document.querySelector(".icon_angle_down").innerHTML;
    arrow.classList.add("icon_button", "accordion_arrow");
    heading.insertBefore(arrow, heading.firstChild);

    // attach click listener to heading and button
    heading.addEventListener("click", onHeadingClick);
    arrow.addEventListener("click", onArrowClick);
  }

  // determine if on mobile-like device with small screen
  function isSmallScreen() {
    return Math.min(window.innerWidth, window.innerHeight) < 480;
  }

  // when <h2> heading is clicked
  function onHeadingClick(event) {
    // only collapse if <h2> itself is target of click (eg, user did
    // not click on anchor within <h2>)
    if (event.target === this) toggleCollapse(this);
  }

  // when arrow button is clicked
  function onArrowClick() {
    toggleCollapse(this.parentNode);
  }

  // collapse section if expanded, expand if collapsed
  function toggleCollapse(heading) {
    if (heading.dataset.collapsed === "false") collapseHeading(heading);
    else expandElement(heading);
  }

  // elements to exclude from collapse, such as table of contents panel,
  // hypothesis panel, etc
  const exclude = "#toc_panel, div.annotator-frame, #lightbox_overlay";

  // collapse section
  function collapseHeading(heading) {
    heading.setAttribute("data-collapsed", "true");
    const children = getChildren(heading);
    for (const child of children) child.setAttribute("data-collapsed", "true");
  }

  // expand section
  function expandElement(heading) {
    heading.setAttribute("data-collapsed", "false");
    const children = getChildren(heading);
    for (const child of children) child.setAttribute("data-collapsed", "false");
  }

  // get list of elements between this <h2> and next <h2> or <h1>
  // ("children" of the <h2> section)
  function getChildren(heading) {
    return nextUntil(heading, "h2, h1", exclude);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- angle down icon -->

<template class="icon_angle_down">
  <!-- modified from: https://fontawesome.com/icons/angle-down -->
  <svg width="16" height="16" viewBox="0 0 448 512">
    <path
      fill="currentColor"
      d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* accordion arrow button */
    .accordion_arrow {
      margin-right: 10px;
    }

    /* arrow icon when <h2> data-collapsed attribute true */
    h2[data-collapsed="true"] > .accordion_arrow > svg {
      transform: rotate(-90deg);
    }

    /* all elements (except <h2>'s) when data-collapsed attribute true */
    *:not(h2)[data-collapsed="true"] {
      display: none;
    }

    /* accordion arrow button when hovered and <h2>'s when hovered */
    .accordion_arrow:hover,
    h2[data-collapsed="true"]:hover,
    h2[data-collapsed="false"]:hover {
      cursor: pointer;
    }
  }

  /* always hide accordion arrow button on print */
  @media only print {
    .accordion_arrow {
      display: none;
    }
  }
</style>
<!--
  Anchors Plugin

  Adds an anchor next to each of a certain type of element that provides a
  human-readable url to that specific item/position in the document (e.g.
  "manuscript.html#abstract"). It also makes it such that scrolling out of view
  of a target removes its identifier from the url.
-->

<script type="module">
  // which types of elements to add anchors next to, in "document.querySelector"
  // format
  const typesQuery =
    'h1, h2, h3, div[id^="fig:"], div[id^="tbl:"], span[id^="eq:"]';

  // start script
  function start() {
    // add anchor to each element of specified types
    const elements = document.querySelectorAll(typesQuery);
    for (const element of elements) addAnchor(element);

    // attach scroll listener to window
    window.addEventListener("scroll", onScroll);
  }

  // when window is scrolled
  function onScroll() {
    // if url has hash and user has scrolled out of view of hash
    // target, remove hash from url
    const tolerance = 100;
    const target = getHashTarget();
    if (target) {
      if (
        target.getBoundingClientRect().top > window.innerHeight + tolerance ||
        target.getBoundingClientRect().bottom < 0 - tolerance
      )
        history.pushState(null, null, " ");
    }
  }

  // add anchor to element
  function addAnchor(element) {
    let addTo; // element to add anchor button to

    // if figure or table, modify withId and addTo to get expected
    // elements
    if (element.id.indexOf("fig:") === 0) {
      addTo = element.querySelector("figcaption");
    } else if (element.id.indexOf("tbl:") === 0) {
      addTo = element.querySelector("caption");
    } else if (element.id.indexOf("eq:") === 0) {
      addTo = element.querySelector(".eqnos-number");
    }

    addTo = addTo || element;
    const id = element.id || null;

    // do not add anchor if element doesn't have assigned id.
    // id is generated by pandoc and is assumed to be unique and
    // human-readable
    if (!id) return;

    // create anchor button
    const anchor = document.createElement("a");
    anchor.innerHTML = document.querySelector(".icon_link").innerHTML;
    anchor.title = "Link to this part of the document";
    anchor.classList.add("icon_button", "anchor");
    anchor.dataset.ignore = "true";
    anchor.href = "#" + id;
    addTo.appendChild(anchor);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- link icon -->

<template class="icon_link">
  <!-- modified from: https://fontawesome.com/icons/link -->
  <svg width="16" height="16" viewBox="0 0 512 512">
    <path
      fill="currentColor"
      d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* anchor button */
    .anchor {
      opacity: 0;
      margin-left: 5px;
    }

    /* anchor buttons within <h2>'s */
    h2 .anchor {
      margin-left: 10px;
    }

    /* anchor buttons when hovered/focused and anything containing an anchor button when hovered */
    *:hover > .anchor,
    .anchor:hover,
    .anchor:focus {
      opacity: 1;
    }

    /* anchor button when hovered */
    .anchor:hover {
      cursor: pointer;
    }
  }

  /* always show anchor button on devices with no mouse/hover ability */
  @media (hover: none) {
    .anchor {
      opacity: 1;
    }
  }

  /* always hide anchor button on print */
  @media only print {
    .anchor {
      display: none;
    }
  }
</style>
<!-- 
    Attributes Plugin

    Allows arbitrary HTML attributes to be attached to (almost) any element.
    Place an HTML comment inside or next to the desired element with the content:
    $attribute="value"
-->

<script type="module">
  // start script
  function start() {
    // get list of comments in document
    const comments = findComments();

    for (const comment of comments)
      if (comment.parentElement)
        addAttributes(comment.parentElement, comment.nodeValue.trim());
  }

  // add html attributes to specified element based on string of
  // html attributes and values
  function addAttributes(element, text) {
    // regex's for finding attribute/value pairs in the format of
    // attribute="value" or attribute='value
    const regex2 = /\$([a-zA-Z\-]+)?=\"(.+?)\"/;
    const regex1 = /\$([a-zA-Z\-]+)?=\'(.+?)\'/;

    // loop through attribute/value pairs
    let match;
    while ((match = text.match(regex2) || text.match(regex1))) {
      // get attribute and value from regex capture groups
      let attribute = match[1];
      let value = match[2];

      // remove from string
      text = text.substring(match.index + match[0].length);

      if (!attribute || !value) break;

      // set attribute of parent element
      try {
        element.setAttribute(attribute, value);
      } catch (error) {
        console.log(error);
      }

      // special case for colspan
      if (attribute === "colspan") removeTableCells(element, value);
      if (attribute === "removenext") removeTableCells(element, value);
    }
  }

  // get list of comment elements in document
  function findComments() {
    const comments = [];

    // iterate over comment nodes in document
    function acceptNode(node) {
      return NodeFilter.FILTER_ACCEPT;
    }
    const iterator = document.createNodeIterator(
      document.body,
      NodeFilter.SHOW_COMMENT,
      acceptNode
    );
    let node;
    while ((node = iterator.nextNode())) comments.push(node);

    return comments;
  }

  // remove certain number of cells after specified cell
  function removeTableCells(cell, number) {
    number = parseInt(number);
    if (!number) return;

    // remove elements
    for (; number > 1; number--) {
      if (cell.nextElementSibling) cell.nextElementSibling.remove();
    }
  }

  // start script on DOMContentLoaded instead of load to ensure this plugins
  // runs before other plugins
  window.addEventListener("DOMContentLoaded", start);
</script>
<!--
  Jump to First Plugin

  Adds a button next to each reference entry, figure, and table that jumps the
  page to the first occurrence of a link to that item in the manuscript.
-->

<script type="module">
  // whether to add buttons next to reference entries
  const references = "true";
  // whether to add buttons next to figures
  const figures = "true";
  // whether to add buttons next to tables
  const tables = "true";

  // start script
  function start() {
    if (references !== "false")
      makeButtons(`div[id^="ref-"]`, ".csl-left-margin", "reference");
    if (figures !== "false")
      makeButtons(`div[id^="fig:"]`, "figcaption", "figure");
    if (tables !== "false") makeButtons(`div[id^="tbl:"]`, "caption", "table");
  }

  // when jump button clicked
  function onButtonClick() {
    const first = getFirstOccurrence(this.dataset.id);
    if (!first) return;

    // update url hash so navigating "back" in history will return user to button
    window.location.hash = this.dataset.id;
    // scroll to link
    const timeout = function () {
      goToElement(first, window.innerHeight * 0.5);
    };
    window.setTimeout(timeout, 0);
  }

  // get first occurrence of link to item in document
  function getFirstOccurrence(id) {
    let query = "a";
    query += '[href="#' + id + '"]';
    // exclude buttons, anchor links, toc links, etc
    query += ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    return document.querySelector(query);
  }

  // add button next to each reference entry, figure, or table
  function makeButtons(query, containerQuery, subject) {
    const elements = document.querySelectorAll(query);
    for (const element of elements) {
      const id = element.id;
      const buttonContainer = element.querySelector(containerQuery);
      const first = getFirstOccurrence(id);

      // if can't find link to reference or place to put button, ignore
      if (!first || !buttonContainer) continue;

      // make jump button
      let button = document.createElement("button");
      button.classList.add("icon_button", "jump_arrow");
      button.title = `Jump to the first occurrence of this ${subject} in the document`;
      const icon = document.querySelector(".icon_angle_double_up");
      button.innerHTML = icon.innerHTML;
      button.dataset.id = id;
      button.dataset.ignore = "true";
      button.addEventListener("click", onButtonClick);
      buttonContainer.prepend(button);
    }
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- angle double up icon -->

<template class="icon_angle_double_up">
  <!-- modified from: https://fontawesome.com/icons/angle-double-up -->
  <svg width="16" height="16" viewBox="0 0 320 512">
    <path
      fill="currentColor"
      d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* jump button */
    .jump_arrow {
      position: relative;
      top: 0.125em;
      margin-right: 5px;
    }
  }

  /* always hide jump button on print */
  @media only print {
    .jump_arrow {
      display: none;
    }
  }
</style>
<!-- 
    Lightbox Plugin

    Makes it such that when a user clicks on an image, the image fills the
    screen and the user can pan/drag/zoom the image and navigate between other
    images in the document.
-->

<script type="module">
  // list of possible zoom/scale factors
  const zooms =
    "0.1, 0.25, 0.333333, 0.5, 0.666666, 0.75, 1, 1.25, 1.5, 1.75, 2, 2.5, 3, 3.5, 4, 5, 6, 7, 8";
  // whether to fit image to view ('fit'), display at 100% and shrink if
  // necessary ('shrink'), or always display at 100% ('100')
  const defaultZoom = "fit";
  // whether to zoom in/out toward center of view ('true') or mouse ('false')
  const centerZoom = "false";

  // start script
  function start() {
    // run through each <img> element
    const imgs = document.querySelectorAll("figure > img");
    let count = 1;
    for (const img of imgs) {
      img.classList.add("lightbox_document_img");
      img.dataset.number = count;
      img.dataset.total = imgs.length;
      img.addEventListener("click", openLightbox);
      count++;
    }

    // attach mouse and key listeners to window
    window.addEventListener("mousemove", onWindowMouseMove);
    window.addEventListener("keyup", onKeyUp);
  }

  // when mouse is moved anywhere in window
  function onWindowMouseMove(event) {
    window.mouseX = event.clientX;
    window.mouseY = event.clientY;
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    switch (event.key) {
      // trigger click of prev button
      case "ArrowLeft":
        const prevButton = document.getElementById("lightbox_prev_button");
        if (prevButton) prevButton.click();
        break;
      // trigger click of next button
      case "ArrowRight":
        const nextButton = document.getElementById("lightbox_next_button");
        if (nextButton) nextButton.click();
        break;
      // close on esc
      case "Escape":
        closeLightbox();
        break;
    }
  }

  // open lightbox
  function openLightbox() {
    const lightbox = makeLightbox(this);
    if (!lightbox) return;

    blurBody(lightbox);
    document.body.appendChild(lightbox);
  }

  // make lightbox
  function makeLightbox(img) {
    // delete lightbox if it exists, start fresh
    closeLightbox();

    // create screen overlay containing lightbox
    const overlay = document.createElement("div");
    overlay.id = "lightbox_overlay";

    // create image info boxes
    const numberInfo = document.createElement("div");
    const zoomInfo = document.createElement("div");
    numberInfo.id = "lightbox_number_info";
    zoomInfo.id = "lightbox_zoom_info";

    // create container for image
    const imageContainer = document.createElement("div");
    imageContainer.id = "lightbox_image_container";
    const lightboxImg = makeLightboxImg(
      img,
      imageContainer,
      numberInfo,
      zoomInfo
    );
    imageContainer.appendChild(lightboxImg);

    // create bottom container for caption and navigation buttons
    const bottomContainer = document.createElement("div");
    bottomContainer.id = "lightbox_bottom_container";
    const caption = makeCaption(img);
    const prevButton = makePrevButton(img);
    const nextButton = makeNextButton(img);
    bottomContainer.appendChild(prevButton);
    bottomContainer.appendChild(caption);
    bottomContainer.appendChild(nextButton);

    // attach top middle and bottom to overlay
    overlay.appendChild(numberInfo);
    overlay.appendChild(zoomInfo);
    overlay.appendChild(imageContainer);
    overlay.appendChild(bottomContainer);

    return overlay;
  }

  // make <img> object that is intuitively draggable and zoomable
  function makeLightboxImg(sourceImg, container, numberInfoBox, zoomInfoBox) {
    // create copy of source <img>
    const img = sourceImg.cloneNode(true);
    img.classList.remove("lightbox_document_img");
    img.removeAttribute("id");
    img.removeAttribute("width");
    img.removeAttribute("height");
    img.style.position = "unset";
    img.style.margin = "0";
    img.style.padding = "0";
    img.style.width = "";
    img.style.height = "";
    img.style.minWidth = "";
    img.style.minHeight = "";
    img.style.maxWidth = "";
    img.style.maxHeight = "";
    img.id = "lightbox_img";

    // build sorted list of zoomSteps
    const zoomSteps = zooms.split(/[^0-9.]/).map((step) => parseFloat(step));
    zoomSteps.sort((a, b) => a - b);

    // <img> object property variables
    let zoom = 1;
    let translateX = 0;
    let translateY = 0;
    let clickMouseX = undefined;
    let clickMouseY = undefined;
    let clickTranslateX = undefined;
    let clickTranslateY = undefined;

    updateNumberInfo();

    // update image numbers displayed in info box
    function updateNumberInfo() {
      numberInfoBox.innerHTML =
        sourceImg.dataset.number + " of " + sourceImg.dataset.total;
    }

    // update zoom displayed in info box
    function updateZoomInfo() {
      let zoomInfo = zoom * 100;
      if (!Number.isInteger(zoomInfo)) zoomInfo = zoomInfo.toFixed(2);
      zoomInfoBox.innerHTML = zoomInfo + "%";
    }

    // move to closest zoom step above current zoom
    const zoomIn = function () {
      for (const zoomStep of zoomSteps) {
        if (zoomStep > zoom) {
          zoom = zoomStep;
          break;
        }
      }
      updateTransform();
    };

    // move to closest zoom step above current zoom
    const zoomOut = function () {
      zoomSteps.reverse();
      for (const zoomStep of zoomSteps) {
        if (zoomStep < zoom) {
          zoom = zoomStep;
          break;
        }
      }
      zoomSteps.reverse();

      updateTransform();
    };

    // update display of <img> based on scale/translate properties
    const updateTransform = function () {
      // set transform
      img.style.transform =
        "translate(" +
        (translateX || 0) +
        "px," +
        (translateY || 0) +
        "px) scale(" +
        (zoom || 1) +
        ")";

      // get new width/height after scale
      const rect = img.getBoundingClientRect();
      // limit translate
      translateX = Math.max(translateX, -rect.width / 2);
      translateX = Math.min(translateX, rect.width / 2);
      translateY = Math.max(translateY, -rect.height / 2);
      translateY = Math.min(translateY, rect.height / 2);

      // set transform
      img.style.transform =
        "translate(" +
        (translateX || 0) +
        "px," +
        (translateY || 0) +
        "px) scale(" +
        (zoom || 1) +
        ")";

      updateZoomInfo();
    };

    // fit <img> to container
    const fit = function () {
      // no x/y offset, 100% zoom by default
      translateX = 0;
      translateY = 0;
      zoom = 1;

      // widths of <img> and container
      const imgWidth = img.naturalWidth;
      const imgHeight = img.naturalHeight;
      const containerWidth = parseFloat(
        window.getComputedStyle(container).width
      );
      const containerHeight = parseFloat(
        window.getComputedStyle(container).height
      );

      // how much zooming is needed to fit <img> to container
      const xRatio = imgWidth / containerWidth;
      const yRatio = imgHeight / containerHeight;
      const maxRatio = Math.max(xRatio, yRatio);
      const newZoom = 1 / maxRatio;

      // fit <img> to container according to option
      if (defaultZoom === "shrink") {
        if (maxRatio > 1) zoom = newZoom;
      } else if (defaultZoom === "fit") zoom = newZoom;

      updateTransform();
    };

    // when mouse wheel is rolled anywhere in container
    const onContainerWheel = function (event) {
      if (!event) return;

      // let ctrl + mouse wheel to zoom behave as normal
      if (event.ctrlKey) return;

      // prevent normal scroll behavior
      event.preventDefault();
      event.stopPropagation();

      // point around which to scale img
      const viewRect = container.getBoundingClientRect();
      const viewX = (viewRect.left + viewRect.right) / 2;
      const viewY = (viewRect.top + viewRect.bottom) / 2;
      const originX = centerZoom === "true" ? viewX : mouseX;
      const originY = centerZoom === "true" ? viewY : mouseY;

      // get point on image under origin
      const oldRect = img.getBoundingClientRect();
      const oldPercentX = (originX - oldRect.left) / oldRect.width;
      const oldPercentY = (originY - oldRect.top) / oldRect.height;

      // increment/decrement zoom
      if (event.deltaY < 0) zoomIn();
      if (event.deltaY > 0) zoomOut();

      // get offset between previous image point and origin
      const newRect = img.getBoundingClientRect();
      const offsetX = originX - (newRect.left + newRect.width * oldPercentX);
      const offsetY = originY - (newRect.top + newRect.height * oldPercentY);

      // translate image to keep image point under origin
      translateX += offsetX;
      translateY += offsetY;

      // perform translate
      updateTransform();
    };

    // when container is clicked
    function onContainerClick(event) {
      // if container itself is target of click, and not other
      // element above it
      if (event.target === this) closeLightbox();
    }

    // when mouse button is pressed on image
    const onImageMouseDown = function (event) {
      // store original mouse position relative to image
      clickMouseX = window.mouseX;
      clickMouseY = window.mouseY;
      clickTranslateX = translateX;
      clickTranslateY = translateY;
      event.stopPropagation();
      event.preventDefault();
    };

    // when mouse button is released anywhere in window
    const onWindowMouseUp = function (event) {
      // reset original mouse position
      clickMouseX = undefined;
      clickMouseY = undefined;
      clickTranslateX = undefined;
      clickTranslateY = undefined;

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("mouseup", onWindowMouseUp);
    };

    // when mouse is moved anywhere in window
    const onWindowMouseMove = function (event) {
      if (
        clickMouseX === undefined ||
        clickMouseY === undefined ||
        clickTranslateX === undefined ||
        clickTranslateY === undefined
      )
        return;

      // offset image based on original and current mouse position
      translateX = clickTranslateX + window.mouseX - clickMouseX;
      translateY = clickTranslateY + window.mouseY - clickMouseY;
      updateTransform();
      event.preventDefault();

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("mousemove", onWindowMouseMove);
    };

    // when window is resized
    const onWindowResize = function (event) {
      fit();

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("resize", onWindowResize);
    };

    // attach the necessary event listeners
    img.addEventListener("dblclick", fit);
    img.addEventListener("mousedown", onImageMouseDown);
    container.addEventListener("wheel", onContainerWheel);
    container.addEventListener("mousedown", onContainerClick);
    container.addEventListener("touchstart", onContainerClick);
    window.addEventListener("mouseup", onWindowMouseUp);
    window.addEventListener("mousemove", onWindowMouseMove);
    window.addEventListener("resize", onWindowResize);

    // run fit() after lightbox atttached to document and <img> Loaded
    // so needed container and img dimensions available
    img.addEventListener("load", fit);

    return img;
  }

  // make caption
  function makeCaption(img) {
    const caption = document.createElement("div");
    caption.id = "lightbox_caption";
    const captionSource = img.nextElementSibling;
    if (captionSource.tagName.toLowerCase() === "figcaption") {
      const captionCopy = makeCopy(captionSource);
      caption.innerHTML = captionCopy.innerHTML;
    }

    caption.addEventListener("touchstart", function (event) {
      event.stopPropagation();
    });

    return caption;
  }

  // make carbon copy of html dom element
  function makeCopy(source) {
    const sourceCopy = source.cloneNode(true);

    // delete elements marked with ignore (eg anchor and jump buttons)
    const deleteFromCopy = sourceCopy.querySelectorAll('[data-ignore="true"]');
    for (const element of deleteFromCopy) element.remove();

    // delete certain element attributes
    const attributes = [
      "id",
      "data-collapsed",
      "data-selected",
      "data-highlighted",
      "data-glow",
    ];
    for (const attribute of attributes) {
      sourceCopy.removeAttribute(attribute);
      const elements = sourceCopy.querySelectorAll("[" + attribute + "]");
      for (const element of elements) element.removeAttribute(attribute);
    }

    return sourceCopy;
  }

  // make button to jump to previous image in document
  function makePrevButton(img) {
    const prevButton = document.createElement("button");
    prevButton.id = "lightbox_prev_button";
    prevButton.title = "Jump to the previous image in the document [←]";
    prevButton.classList.add("icon_button", "lightbox_button");
    prevButton.innerHTML = document.querySelector(".icon_caret_left").innerHTML;

    // attach click listeners to button
    prevButton.addEventListener("click", function () {
      getPrevImg(img).click();
    });

    return prevButton;
  }

  // make button to jump to next image in document
  function makeNextButton(img) {
    const nextButton = document.createElement("button");
    nextButton.id = "lightbox_next_button";
    nextButton.title = "Jump to the next image in the document [→]";
    nextButton.classList.add("icon_button", "lightbox_button");
    nextButton.innerHTML = document.querySelector(
      ".icon_caret_right"
    ).innerHTML;

    // attach click listeners to button
    nextButton.addEventListener("click", function () {
      getNextImg(img).click();
    });

    return nextButton;
  }

  // get previous image in document
  function getPrevImg(img) {
    const imgs = document.querySelectorAll(".lightbox_document_img");

    // find index of provided img
    let index;
    for (index = 0; index < imgs.length; index++) {
      if (imgs[index] === img) break;
    }

    // wrap index to other side if < 1
    if (index - 1 >= 0) index--;
    else index = imgs.length - 1;
    return imgs[index];
  }

  // get next image in document
  function getNextImg(img) {
    const imgs = document.querySelectorAll(".lightbox_document_img");

    // find index of provided img
    let index;
    for (index = 0; index < imgs.length; index++) {
      if (imgs[index] === img) break;
    }

    // wrap index to other side if > total
    if (index + 1 <= imgs.length - 1) index++;
    else index = 0;
    return imgs[index];
  }

  // close lightbox
  function closeLightbox() {
    focusBody();

    const lightbox = document.getElementById("lightbox_overlay");
    if (lightbox) lightbox.remove();
  }

  // make all elements behind lightbox non-focusable
  function blurBody(overlay) {
    const all = document.querySelectorAll("*");
    for (const element of all) element.tabIndex = -1;
    document.body.classList.add("body_no_scroll");
  }

  // make all elements focusable again
  function focusBody() {
    const all = document.querySelectorAll("*");
    for (const element of all) element.removeAttribute("tabIndex");
    document.body.classList.remove("body_no_scroll");
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
  <!-- modified from: https://fontawesome.com/icons/caret-left -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
    ></path>
  </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
  <!-- modified from: https://fontawesome.com/icons/caret-right -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* regular <img> in document when hovered */
    img.lightbox_document_img:hover {
      cursor: pointer;
    }

    .body_no_scroll {
      overflow: hidden !important;
    }

    /* screen overlay */
    #lightbox_overlay {
      display: flex;
      flex-direction: column;
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.75);
      z-index: 3;
    }

    /* middle area containing lightbox image */
    #lightbox_image_container {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      position: relative;
      padding: 20px;
    }

    /* bottom area containing caption */
    #lightbox_bottom_container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100px;
      min-height: 100px;
      max-height: 100px;
      background: rgba(0, 0, 0, 0.5);
    }

    /* image number info text box */
    #lightbox_number_info {
      position: absolute;
      color: #ffffff;
      font-weight: 600;
      left: 2px;
      top: 0;
      z-index: 4;
    }

    /* zoom info text box */
    #lightbox_zoom_info {
      position: absolute;
      color: #ffffff;
      font-weight: 600;
      right: 2px;
      top: 0;
      z-index: 4;
    }

    /* copy of image caption */
    #lightbox_caption {
      box-sizing: border-box;
      display: inline-block;
      width: 100%;
      max-height: 100%;
      padding: 10px 0;
      text-align: center;
      overflow-y: auto;
      color: #ffffff;
    }

    /* navigation previous/next button */
    .lightbox_button {
      width: 100px;
      height: 100%;
      min-width: 100px;
      min-height: 100%;
      color: #ffffff;
    }

    /* navigation previous/next button when hovered */
    .lightbox_button:hover {
      background: none !important;
    }

    /* navigation button icon */
    .lightbox_button > svg {
      height: 25px;
    }

    /* figure auto-number */
    #lightbox_caption > span:first-of-type {
      font-weight: bold;
      margin-right: 5px;
    }

    /* lightbox image when hovered */
    #lightbox_img:hover {
      cursor: grab;
    }

    /* lightbox image when grabbed */
    #lightbox_img:active {
      cursor: grabbing;
    }
  }

  /* when on screen < 480px wide */
  @media only screen and (max-width: 480px) {
    /* make navigation buttons skinnier on small screens to make more room for caption text */
    .lightbox_button {
      width: 50px;
      min-width: 50px;
    }
  }

  /* always hide lightbox on print */
  @media only print {
    #lightbox_overlay {
      display: none;
    }
  }
</style>
<!-- 
  Link Highlight Plugin

  Makes it such that when a user hovers or focuses a link, other links that have
  the same target will be highlighted. It also makes it such that when clicking
  a link, the target of the link (eg reference, figure, table) is briefly
  highlighted.
-->

<script type="module">
  // whether to also highlight links that go to external urls
  const externalLinks = "false";
  // whether user must click off to unhighlight instead of just
  // un-hovering
  const clickUnhighlight = "false";
  // whether to also highlight links that are unique
  const highlightUnique = "true";

  // start script
  function start() {
    const links = getLinks();
    for (const link of links) {
      // attach mouse and focus listeners to link
      link.addEventListener("mouseenter", onLinkFocus);
      link.addEventListener("focus", onLinkFocus);
      link.addEventListener("mouseleave", onLinkUnhover);
    }

    // attach click and hash change listeners to window
    window.addEventListener("click", onClick);
    window.addEventListener("touchstart", onClick);
    window.addEventListener("hashchange", onHashChange);

    // run hash change on window load in case user has navigated
    // directly to hash
    onHashChange();
  }

  // when link is focused (tabbed to) or hovered
  function onLinkFocus() {
    highlight(this);
  }

  // when link is unhovered
  function onLinkUnhover() {
    if (clickUnhighlight !== "true") unhighlightAll();
  }

  // when the mouse is clicked anywhere in window
  function onClick(event) {
    unhighlightAll();
  }

  // when hash (eg manuscript.html#introduction) changes
  function onHashChange() {
    const target = getHashTarget();
    if (target) glowElement(target);
  }

  // start glow sequence on an element
  function glowElement(element) {
    const startGlow = function () {
      onGlowEnd();
      element.dataset.glow = "true";
      element.addEventListener("animationend", onGlowEnd);
    };
    const onGlowEnd = function () {
      element.removeAttribute("data-glow");
      element.removeEventListener("animationend", onGlowEnd);
    };
    startGlow();
  }

  // highlight link and all others with same target
  function highlight(link) {
    // force unhighlight all to start fresh
    unhighlightAll();

    // get links with same target
    if (!link) return;
    const sameLinks = getSameLinks(link);

    // if link unique and option is off, exit and don't highlight
    if (sameLinks.length <= 1 && highlightUnique !== "true") return;

    // highlight all same links, and "select" (special highlight) this
    // one
    for (const sameLink of sameLinks) {
      if (sameLink === link) sameLink.setAttribute("data-selected", "true");
      else sameLink.setAttribute("data-highlighted", "true");
    }
  }

  // unhighlight all links
  function unhighlightAll() {
    const links = getLinks();
    for (const link of links) {
      link.setAttribute("data-selected", "false");
      link.setAttribute("data-highlighted", "false");
    }
  }

  // get links with same target
  function getSameLinks(link) {
    const results = [];
    const links = getLinks();
    for (const otherLink of links) {
      if (otherLink.getAttribute("href") === link.getAttribute("href"))
        results.push(otherLink);
    }
    return results;
  }

  // get all links of types we wish to handle
  function getLinks() {
    let query = "a";
    if (externalLinks !== "true") query += '[href^="#"]';
    // exclude buttons, anchor links, toc links, etc
    query += ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    return document.querySelectorAll(query);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<style>
  @media only screen {
    /* anything with data-highlighted attribute true */
    [data-highlighted="true"] {
      background: #ffeb3b;
    }

    /* anything with data-selected attribute true */
    [data-selected="true"] {
      background: #ff8a65 !important;
    }

    /* animation definition for glow */
    @keyframes highlight_glow {
      0% {
        background: none;
      }
      10% {
        background: #bbdefb;
      }
      100% {
        background: none;
      }
    }

    /* anything with data-glow attribute true */
    [data-glow="true"] {
      animation: highlight_glow 2s;
    }
  }
</style>
<!--
  Table of Contents Plugin

  Provides a "table of contents" (toc) panel on the side of the document that
  allows the user to conveniently navigate between sections of the document.
-->

<script type="module">
  // which types of elements to add links for, in "document.querySelector" format
  const typesQuery = "h1, h2, h3";
  // whether toc starts open. use 'true' or 'false', or 'auto' to
  // use 'true' behavior when screen wide enough and 'false' when not
  const startOpen = "false";
  // whether toc closes when clicking on toc link. use 'true' or
  // 'false', or 'auto' to use 'false' behavior when screen wide
  // enough and 'true' when not
  const clickClose = "auto";
  // if list item is more than this many characters, text will be
  // truncated
  const charLimit = "50";
  // whether or not to show bullets next to each toc item
  const bullets = "false";

  // start script
  function start() {
    // make toc panel and populate with entries (links to document
    // sections)
    const panel = makePanel();
    if (!panel) return;
    makeEntries(panel);
    // attach panel to document after making entries, so 'toc' heading
    // in panel isn't included in toc
    document.body.insertBefore(panel, document.body.firstChild);

    // initial panel state
    if (startOpen === "true" || (startOpen === "auto" && !isSmallScreen()))
      openPanel();
    else closePanel();

    // attach click, scroll, and hash change listeners to window
    window.addEventListener("click", onClick);
    window.addEventListener("scroll", onScroll);
    window.addEventListener("hashchange", onScroll);
    window.addEventListener("keyup", onKeyUp);
    onScroll();

    // add class to push document body down out of way of toc button
    document.body.classList.add("toc_body_nudge");
  }

  // determine if screen wide enough to fit toc panel
  function isSmallScreen() {
    // in default theme:
    // 816px = 8.5in = width of "page" (<body>) element
    // 260px = min width of toc panel (*2 for both sides of <body>)
    return window.innerWidth < 816 + 260 * 2;
  }

  // when mouse is clicked anywhere in window
  function onClick() {
    if (isSmallScreen()) closePanel();
  }

  // when window is scrolled or hash changed
  function onScroll() {
    highlightViewed();
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    // close on esc
    if (event.key === "Escape") closePanel();
  }

  // find entry of currently viewed document section in toc and highlight
  function highlightViewed() {
    const firstId = getFirstInView(typesQuery);

    // get toc entries (links), unhighlight all, then highlight viewed
    const list = document.getElementById("toc_list");
    if (!firstId || !list) return;
    const links = list.querySelectorAll("a");
    for (const link of links) link.dataset.viewing = "false";
    const link = list.querySelector('a[href="#' + firstId + '"]');
    if (!link) return;
    link.dataset.viewing = "true";
  }

  // get first or previous toc listed element in top half of view
  function getFirstInView(query) {
    // get all elements matching query and with id
    const elements = document.querySelectorAll(query);
    const elementsWithIds = [];
    for (const element of elements) {
      if (element.id) elementsWithIds.push(element);
    }

    // get first or previous element in top half of view
    for (let i = 0; i < elementsWithIds.length; i++) {
      const element = elementsWithIds[i];
      const prevElement = elementsWithIds[Math.max(0, i - 1)];
      if (element.getBoundingClientRect().top >= 0) {
        if (element.getBoundingClientRect().top < window.innerHeight / 2)
          return element.id;
        else return prevElement.id;
      }
    }
  }

  // make panel
  function makePanel() {
    // create panel
    const panel = document.createElement("div");
    panel.id = "toc_panel";
    if (bullets === "true") panel.dataset.bullets = "true";

    // create header
    const header = document.createElement("div");
    header.id = "toc_header";

    // create toc button
    const button = document.createElement("button");
    button.id = "toc_button";
    button.innerHTML = document.querySelector(".icon_th_list").innerHTML;
    button.title = "Table of Contents";
    button.classList.add("icon_button");

    // create header text
    const text = document.createElement("h4");
    text.innerHTML = "Table of Contents";

    // create container for toc list
    const list = document.createElement("div");
    list.id = "toc_list";

    // attach click listeners
    panel.addEventListener("click", onPanelClick);
    header.addEventListener("click", onHeaderClick);
    button.addEventListener("click", onButtonClick);

    // attach elements
    header.appendChild(button);
    header.appendChild(text);
    panel.appendChild(header);
    panel.appendChild(list);

    return panel;
  }

  // create toc entries (links) to each element of the specified types
  function makeEntries(panel) {
    const elements = document.querySelectorAll(typesQuery);
    for (const element of elements) {
      // do not add link if element doesn't have assigned id
      if (!element.id) continue;

      // create link/list item
      const link = document.createElement("a");
      link.classList.add("toc_link");
      switch (element.tagName.toLowerCase()) {
        case "h1":
          link.dataset.level = "1";
          break;
        case "h2":
          link.dataset.level = "2";
          break;
        case "h3":
          link.dataset.level = "3";
          break;
        case "h4":
          link.dataset.level = "4";
          break;
      }
      link.title = element.innerText;
      let text = element.innerText;
      if (text.length > charLimit) text = text.slice(0, charLimit) + "...";
      link.innerHTML = text;
      link.href = "#" + element.id;
      link.addEventListener("click", onLinkClick);

      // attach link
      panel.querySelector("#toc_list").appendChild(link);
    }
  }

  // when panel is clicked
  function onPanelClick(event) {
    // stop click from propagating to window/document and closing panel
    event.stopPropagation();
  }

  // when header itself is clicked
  function onHeaderClick(event) {
    togglePanel();
  }

  // when button is clicked
  function onButtonClick(event) {
    togglePanel();
    // stop header underneath button from also being clicked
    event.stopPropagation();
  }

  // when link is clicked
  function onLinkClick(event) {
    if (clickClose === "true" || (clickClose === "auto" && isSmallScreen()))
      closePanel();
    else openPanel();
  }

  // open panel if closed, close if opened
  function togglePanel() {
    const panel = document.getElementById("toc_panel");
    if (!panel) return;

    if (panel.dataset.open === "true") closePanel();
    else openPanel();
  }

  // open panel
  function openPanel() {
    const panel = document.getElementById("toc_panel");
    if (panel) panel.dataset.open = "true";
  }

  // close panel
  function closePanel() {
    const panel = document.getElementById("toc_panel");
    if (panel) panel.dataset.open = "false";
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- th list icon -->

<template class="icon_th_list">
  <!-- modified from: https://fontawesome.com/icons/th-list -->
  <svg width="16" height="16" viewBox="0 0 512 512" tabindex="-1">
    <path
      fill="currentColor"
      d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"
      tabindex="-1"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* toc panel */
    #toc_panel {
      box-sizing: border-box;
      position: fixed;
      top: 0;
      left: 0;
      background: #ffffff;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      z-index: 2;
    }

    /* toc panel when closed */
    #toc_panel[data-open="false"] {
      min-width: 60px;
      width: 60px;
      height: 60px;
      border-right: solid 1px #bdbdbd;
      border-bottom: solid 1px #bdbdbd;
    }

    /* toc panel when open */
    #toc_panel[data-open="true"] {
      min-width: 260px;
      max-width: 480px;
      /* keep panel edge consistent distance away from "page" edge */
      width: calc(((100vw - 8.5in) / 2) - 30px - 40px);
      bottom: 0;
      border-right: solid 1px #bdbdbd;
    }

    /* toc panel header */
    #toc_header {
      box-sizing: border-box;
      display: flex;
      flex-direction: row;
      align-items: center;
      height: 60px;
      margin: 0;
      padding: 20px;
    }

    /* toc panel header when hovered */
    #toc_header:hover {
      cursor: pointer;
    }

    /* toc panel header when panel open */
    #toc_panel[data-open="true"] > #toc_header {
      border-bottom: solid 1px #bdbdbd;
    }

    /* toc open/close header button */
    #toc_button {
      margin-right: 20px;
    }

    /* hide toc list and header text when closed */
    #toc_panel[data-open="false"] > #toc_header > *:not(#toc_button),
    #toc_panel[data-open="false"] > #toc_list {
      display: none;
    }

    /* toc list of entries */
    #toc_list {
      box-sizing: border-box;
      width: 100%;
      padding: 20px;
      position: absolute;
      top: calc(60px + 1px);
      bottom: 0;
      overflow: auto;
    }

    /* toc entry, link to section in document */
    .toc_link {
      display: block;
      padding: 5px;
      position: relative;
      font-weight: 600;
      text-decoration: none;
    }

    /* toc entry when hovered or when "viewed" */
    .toc_link:hover,
    .toc_link[data-viewing="true"] {
      background: #f5f5f5;
    }

    /* toc entry, level 1 indentation */
    .toc_link[data-level="1"] {
      margin-left: 0;
    }

    /* toc entry, level 2 indentation */
    .toc_link[data-level="2"] {
      margin-left: 20px;
    }

    /* toc entry, level 3 indentation */
    .toc_link[data-level="3"] {
      margin-left: 40px;
    }

    /* toc entry, level 4 indentation */
    .toc_link[data-level="4"] {
      margin-left: 60px;
    }

    /* toc entry bullets */
    #toc_panel[data-bullets="true"] .toc_link[data-level]:before {
      position: absolute;
      left: -15px;
      top: -1px;
      font-size: 1.5em;
    }

    /* toc entry, level 2 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="2"]:before {
      content: "\2022";
    }

    /* toc entry, level 3 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="3"]:before {
      content: "\25AB";
    }

    /* toc entry, level 4 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="4"]:before {
      content: "-";
    }
  }

  /* when on screen < 8.5in wide */
  @media only screen and (max-width: 8.5in) {
    /* push <body> ("page") element down to make room for toc icon */
    .toc_body_nudge {
      padding-top: 60px;
    }

    /* toc icon when panel closed and not hovered */
    #toc_panel[data-open="false"]:not(:hover) {
      background: rgba(255, 255, 255, 0.75);
    }
  }

  /* always hide toc panel on print */
  @media only print {
    #toc_panel {
      display: none;
    }
  }
</style>
<!-- 
  Tooltips Plugin

  Makes it such that when the user hovers or focuses a link to a citation or
  figure, a tooltip appears with a preview of the reference content, along with
  arrows to navigate between instances of the same reference in the document.
-->

<script type="module">
  // whether user must click off to close tooltip instead of just un-hovering
  const clickClose = "false";
  // delay (in ms) between opening and closing tooltip
  const delay = "100";

  // start script
  function start() {
    const links = getLinks();
    for (const link of links) {
      // attach hover and focus listeners to link
      link.addEventListener("mouseover", onLinkHover);
      link.addEventListener("mouseleave", onLinkUnhover);
      link.addEventListener("focus", onLinkFocus);
      link.addEventListener("touchend", onLinkTouch);
    }

    // attach mouse, key, and resize listeners to window
    window.addEventListener("mousedown", onClick);
    window.addEventListener("touchstart", onClick);
    window.addEventListener("keyup", onKeyUp);
    window.addEventListener("resize", onResize);
  }

  // when link is hovered
  function onLinkHover() {
    // function to open tooltip
    const delayOpenTooltip = function () {
      openTooltip(this);
    }.bind(this);

    // run open function after delay
    this.openTooltipTimer = window.setTimeout(delayOpenTooltip, delay);
  }

  // when mouse leaves link
  function onLinkUnhover() {
    // cancel opening tooltip
    window.clearTimeout(this.openTooltipTimer);

    // don't close on unhover if option specifies
    if (clickClose === "true") return;

    // function to close tooltip
    const delayCloseTooltip = function () {
      // if tooltip open and if mouse isn't over tooltip, close
      const tooltip = document.getElementById("tooltip");
      if (tooltip && !tooltip.matches(":hover")) closeTooltip();
    };

    // run close function after delay
    this.closeTooltipTimer = window.setTimeout(delayCloseTooltip, delay);
  }

  // when link is focused (tabbed to)
  function onLinkFocus(event) {
    openTooltip(this);
  }

  // when link is touched on touch screen
  function onLinkTouch(event) {
    // attempt to force hover state on first tap always, and trigger
    // regular link click (and navigation) on second tap
    if (event.target === document.activeElement) event.target.click();
    else {
      document.activeElement.blur();
      event.target.focus();
    }
    if (event.cancelable) event.preventDefault();
    event.stopPropagation();
    return false;
  }

  // when mouse is clicked anywhere in window
  function onClick(event) {
    closeTooltip();
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    switch (event.key) {
      // trigger click of prev button
      case "ArrowLeft":
        const prevButton = document.getElementById("tooltip_prev_button");
        if (prevButton) prevButton.click();
        break;
      // trigger click of next button
      case "ArrowRight":
        const nextButton = document.getElementById("tooltip_next_button");
        if (nextButton) nextButton.click();
        break;
      // close on esc
      case "Escape":
        closeTooltip();
        break;
    }
  }

  // when window is resized or zoomed
  function onResize() {
    closeTooltip();
  }

  // get all links of types we wish to handle
  function getLinks() {
    const queries = [];
    // exclude buttons, anchor links, toc links, etc
    const exclude =
      ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    queries.push('a[href^="#ref-"]' + exclude); // citation links
    queries.push('a[href^="#fig:"]' + exclude); // figure links
    const query = queries.join(", ");
    return document.querySelectorAll(query);
  }

  // get links with same target, get index of link in set, get total
  // same links
  function getSameLinks(link) {
    const sameLinks = [];
    const links = getLinks();
    for (const otherLink of links) {
      if (otherLink.getAttribute("href") === link.getAttribute("href"))
        sameLinks.push(otherLink);
    }

    return {
      elements: sameLinks,
      index: sameLinks.indexOf(link),
      total: sameLinks.length,
    };
  }

  // open tooltip
  function openTooltip(link) {
    // delete tooltip if it exists, start fresh
    closeTooltip();

    // make tooltip element
    const tooltip = makeTooltip(link);

    // if source couldn't be found and tooltip not made, exit
    if (!tooltip) return;

    // make navbar elements
    const navBar = makeNavBar(link);
    if (navBar) tooltip.firstElementChild.appendChild(navBar);

    // attach tooltip to page
    document.body.appendChild(tooltip);

    // position tooltip
    const position = function () {
      positionTooltip(link);
    };
    position();

    // if tooltip contains images, position again after they've loaded
    const imgs = tooltip.querySelectorAll("img");
    for (const img of imgs) img.addEventListener("load", position);
  }

  // close (delete) tooltip
  function closeTooltip() {
    const tooltip = document.getElementById("tooltip");
    if (tooltip) tooltip.remove();
  }

  // make tooltip
  function makeTooltip(link) {
    // get target element that link points to
    const source = getSource(link);

    // if source can't be found, exit
    if (!source) return;

    // create new tooltip
    const tooltip = document.createElement("div");
    tooltip.id = "tooltip";
    const tooltipContent = document.createElement("div");
    tooltipContent.id = "tooltip_content";
    tooltip.appendChild(tooltipContent);

    // make copy of source node and put in tooltip
    const sourceCopy = makeCopy(source);
    tooltipContent.appendChild(sourceCopy);

    // attach mouse event listeners
    tooltip.addEventListener("click", onTooltipClick);
    tooltip.addEventListener("mousedown", onTooltipClick);
    tooltip.addEventListener("touchstart", onTooltipClick);
    tooltip.addEventListener("mouseleave", onTooltipUnhover);

    // (for interaction with lightbox plugin)
    // transfer click on tooltip copied img to original img
    const sourceImg = source.querySelector("img");
    const sourceCopyImg = sourceCopy.querySelector("img");
    if (sourceImg && sourceCopyImg) {
      const clickImg = function () {
        sourceImg.click();
        closeTooltip();
      };
      sourceCopyImg.addEventListener("click", clickImg);
    }

    return tooltip;
  }

  // make carbon copy of html dom element
  function makeCopy(source) {
    const sourceCopy = source.cloneNode(true);

    // delete elements marked with ignore (eg anchor and jump buttons)
    const deleteFromCopy = sourceCopy.querySelectorAll('[data-ignore="true"]');
    for (const element of deleteFromCopy) element.remove();

    // delete certain element attributes
    const attributes = [
      "id",
      "data-collapsed",
      "data-selected",
      "data-highlighted",
      "data-glow",
      "class",
    ];
    for (const attribute of attributes) {
      sourceCopy.removeAttribute(attribute);
      const elements = sourceCopy.querySelectorAll("[" + attribute + "]");
      for (const element of elements) element.removeAttribute(attribute);
    }

    return sourceCopy;
  }

  // when tooltip is clicked
  function onTooltipClick(event) {
    // when user clicks on tooltip, stop click from transferring
    // outside of tooltip (eg, click off to close tooltip, or eg click
    // off to unhighlight same refs)
    event.stopPropagation();
  }

  // when tooltip is unhovered
  function onTooltipUnhover(event) {
    if (clickClose === "true") return;

    // make sure new mouse/touch/focus no longer over tooltip or any
    // element within it
    const tooltip = document.getElementById("tooltip");
    if (!tooltip) return;
    if (this.contains(event.relatedTarget)) return;

    closeTooltip();
  }

  // make nav bar to go betwen prev/next instances of same reference
  function makeNavBar(link) {
    // find other links to the same source
    const sameLinks = getSameLinks(link);

    // don't show nav bar when singular reference
    if (sameLinks.total <= 1) return;

    // find prev/next links with same target
    const prevLink = getPrevLink(link, sameLinks);
    const nextLink = getNextLink(link, sameLinks);

    // create nav bar
    const navBar = document.createElement("div");
    navBar.id = "tooltip_nav_bar";
    const text = sameLinks.index + 1 + " of " + sameLinks.total;

    // create nav bar prev/next buttons
    const prevButton = document.createElement("button");
    const nextButton = document.createElement("button");
    prevButton.id = "tooltip_prev_button";
    nextButton.id = "tooltip_next_button";
    prevButton.title =
      "Jump to the previous occurence of this item in the document [←]";
    nextButton.title =
      "Jump to the next occurence of this item in the document [→]";
    prevButton.classList.add("icon_button");
    nextButton.classList.add("icon_button");
    prevButton.innerHTML = document.querySelector(".icon_caret_left").innerHTML;
    nextButton.innerHTML =
      document.querySelector(".icon_caret_right").innerHTML;
    navBar.appendChild(prevButton);
    navBar.appendChild(document.createTextNode(text));
    navBar.appendChild(nextButton);

    // attach click listeners to buttons
    prevButton.addEventListener("click", function () {
      onPrevNextClick(link, prevLink);
    });
    nextButton.addEventListener("click", function () {
      onPrevNextClick(link, nextLink);
    });

    return navBar;
  }

  // get previous link with same target
  function getPrevLink(link, sameLinks) {
    if (!sameLinks) sameLinks = getSameLinks(link);
    // wrap index to other side if < 1
    let index;
    if (sameLinks.index - 1 >= 0) index = sameLinks.index - 1;
    else index = sameLinks.total - 1;
    return sameLinks.elements[index];
  }

  // get next link with same target
  function getNextLink(link, sameLinks) {
    if (!sameLinks) sameLinks = getSameLinks(link);
    // wrap index to other side if > total
    let index;
    if (sameLinks.index + 1 <= sameLinks.total - 1) index = sameLinks.index + 1;
    else index = 0;
    return sameLinks.elements[index];
  }

  // get element that is target of link or url hash
  function getSource(link) {
    const hash = link ? link.hash : window.location.hash;
    const id = hash.slice(1);
    let target = document.querySelector('[id="' + id + '"]');
    if (!target) return;

    // if ref or figure, modify target to get expected element
    if (id.indexOf("ref-") === 0) target = target.querySelector(":nth-child(2)");
    else if (id.indexOf("fig:") === 0) target = target.querySelector("figure");

    return target;
  }

  // when prev/next arrow button is clicked
  function onPrevNextClick(link, prevNextLink) {
    if (link && prevNextLink)
      goToElement(prevNextLink, window.innerHeight * 0.5);
  }

  // scroll to and focus element
  function goToElement(element, offset) {
    // expand accordion section if collapsed
    expandElement(element);
    const y =
      getRectInView(element).top -
      getRectInView(document.documentElement).top -
      (offset || 0);
    // trigger any function listening for "onscroll" event
    window.dispatchEvent(new Event("scroll"));
    window.scrollTo(0, y);
    document.activeElement.blur();
    element.focus();
  }

  // determine position to place tooltip based on link position in
  // viewport and tooltip size
  function positionTooltip(link, left, top) {
    const tooltipElement = document.getElementById("tooltip");
    if (!tooltipElement) return;

    // get convenient vars for position/dimensions of
    // link/tooltip/page/view
    link = getRectInPage(link);
    const tooltip = getRectInPage(tooltipElement);
    const view = getRectInPage();

    // horizontal positioning
    if (left)
      // use explicit value
      left = left;
    else if (link.left + tooltip.width < view.right)
      // fit tooltip to right of link
      left = link.left;
    else if (link.right - tooltip.width > view.left)
      // fit tooltip to left of link
      left = link.right - tooltip.width;
    // center tooltip in view
    else left = (view.right - view.left) / 2 - tooltip.width / 2;

    // vertical positioning
    if (top)
      // use explicit value
      top = top;
    else if (link.top - tooltip.height > view.top)
      // fit tooltip above link
      top = link.top - tooltip.height;
    else if (link.bottom + tooltip.height < view.bottom)
      // fit tooltip below link
      top = link.bottom;
    else {
      // center tooltip in view
      top = view.top + view.height / 2 - tooltip.height / 2;
      // nudge off of link to left/right if possible
      if (link.right + tooltip.width < view.right) left = link.right;
      else if (link.left - tooltip.width > view.left)
        left = link.left - tooltip.width;
    }

    tooltipElement.style.left = left + "px";
    tooltipElement.style.top = top + "px";
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
  <!-- modified from: https://fontawesome.com/icons/caret-left -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
    ></path>
  </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
  <!-- modified from: https://fontawesome.com/icons/caret-right -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* tooltip container */
    #tooltip {
      position: absolute;
      width: 50%;
      min-width: 240px;
      max-width: 75%;
      z-index: 1;
    }

    /* tooltip content */
    #tooltip_content {
      margin-bottom: 5px;
      padding: 20px;
      border-radius: 5px;
      border: solid 1px #bdbdbd;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      background: #ffffff;
      overflow-wrap: break-word;
    }

    /* tooltip copy of paragraphs and figures */
    #tooltip_content > p,
    #tooltip_content > figure {
      margin: 0;
      max-height: 320px;
      overflow-y: auto;
    }

    /* tooltip copy of <img> */
    #tooltip_content > figure > img,
    #tooltip_content > figure > svg {
      max-height: 260px;
    }

    /* navigation bar */
    #tooltip_nav_bar {
      margin-top: 10px;
      text-align: center;
    }

    /* navigation bar previous/next buton */
    #tooltip_nav_bar > .icon_button {
      position: relative;
      top: 3px;
    }

    /* navigation bar previous button */
    #tooltip_nav_bar > .icon_button:first-of-type {
      margin-right: 5px;
    }

    /* navigation bar next button */
    #tooltip_nav_bar > .icon_button:last-of-type {
      margin-left: 5px;
    }
  }

  /* always hide tooltip on print */
  @media only print {
    #tooltip {
      display: none;
    }
  }
</style>
<!--
  Analytics Plugin (third-party) 
  
  Copy and paste code from Google Analytics or similar service here.
-->
<!-- 
  Annotations Plugin

  Allows public annotation of the  manuscript. See https://web.hypothes.is/.
-->

<script type="module">
  // configuration
  window.hypothesisConfig = function () {
    return {
      branding: {
        accentColor: "#2196f3",
        appBackgroundColor: "#f8f8f8",
        ctaBackgroundColor: "#f8f8f8",
        ctaTextColor: "#000000",
        selectionFontFamily: "Open Sans, Helvetica, sans serif",
        annotationFontFamily: "Open Sans, Helvetica, sans serif",
      },
    };
  };

  // hypothesis client script
  const embed = "https://hypothes.is/embed.js";
  // hypothesis annotation count query url
  const query = "https://api.hypothes.is/api/search?limit=0&url=";

  // start script
  function start() {
    const button = makeButton();
    document.body.insertBefore(button, document.body.firstChild);
    insertCount(button);
  }

  // make button
  function makeButton() {
    // create button
    const button = document.createElement("button");
    button.id = "hypothesis_button";
    button.innerHTML = document.querySelector(".icon_hypothesis").innerHTML;
    button.title = "Hypothesis annotations";
    button.classList.add("icon_button");

    function onClick(event) {
      onButtonClick(event, button);
    }

    // attach click listeners
    button.addEventListener("click", onClick);

    return button;
  }

  // insert annotations count
  async function insertCount(button) {
    // get annotation count from Hypothesis based on url
    let count = "-";
    try {
      const canonical = document.querySelector('link[rel="canonical"]');
      const location = window.location;
      const url = encodeURIComponent((canonical || location).href);
      const response = await fetch(query + url);
      const json = await response.json();
      count = json.total || "-";
    } catch (error) {
      console.log(error);
    }

    // put count into button
    const counter = document.createElement("span");
    counter.id = "hypothesis_count";
    counter.innerHTML = count;
    button.title = "View " + count + " Hypothesis annotations";
    button.append(counter);
  }

  // when button is clicked
  function onButtonClick(event, button) {
    const script = document.createElement("script");
    script.src = embed;
    document.body.append(script);
    button.remove();
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- hypothesis icon -->

<template class="icon_hypothesis">
  <!-- modified from: https://simpleicons.org/icons/hypothesis.svg / https://git.io/Jf1VB -->
  <svg width="16" height="16" viewBox="0 0 24 24" tabindex="-1">
    <path
      fill="currentColor"
      d="M3.43 0C2.5 0 1.72 .768 1.72 1.72V18.86C1.72 19.8 2.5 20.57 3.43 20.57H9.38L12 24L14.62 20.57H20.57C21.5 20.57 22.29 19.8 22.29 18.86V1.72C22.29 .77 21.5 0 20.57 0H3.43M5.14 3.43H7.72V9.43S8.58 7.72 10.28 7.72C12 7.72 13.74 8.57 13.74 11.24V17.14H11.16V12C11.16 10.61 10.28 10.07 9.43 10.29C8.57 10.5 7.72 11.41 7.72 13.29V17.14H5.14V3.43M18 13.72C18.95 13.72 19.72 14.5 19.72 15.42A1.71 1.71 0 0 1 18 17.13A1.71 1.71 0 0 1 16.29 15.42C16.29 14.5 17.05 13.71 18 13.71Z"
      tabindex="-1"
    ></path>
  </svg>
</template>

<style>
  /* hypothesis activation button */
  #hypothesis_button {
    box-sizing: border-box;
    position: fixed;
    top: 0;
    right: 0;
    width: 60px;
    height: 60px;
    background: #ffffff;
    border-radius: 0;
    border-left: solid 1px #bdbdbd;
    border-bottom: solid 1px #bdbdbd;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
    z-index: 2;
  }

  /* hypothesis button svg */
  #hypothesis_button > svg {
    position: relative;
    top: -4px;
  }

  /* hypothesis annotation count */
  #hypothesis_count {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 5px;
  }

  /* side panel */
  .annotator-frame {
    width: 280px !important;
  }

  /* match highlight color to rest of theme */
  .annotator-highlights-always-on .annotator-hl {
    background-color: #ffeb3b !important;
  }

  /* match focused color to rest of theme */
  .annotator-hl.annotator-hl-focused {
    background-color: #ff8a65 !important;
  }

  /* match bucket bar color to rest of theme */
  .annotator-bucket-bar {
    background: #f5f5f5 !important;
  }

  /* always hide button, toolbar, and tooltip on print */
  @media only print {
    #hypothesis_button {
      display: none;
    }

    .annotator-frame {
      display: none !important;
    }

    hypothesis-adder {
      display: none !important;
    }
  }
</style>
<!-- 
  Mathjax Plugin (third-party) 

  Allows the proper rendering of math/equations written in LaTeX.
  See https://www.mathjax.org/.
-->

<script type="text/x-mathjax-config">
  // configuration
  MathJax.Hub.Config({
    "CommonHTML": { linebreaks: { automatic: true } },
    "HTML-CSS": { linebreaks: { automatic: true } },
    "SVG": { linebreaks: { automatic: true } },
    "fast-preview": { disabled: true }
  });
</script>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A=="
  crossorigin="anonymous"
></script>

<style>
  /* mathjax containers */
  .math.display > span:not(.MathJax_Preview) {
    /* turn inline element (no dimensions) into block (allows fixed width and thus scrolling) */
    display: flex !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    justify-content: center;
    align-items: center;
    margin: 0 !important;
  }

  /* right click menu */
  .MathJax_Menu {
    border-radius: 5px !important;
    border: solid 1px #bdbdbd !important;
    box-shadow: none !important;
  }

  /* equation auto-number */
  span[id^="eq:"] > span.math.display + span {
    font-weight: 600;
  }

  /* equation */
  span[id^="eq:"] > span.math.display > span {
    /* nudge to make room for equation auto-number and anchor */
    margin-right: 60px !important;
  }
</style>
</body>
</html>
